<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>FORMAT Pretty Printer Operations (ANSI Common Lisp)</title>

<meta name="description" content="FORMAT Pretty Printer Operations (ANSI Common Lisp)">
<meta name="keywords" content="FORMAT Pretty Printer Operations (ANSI Common Lisp)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="Table-of-Contents.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Formatted-Output.html" rel="up" title="Formatted Output">
<link href="FORMAT-Layout-Control.html" rel="next" title="FORMAT Layout Control">
<link href="FORMAT-Printer-Operations.html" rel="prev" title="FORMAT Printer Operations">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
body {font-family: century schoolbook, serif;
      line-height: 1.3;
      padding-left: 5em; padding-right: 1em;
      padding-bottom: 1em; max-width: 60em;}
table {border-collapse: collapse}
span.roman { font-family: century schoolbook, serif; font-weight: normal; }
h1, h2, h3, h4, h5, h6 {font-family:  Helvetica, sans-serif}
dfn {font-family: inherit; font-variant: italic; font-weight: bolder }
kbd {font-family: monospace; text-decoration: underline}
var {font-family: Helvetica, sans-serif; font-variant: slanted}
td  {padding-right: 1em; padding-left: 1em}
sub {font-size: smaller}
.node {padding: 0; margin: 0}

-->
</style>


</head>

<body lang="en">
<span id="FORMAT-Pretty-Printer-Operations"></span><div class="header">
<p>
Next: <a href="FORMAT-Layout-Control.html" accesskey="n" rel="next">FORMAT Layout Control</a>, Previous: <a href="FORMAT-Printer-Operations.html" accesskey="p" rel="prev">FORMAT Printer Operations</a>, Up: <a href="Formatted-Output.html" accesskey="u" rel="up">Formatted Output</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="FORMAT-Pretty-Printer-Operations-1"></span><h4 class="subsection">22.3.5 FORMAT Pretty Printer Operations</h4>


<p>The following constructs provide access to the <i>pretty printer</i>:
</p>
<span id="Tilde-Underscore_003a-Conditional-Newline"></span><h4 class="subsubsection">22.3.5.1 Tilde Underscore: Conditional Newline</h4>
<span id="TildeUnderscore"></span><span id="index-Underscore-_0028format-directive_0029"></span>
<span id="index-Tilde-Underscore-_0028format-directive_0029"></span>

<p>Without any modifiers, <code>~_</code> is the same as <code>(pprint-newline :linear)</code>.
<code>~@_</code>  is the same as <code>(pprint-newline :miser)</code>.
<code>~:_</code>  is the same as <code>(pprint-newline :fill)</code>.
<code>~:@_</code> is the same as <code>(pprint-newline :mandatory)</code>.
</p>

<span id="Tilde-Less_002dThan_002dSign_003a-Logical-Block"></span><h4 class="subsubsection">22.3.5.2 Tilde Less-Than-Sign: Logical Block</h4>
<span id="TildeLessThanLogicalBlock"></span><span id="index-Less_002dThan_002dSign-_0028format-directive_0029"></span>
<span id="index-Tilde-Less_002dThan_002dSign-_0028format-directive_0029"></span>

<p><code>~&lt;...~:&gt;</code>
</p>
<p>If <code>~:&gt;</code> is used to terminate a <code>~&lt;...~&gt;</code>,
the directive is equivalent to a call to <code>pprint-logical-block</code>.
The argument corresponding to the <code>~&lt;...~:&gt;</code> directive is treated in
the same way as the <i>list</i> argument to <code>pprint-logical-block</code>,
thereby providing automatic support for non-<i>list</i> arguments and
the detection of circularity, sharing, and depth abbreviation.  
The portion of the <var>control-string</var> nested within the <code>~&lt;...~:&gt;</code>
specifies the <tt>:prefix</tt> (or <tt>:per-line-prefix</tt>), <tt>:suffix</tt>,
and body of the <code>pprint-logical-block</code>.
</p>
<p>The <var>control-string</var> portion enclosed by <code>~&lt;...~:&gt;</code> can be divided
into segments <code>~&lt;<var>prefix</var>~;<var>body</var>~;<var>suffix</var>~:&gt;</code>
by <code>~;</code> directives.  If the first section is terminated by <code>~@;</code>, 
it specifies a per-line prefix rather than a simple prefix.  
The <var>prefix</var> and <var>suffix</var> cannot contain format directives.  
An error is signaled if either the prefix or suffix fails to be a
constant string or if the enclosed portion is divided into more than three segments.
</p>
<p>If the enclosed portion is divided into only two segments, the <var>suffix</var>
defaults to the null string.  If the enclosed portion consists of only
a single segment, both the <var>prefix</var> and the <var>suffix</var> default to 
the null string.  If the <i>colon</i> modifier is used (<i>i.e.</i>, <code>~:&lt;...~:&gt;</code>),
the <var>prefix</var> and <var>suffix</var> default to <code>&quot;(&quot;</code> and <code>&quot;)&quot;</code>
(respectively) instead of the null string.
</p>
<p>The body segment can be any arbitrary <i>format string</i>.
This <i>format string</i> is applied to the elements of the list
corresponding to the <code>~&lt;...~:&gt;</code> directive as a whole.
Elements are extracted from this list using <code>pprint-pop</code>,
thereby providing automatic support for malformed lists, and the detection
of circularity, sharing, and length abbreviation.
Within the body segment, <code>~^</code> acts like <code>pprint-exit-if-list-exhausted</code>.
</p>
<p><code>~&lt;...~:&gt;</code> supports a feature not supported by <code>pprint-logical-block</code>.
If <code>~:@&gt;</code> is used to terminate the directive (<i>i.e.</i>, <code>~&lt;...~:@&gt;</code>), 
then a fill-style conditional newline is automatically inserted after each
group of blanks immediately contained in the body (except for blanks
after a &nbsp;&lt;Newline&gt;&nbsp;<!-- /@w -->directive).  This makes it easy to achieve the
equivalent of paragraph filling.
</p>
<p>If the <i>at-sign</i> modifier is used with <code>~&lt;...~:&gt;</code>, the entire remaining argument
list is passed to the directive as its argument.  All of the remaining
arguments are always consumed by <code>~@&lt;...~:&gt;</code>, even if they are not all used
by the <i>format string</i> nested in the directive.  Other than the difference in
its argument, <code>~@&lt;...~:&gt;</code> is exactly the same as <code>~&lt;...~:&gt;</code> except that
circularity detection is not applied if <code>~@&lt;...~:&gt;</code> is encountered at top
level in a <i>format string</i>.  This ensures that circularity detection is
applied only to data lists, not to <i>format argument</i> <i>lists</i>.
</p>
<p><code>&quot; . #<var>n</var>#&quot;</code> is printed if circularity or sharing has to be indicated
for its argument as a whole.
</p>
<p>To a considerable extent, the basic form of the directive <code>~&lt;...~&gt;</code> is
incompatible with the dynamic control of the arrangement of output by
<code>~W</code>, <code>~_</code>, <code>~&lt;...~:&gt;</code>, <code>~I</code>, and <code>~:T</code>.  As a result, an error 
is signaled if any of these directives is nested within <code>~&lt;...~&gt;</code>.  
Beyond this, an error is also signaled if the <code>~&lt;...~:;...~&gt;</code> form of
<code>~&lt;...~&gt;</code> is used in the same <i>format string</i> with 
<code>~W</code>, <code>~_</code>, <code>~&lt;...~:&gt;</code>, <code>~I</code>, or <code>~:T</code>.
</p>
<p>See also <a href="FORMAT-Layout-Control.html#TildeLessThanJustification">Section 22.3.6.2 (Tilde Less-Than-Sign. Justification)</a>.
</p>

<span id="Tilde-I_003a-Indent"></span><h4 class="subsubsection">22.3.5.3 Tilde I: Indent</h4>
<span id="TildeI"></span><span id="index-I-_0028format-directive_0029"></span>
<span id="index-Tilde-I-_0028format-directive_0029"></span>

<p><code>~<var>n</var>I</code>  is the same as <code>(pprint-indent :block n)</code>.
</p>
<p><code>~<var>n</var>:I</code> is the same as <code>(pprint-indent :current n)</code>.
In both cases, <var>n</var> defaults to zero, if it is omitted.
</p>

<span id="Tilde-Slash_003a-Call-Function"></span><h4 class="subsubsection">22.3.5.4 Tilde Slash: Call Function</h4>
<span id="index-Slash-_0028format-directive_0029"></span>
<span id="index-Tilde-Slash-_0028format-directive_0029"></span>

<p><code>~/<var>name</var>/</code>
</p>
<p>User defined functions can be called from within a format
string by using the directive <code>~/<var>name</var>/</code>.
The <i>colon</i> modifier, the <i>at-sign</i> modifier, and arbitrarily many parameters 
can be specified with the <code>~/<var>name</var>/</code> directive.
<var>name</var> can be any arbitrary string that does not contain a &quot;/&quot;.
All of the characters in <var>name</var> are treated as if they were upper case.
If <var>name</var> contains a single <i>colon</i> (<code>:</code>) or double <i>colon</i> (<code>::</code>),
then everything up to but not including the first <code>&quot;:&quot;</code> or <code>&quot;::&quot;</code>
is taken to be a <i>string</i> that names a <i>package</i>.
Everything after the first <code>&quot;:&quot;</code> or <code>&quot;::&quot;</code> (if any) is taken to be a 
<i>string</i> that names a <code>symbol</code>.  The function corresponding to a 
<code>~/name/</code> directive is obtained by looking up the <i>symbol</i>
that has the indicated name in the indicated <i>package</i>.
If <var>name</var> does not contain a <code>&quot;:&quot;</code> or <code>&quot;::&quot;</code>,
then the whole <var>name</var> string is looked up in the <code>COMMON-LISP-USER</code> <i>package</i>. 
</p>
<p>When a <code>~/name/</code> directive is encountered,
the indicated function is called with four or more arguments.
The first four arguments are:
the output stream,
the <i>format argument</i> corresponding to the directive,
a <i>generalized boolean</i> that is <i>true</i> if the <i>colon</i> modifier was used,
and a <i>generalized boolean</i> that is <i>true</i> if the <i>at-sign</i> modifier was used.
The remaining arguments consist of any parameters specified with the directive.
The function should print the argument appropriately.
Any values returned by the function are ignored.
</p>
<p>The three <i>functions</i> 
<code>pprint-linear</code>,
<code>pprint-fill</code>,
and <code>pprint-tabular</code>
are specifically designed so that they can be called by <code>~/.../</code>
(<i>i.e.</i>, <code>~/pprint-linear/</code>, <code>~/pprint-fill/</code>, and <code>~/pprint-tabular/</code>).
In particular they take <i>colon</i> and <i>at-sign</i> arguments.
</p>



<hr>
<div class="header">
<p>
Next: <a href="FORMAT-Layout-Control.html" accesskey="n" rel="next">FORMAT Layout Control</a>, Previous: <a href="FORMAT-Printer-Operations.html" accesskey="p" rel="prev">FORMAT Printer Operations</a>, Up: <a href="Formatted-Output.html" accesskey="u" rel="up">Formatted Output</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
