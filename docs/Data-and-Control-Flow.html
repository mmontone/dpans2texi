<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Data and Control Flow (ANSI Common Lisp)</title>

<meta name="description" content="Data and Control Flow (ANSI Common Lisp)">
<meta name="keywords" content="Data and Control Flow (ANSI Common Lisp)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="Table-of-Contents.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="index.html" rel="up" title="Top">
<link href="Iteration.html#Iteration" rel="next" title="Iteration">
<link href="Types-and-Classes.html#simple_002dtype_002derror" rel="prev" title="simple-type-error">
<style type="text/css">
<!--
/*
CSS for TexInfo/HTML files.

Copyright (C) 2015-2021 Assaf Gordon (assafgordon@gmail.com)

License:
GNU All Permissive License
https://www.gnu.org/prep/maintain/html_node/License-Notices-for-Other-Files.html

 Copying and distribution of this file, with or without modification,
 are permitted in any medium without royalty provided the copyright
 notice and this notice are preserved.  This file is offered as-is,
 without any warranty.


The used tags/classes were collected from a Texinfo-generated HTML using:

  cd coreutils
  makeinfo --html --no-split -o coreutils.html doc/coreutils.texi
  cat coreutils.html | sed 's/</\n</g' | sed 's;>.*;>;g' \
         | grep '^<' | grep 'class=' | sort -u \
         | perl -lane 'm/<(\w+) .*class="([-\w]+)"/ ; print $1, "\t", $2' \
         | sort -u

*/

a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
body {
  font-family: sans-serif;
  font-size: 16px;
  margin: 1em;

  overflow-x: hidden; /* Coupled with the div.header trick,
			 this will extend the header lines
			 access the entire page width without causing
			 a horizontal scroll bar to appear. */
}


a {
  text-decoration: none;
  outline-style: none;
  color: blue;
}
a:visited {
  color: rgb(16,0,112);
}
a:hover {
  text-decoration: underline;
}


/*****************************************************
   Titles / Headers
******************************************************/

/* @settitle:
   The title of the document at the top of the document/header */
h1.settitle {
  color: rgb(51,70,131);
  text-shadow: rgb(153,153,153) 1px 1px 0px;
}

/* The title at the beginning of the document, before the @menu */
h1.top {
  color: rgb(51,70,131);
  text-shadow: rgb(153,153,153) 1px 1px 0px;
}

/* @chapter */
h2.chapter {
}

h2.appendix { }
h2.unnumbered { }

/* @section */
h3.section {
}
/* @unnumberedsec */
h3.unnumberedsec {
}
/* @heading (seems to be only used in fdl.texi) */
h3.heading {
}

/* @subsection */
h4.subsection {
}


/**************************************************
  Short Contents (if @shortcontents command is used)
***************************************************/
h2.shortcontents-heading { }
div.shortcontents { }
div.shortcontents ul { }
div.shortcontents ul li { }


/**************************************************
  Contents (if @contents command is used)
***************************************************/
h2.contents-heading { }
div.contents { }
div.contents ul { }
div.contents ul li { }


/* The @menu table */
table.menu { }
pre.menu-comment {}



/************************************
  @example   and   @verbatim
************************************/
div.example {
  margin-left: 2em;
  margin-right: 2em;
}
div.example pre.example {
  /* Round Corners */
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  border: 1px solid #c0c0c0;

  padding: 1ex;
  background-color: #f3f3f3;
}

/* Note: @verbatim is also rendered inside a 'div.example' */
div.example pre.verbatim {
  /* Round Corners */
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  border: 1px solid #c0c0c0;

  padding: 1ex;
  background-color: #f3f3f3;
}



/************************************
  @smallexample
************************************/
div.smallexample {
}
div.smallexample pre.smallexample {
}

/***********************************
  @display
***********************************/
div.display {
}
div.display pre.display {
}



/**************************************
  @footnote
**************************************/
div.footnote { }
h4.footnotes-heading { }

/**************************************
The header at the top of each page / section
(the next/previous/top/up links)
**************************************/
div.header {
   padding-top: 0.5ex;
   padding-bottom: 0.5ex;
   background-color: #ddddff;

   /* This will extend the background color of the header
      bar to the entire width of the page (and beyond),
      requires 'overflow-x: hidden' in the 'body'. */
   /*padding-left: 3000px;
   margin-left: -3000px;
   padding-right: 3000px;
   margin-right: -3000px;*/
}

/* Disable any additional margins */
div.header p {
    margin: 0;
}
div.header p a {
    color: blue;
}


/**************************************
   @table is rendered as <dl> (defnition list),
   @item  is rendered as <dt> (definition term),
   text is rendered as <dd> (definition description)
**************************************/
dl {
   margin: 0 1em;
}
dl dt {
   margin: 1em 0;
}
dl dd {
   margin-left: 2em;
}

/*******************************************************
  Text Styles
*******************************************************/

/* @var{} */
var {
  color: #CC0000;
}

/* @samp{} */
samp {
  color: #6600CC;
}

/* @env{} will result in <p><code>X</code></p> */
p code {
	border-radius: 5px;
	padding-left: 3px;
	padding-right: 3px;
	background-color: rgba(175,184,193,0.2);
}

/* p code { */
/*   color: #532c14; */
/* } */

/* @option{} */
span.nocodebreak {
  color: #5D4C46;
}

pre.lisp {
	background-color: rgba(175,184,193,0.2);
	border-radius: 5px;
	padding-top: 5px;
	padding-bottom: 5px;
}

body {
    padding-left: 100px;
    padding-right: 100px;
}

-->
</style>


</head>

<body lang="en">
<span id="Data-and-Control-Flow"></span><div class="header">
<p>
Next: <a href="Iteration.html#Iteration" accesskey="n" rel="next">Iteration</a>, Previous: <a href="Types-and-Classes.html#Types-and-Classes" accesskey="p" rel="prev">Types and Classes</a>, Up: <a href="index.html" accesskey="u" rel="up">Top</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Data-and-Control-Flow-1"></span><h2 class="chapter">5 Data and Control Flow</h2>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Generalized-Reference" accesskey="1">Generalized Reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Transfer-of-Control-to-an-Exit-Point" accesskey="2">Transfer of Control to an Exit Point</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Dictionary

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#apply" accesskey="3">apply</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#defun" accesskey="4">defun</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#fdefinition" accesskey="5">fdefinition</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#fboundp" accesskey="6">fboundp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#fmakunbound" accesskey="7">fmakunbound</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#flet_003b-labels_003b-macrolet" accesskey="8">flet; labels; macrolet</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#funcall" accesskey="9">funcall</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#function-_0028Special-Operator_0029">function (Special Operator)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#function_002dlambda_002dexpression">function-lambda-expression</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#functionp">functionp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#compiled_002dfunction_002dp">compiled-function-p</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#call_002darguments_002dlimit">call-arguments-limit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#lambda_002dlist_002dkeywords">lambda-list-keywords</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#lambda_002dparameters_002dlimit">lambda-parameters-limit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#defconstant">defconstant</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#defparameter_003b-defvar">defparameter; defvar</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#destructuring_002dbind">destructuring-bind</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#let_003b-let_002a">let; let*</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#progv">progv</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#setq">setq</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#psetq">psetq</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#block">block</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#catch">catch</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#go">go</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#return_002dfrom">return-from</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#return">return</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#tagbody">tagbody</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#throw">throw</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#unwind_002dprotect">unwind-protect</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#nil-_0028Constant-Variable_0029">nil (Constant Variable)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#not-_0028Function_0029">not (Function)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#t-_0028Constant-Variable_0029">t (Constant Variable)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#eq">eq</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#eql-_0028Function_0029">eql (Function)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#equal">equal</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#equalp">equalp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#identity">identity</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#complement">complement</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#constantly">constantly</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#every_003b-some_003b-notevery_003b-notany">every; some; notevery; notany</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#and-_0028Macro_0029">and (Macro)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cond">cond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#if">if</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#or-_0028Macro_0029">or (Macro)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#when_003b-unless">when; unless</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#case_003b-ccase_003b-ecase">case; ccase; ecase</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#typecase_003b-ctypecase_003b-etypecase">typecase; ctypecase; etypecase</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#multiple_002dvalue_002dbind">multiple-value-bind</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#multiple_002dvalue_002dcall">multiple-value-call</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#multiple_002dvalue_002dlist">multiple-value-list</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#multiple_002dvalue_002dprog1">multiple-value-prog1</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#multiple_002dvalue_002dsetq">multiple-value-setq</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#values-_0028Accessor_0029">values (Accessor)</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#values_002dlist">values-list</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#multiple_002dvalues_002dlimit">multiple-values-limit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#nth_002dvalue">nth-value</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#prog_003b-prog_002a">prog; prog*</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#prog1_003b-prog2">prog1; prog2</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#progn">progn</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#define_002dmodify_002dmacro">define-modify-macro</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#defsetf">defsetf</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#define_002dsetf_002dexpander">define-setf-expander</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#get_002dsetf_002dexpansion">get-setf-expansion</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#setf_003b-psetf">setf; psetf</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#shiftf">shiftf</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#rotatef">rotatef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#control_002derror">control-error</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#program_002derror">program-error</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#undefined_002dfunction">undefined-function</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<span id="Generalized-Reference"></span><div class="header">
<p>
Next: <a href="#Transfer-of-Control-to-an-Exit-Point" accesskey="n" rel="next">Transfer of Control to an Exit Point</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Generalized-Reference-1"></span><h3 class="section">5.1 Generalized Reference</h3>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Overview-of-Places-and-Generalized-Reference" accesskey="1">Overview of Places and Generalized Reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Kinds-of-Places" accesskey="2">Kinds of Places</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Treatment-of-Other-Macros-Based-on-SETF" accesskey="3">Treatment of Other Macros Based on SETF</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>
<hr>
<span id="Overview-of-Places-and-Generalized-Reference"></span><div class="header">
<p>
Next: <a href="#Kinds-of-Places" accesskey="n" rel="next">Kinds of Places</a>, Up: <a href="#Generalized-Reference" accesskey="u" rel="up">Generalized Reference</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Overview-of-Places-and-Generalized-Reference-1"></span><h4 class="subsection">5.1.1 Overview of Places and Generalized Reference</h4>

<p>A <span id="index-generalized-reference"></span>
<em>generalized reference</em> is the use of a <i>form</i>,
sometimes called a <span id="index-place"></span>
<em>place</em>,
as if it were a <i>variable</i> that could be read and written.
The <i>value</i> of a <i>place</i> is 
the <i>object</i> to which the <i>place</i> <i>form</i> evaluates.
The <i>value</i> of a <i>place</i> can be changed by using <code>setf</code>.
The concept of binding a <i>place</i> is not defined in <span class="roman">Common Lisp</span>,
but an <i>implementation</i> is permitted to extend the language by defining this concept.
</p>
<p>The next figure&nbsp;<!-- /@w -->contains examples of the use of <code>setf</code>.
Note that the values returned by evaluating the <i>forms</i> in column two 
are not necessarily the same as those obtained by evaluating the 
<i>forms</i> in column three.
In general, the exact <i>macro expansion</i> of a <code>setf</code> <i>form</i> is not guaranteed 
and can even be <i>implementation-dependent</i>;
all that is guaranteed is 
that the expansion is an update form that works
for that particular <i>implementation</i>,
that the left-to-right evaluation of <i>subforms</i> is preserved, 
and
that the ultimate result of evaluating <code>setf</code> is the value
or values being stored.
</p>

<div class="float"><span id="fig5_002e1"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<thead><tr><th>Access function</th><th>Update Function</th><th>Update using <code>setf</code></th></tr></thead>
<tr><td><code>x</code></td><td><code>(setq x datum)</code></td><td><code>(setf x datum)</code></td></tr>
<tr><td><code>(car x)</code></td><td><code>(rplaca x datum)</code></td><td><code>(setf (car x) datum)</code></td></tr>
<tr><td><code>(symbol-value x)</code></td><td><code>(set x datum)</code></td><td><code>(setf (symbol-value x) datum)</code></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.1: </strong>Examples of setf</p></div></div>

<p>The next figure&nbsp;<!-- /@w -->shows <i>operators</i> relating to
<i>places</i> and <i>generalized reference</i>.
</p>


<div class="float"><span id="fig5_002e2"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>assert</td><td>defsetf</td><td>push</td></tr>
<tr><td>ccase</td><td>get-setf-expansion</td><td>remf</td></tr>
<tr><td>ctypecase</td><td>getf</td><td>rotatef</td></tr>
<tr><td>decf</td><td>incf</td><td>setf</td></tr>
<tr><td>define-modify-macro</td><td>pop</td><td>shiftf</td></tr>
<tr><td>define-setf-expander</td><td>psetf</td><td></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.2: </strong>Operators relating to places and generalized reference.</p></div></div>


<p>Some of the <i>operators</i> above manipulate <i>places</i>
and some manipulate <i>setf expanders</i>.
A <i>setf expansion</i> can be derived from any <i>place</i>.
New <i>setf expanders</i> can be defined by using <code>defsetf</code> 
and <code>define-setf-expander</code>.
</p>
<span id="Evaluation-of-Subforms-to-Places"></span><h4 class="subsubsection">5.1.1.1 Evaluation of Subforms to Places</h4>
<span id="GenRefSubFormEval"></span>
<p>The following rules apply to the <i>evaluation</i> of <i>subforms</i> in a
<i>place</i>:
</p>

<ol>
<li> The evaluation ordering of <i>subforms</i> within a <i>place</i>
is determined by the order specified by the second value returned by
<code>get-setf-expansion</code>. 
For all <i>places</i> defined by this specification
(<i>e.g.</i>, <code>getf</code>, <code>ldb</code>, &hellip;),
this order of evaluation is left-to-right.
<span id="index-order-of-evaluation-1"></span>
<span id="index-evaluation-order-1"></span>
When a <i>place</i> is derived from a macro expansion,
this rule is applied after the macro is expanded to find the appropriate <i>place</i>. 

<p><i>Places</i> defined by using <code>defmacro</code> or
<code>define-setf-expander</code>
use the evaluation order defined by those definitions.
For example, consider the following:
</p>
<div class="lisp">
<pre class="lisp"> (defmacro wrong-order (x y) `(getf ,y ,x))
</pre></div>


<p>This following <i>form</i> evaluates <code>place2</code> first and
then <code>place1</code> because that is the order they are evaluated in
the macro expansion:
</p>
<div class="lisp">
<pre class="lisp"> (push value (wrong-order place1 place2))
</pre></div>


</li><li> For the <i>macros</i> that manipulate <i>places</i> 
(<code>push</code>,
<code>pushnew</code>,
<code>remf</code>,
<code>incf</code>,
<code>decf</code>, 
<code>shiftf</code>,
<code>rotatef</code>,
<code>psetf</code>,
<code>setf</code>,
<code>pop</code>, and those defined by <code>define-modify-macro</code>)
the <i>subforms</i> of the macro call are evaluated exactly once
in left-to-right order, with the <i>subforms</i> of the <i>places</i>
evaluated in the order specified in (1).

<p><code>push</code>, <code>pushnew</code>, <code>remf</code>, 
<code>incf</code>, <code>decf</code>, <code>shiftf</code>, <code>rotatef</code>, 
<code>psetf</code>, <code>pop</code> evaluate all <i>subforms</i> before modifying
any of the <i>place</i> locations.
<code>setf</code> (in the case when <code>setf</code> has more than two arguments) 
performs its operation on each pair in sequence. For example, in 
</p>
<div class="lisp">
<pre class="lisp"> (setf place1 value1 place2 value2 ...)
</pre></div>

<p>the <i>subforms</i> of <code>place1</code> and <code>value1</code> are evaluated, the location
specified by 
<code>place1</code> is modified to contain the value returned by 
<code>value1</code>, and
then the rest of the <code>setf</code> form is processed in a like manner.
</p>
</li><li> For <code>check-type</code>, <code>ctypecase</code>, and <code>ccase</code>,
<i>subforms</i> of the <i>place</i> are evaluated once as in (1),
but might be evaluated again if the
type check fails in the case of <code>check-type</code> 
or none of the cases hold in
<code>ctypecase</code> and <code>ccase</code>.

</li><li> For <code>assert</code>, the order of evaluation of the generalized 
references is not specified.
<span id="index-order-of-evaluation-2"></span>
<span id="index-evaluation-order-2"></span>
</li></ol>

<p>Rules 2, 3 and 4 cover all <i>standardized</i> <i>macros</i> that manipulate <i>places</i>.
</p>
<span id="g_t5_002e1_002e1_002e1_002e1-Examples-of-Evaluation-of-Subforms-to-Places"></span><h4 class="unnumberedsubsubsec">5.1.1.1.1 Examples of Evaluation of Subforms to Places</h4>


<div class="lisp">
<pre class="lisp"> (let ((ref2 (list '())))
   (push (progn (princ &quot;1&quot;) 'ref-1)
         (car (progn (princ &quot;2&quot;) ref2)))) 
▷ 12
<span class="roman">→</span> (REF1)

 (let (x)
    (push (setq x (list 'a))
          (car (setq x (list 'b))))
     x)
<span class="roman">→</span> (((A) . B))
</pre></div>


<p><code>push</code> first evaluates <code>(setq x (list 'a)) <span class="roman">→</span>&nbsp;<!-- /@w -->(a)</code>,
then evaluates <code>(setq x (list 'b)) <span class="roman">→</span>&nbsp;<!-- /@w -->(b)</code>,
then modifies the <i>car</i> of this latest value to be <code>((a) . b)</code>.
</p>


<span id="Setf-Expansions"></span><h4 class="subsubsection">5.1.1.2 Setf Expansions</h4>
<span id="SetfExpansions"></span>
<p>Sometimes it is possible to avoid evaluating <i>subforms</i> of a 
<i>place</i> multiple times or in the wrong order.  A
<i>setf expansion</i>
for a given access form can be expressed as an ordered collection of five <i>objects</i>:
</p>

<dl compact="compact">
<dt><b>List of temporary variables</b></dt>
<dd>

<p>a list of symbols naming temporary variables to be bound
sequentially, as if by <code>let*</code>, to <i>values</i> 
resulting from value forms.
</p>
</dd>
<dt><b>List of value forms</b></dt>
<dd>

<p>a list of forms (typically, <i>subforms</i> of the
<i>place</i>) which when evaluated 
yield the values to which the corresponding temporary 
variables should be bound.
</p>
</dd>
<dt><b>List of store variables</b></dt>
<dd>

<p>a list of symbols naming temporary store variables which are
to hold the new values that will be assigned to the
<i>place</i>.
</p>
</dd>
<dt><b>Storing form</b></dt>
<dd>

<p>a form which can reference both the temporary and the store variables,
and which changes the <i>value</i> of the <i>place</i>
and guarantees to return as its values the values of the store variables,
which are the correct values for <code>setf</code> to return.
</p>
</dd>
<dt><b>Accessing form</b></dt>
<dd>

<p>a <i>form</i> which can reference the temporary variables,
and which returns the <i>value</i> of the <i>place</i>.
</p></dd>
</dl>


<p>The value returned by the accessing form is
affected by execution of the storing form, but either of these
forms might be evaluated any number of times.
</p>
<p>It is possible
to do more than one <code>setf</code> in parallel via
<code>psetf</code>, <code>shiftf</code>, and <code>rotatef</code>.  
Because of this, the 
<i>setf expander</i>
must produce new temporary 
and store variable names every time.  For examples of how to do this,
see <code>gensym</code>.
</p>
<p>For each <i>standardized</i> accessor function <var>F</var>,
unless it is explicitly documented otherwise,
it is <i>implementation-dependent</i> whether the ability to 
use an <var>F</var> <i>form</i> as a <code>setf</code> <i>place</i>
is implemented by a <i>setf expander</i> or a <i>setf function</i>.
Also, it follows from this that it is <i>implementation-dependent</i> 
whether the name <code>(setf <var>F</var>)</code> is <i>fbound</i>.
</p>
<span id="g_t5_002e1_002e1_002e2_002e1-Examples-of-Setf-Expansions"></span><h4 class="unnumberedsubsubsec">5.1.1.2.1 Examples of Setf Expansions</h4>


<p>Examples of the contents of the constituents of <i>setf expansions</i>
follow.
</p>
<p>For a variable <var>x</var>:
</p>

<div class="float"><span id="fig5_002e3"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td><code>()</code></td><td>;list of temporary variables</td></tr>
<tr><td><code>()</code></td><td>;list of value forms</td></tr>
<tr><td><code>(g0001)</code></td><td>;list of store variables</td></tr>
<tr><td><code>(setq <var>x</var> g0001)</code></td><td>;storing form</td></tr>
<tr><td><var>x</var></td><td>;accessing form</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.3: </strong>Sample Setf Expansion of a Variable</p></div></div>

<p>For <code>(car <var>exp</var>)</code>:
</p>

<div class="float"><span id="fig5_002e4"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td><code>(g0002)</code></td><td>;list of temporary variables</td></tr>
<tr><td><code>(<var>exp</var>)</code></td><td>;list of value forms</td></tr>
<tr><td><code>(g0003)</code></td><td>;list of store variables</td></tr>
<tr><td><code>(progn (rplaca g0002 g0003) g0003)</code></td><td>;storing form</td></tr>
<tr><td><code>(car g0002)</code></td><td>;accessing form</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.4: </strong>Sample Setf Expansion of a CAR Form</p></div></div>

<p>For <code>(subseq <var>seq</var> <var>s</var> <var>e</var>)</code>:
</p>

<div class="float"><span id="fig5_002e5"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td><code>(g0004 g0005 g0006)</code></td><td>;list of temporary variables</td></tr>
<tr><td><code>(<var>seq</var> <var>s</var> <var>e</var>)</code></td><td>;list of value forms</td></tr>
<tr><td><code>(g0007)</code></td><td>;list of store variables</td></tr>
<tr><td><code>(progn (replace g0004 g0007 :start1 g0005 :end1 g0006) g0007)</code></td><td></td></tr>
<tr><td></td><td>;storing form</td></tr>
<tr><td><code>(subseq g0004 g0005 g0006)</code></td><td>; accessing form</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.5: </strong>Sample Setf Expansion of a SUBSEQ Form</p></div></div>

<p>In some cases, if a <i>subform</i> of a <i>place</i> is itself
a <i>place</i>, it is necessary to expand the <i>subform</i>
in order to compute some of the values in the expansion of the outer
<i>place</i>.  For <code>(ldb <var>bs</var> (car <var>exp</var>))</code>:
</p>

<div class="float"><span id="fig5_002e6"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td><code>(g0001 g0002)</code></td><td>;list of temporary variables</td></tr>
<tr><td><code>(<var>bs</var> <var>exp</var>)</code></td><td>;list of value forms</td></tr>
<tr><td><code>(g0003)</code></td><td>;list of store variables</td></tr>
<tr><td><code>(progn (rplaca g0002 (dpb g0003 g0001 (car g0002))) g0003)</code></td><td></td></tr>
<tr><td></td><td>;storing form</td></tr>
<tr><td><code>(ldb g0001 (car g0002))</code></td><td>; accessing form</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.6: </strong>Sample Setf Expansion of a LDB Form</p></div></div>





<hr>
<span id="Kinds-of-Places"></span><div class="header">
<p>
Next: <a href="#Treatment-of-Other-Macros-Based-on-SETF" accesskey="n" rel="next">Treatment of Other Macros Based on SETF</a>, Previous: <a href="#Overview-of-Places-and-Generalized-Reference" accesskey="p" rel="prev">Overview of Places and Generalized Reference</a>, Up: <a href="#Generalized-Reference" accesskey="u" rel="up">Generalized Reference</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Kinds-of-Places-1"></span><h4 class="subsection">5.1.2 Kinds of Places</h4>

<p>Several kinds of <i>places</i> are defined by <span class="roman">Common Lisp</span>; 
this section enumerates them.
This set can be extended by <i>implementations</i> and by <i>programmer code</i>.
</p>
<span id="Variable-Names-as-Places"></span><h4 class="subsubsection">5.1.2.1 Variable Names as Places</h4>

<p>The name of a <i>lexical variable</i> or <i>dynamic variable</i> 
can be used as a <i>place</i>.
</p>

<span id="Function-Call-Forms-as-Places"></span><h4 class="subsubsection">5.1.2.2 Function Call Forms as Places</h4>
<span id="FnFormsAsGenRefs"></span>
<p>A <i>function form</i> can be used as a <i>place</i> if it falls
into one of the following categories:
</p>

<ul>
<li> A function call form whose first element is the name of
any one of the functions in the next figure.





<div class="float"><span id="fig5_002e7"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>aref</td><td>cdadr</td><td>get</td></tr>
<tr><td>bit</td><td>cdar</td><td>gethash</td></tr>
<tr><td>caaaar</td><td>cddaar</td><td>logical-pathname-translations</td></tr>
<tr><td>caaadr</td><td>cddadr</td><td>macro-function</td></tr>
<tr><td>caaar</td><td>cddar</td><td>ninth</td></tr>
<tr><td>caadar</td><td>cdddar</td><td>nth</td></tr>
<tr><td>caaddr</td><td>cddddr</td><td>readtable-case</td></tr>
<tr><td>caadr</td><td>cdddr</td><td>rest</td></tr>
<tr><td>caar</td><td>cddr</td><td>row-major-aref</td></tr>
<tr><td>cadaar</td><td>cdr</td><td>sbit</td></tr>
<tr><td>cadadr</td><td>char</td><td>schar</td></tr>
<tr><td>cadar</td><td>class-name</td><td>second</td></tr>
<tr><td>caddar</td><td>compiler-macro-function</td><td>seventh</td></tr>
<tr><td>cadddr</td><td>documentation</td><td>sixth</td></tr>
<tr><td>caddr</td><td>eighth</td><td>slot-value</td></tr>
<tr><td>cadr</td><td>elt</td><td>subseq</td></tr>
<tr><td>car</td><td>fdefinition</td><td>svref</td></tr>
<tr><td>cdaaar</td><td>fifth</td><td>symbol-function</td></tr>
<tr><td>cdaadr</td><td>fill-pointer</td><td>symbol-plist</td></tr>
<tr><td>cdaar</td><td>find-class</td><td>symbol-value</td></tr>
<tr><td>cdadar</td><td>first</td><td>tenth</td></tr>
<tr><td>cdaddr</td><td>fourth</td><td>third</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.7: </strong>Functions that setf can be used with&mdash;1</p></div></div>

<p>In the case of <code>subseq</code>, the replacement value must be a <i>sequence</i>
whose elements might be contained by the sequence argument to <code>subseq</code>,
but does not have to be a <i>sequence</i> of the same <i>type</i> 
as the <i>sequence</i> of which the subsequence is specified.
If the length of the replacement value does not equal the length of
the subsequence to be replaced, then the shorter length determines
the number of elements to be stored, as for <code>replace</code>.
</p>

</li><li> A function call form whose first element is the name of
a selector function constructed by <code>defstruct</code>.
The function name must refer to the global function definition,
rather than a locally defined <i>function</i>.

</li><li> A function call form whose first element is the name of
any one of the functions in the next figure, 
provided that the supplied argument
to that function is in turn a <i>place</i> form;
in this case the new <i>place</i> has stored back into it the
result of applying the supplied &ldquo;update&rdquo; function.


<div class="float"><span id="fig5_002e8"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<thead><tr><th>Function name</th><th>Argument that is a <var>place</var></th><th>Update function used</th></tr></thead>
<tr><td><code>ldb</code></td><td>second</td><td><code>dpb</code></td></tr>
<tr><td><code>mask-field</code></td><td>second</td><td><code>deposit-field</code></td></tr>
<tr><td><code>getf</code></td><td>first</td><td><i>implementation-dependent</i></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.8: </strong>Functions that setf can be used with&mdash;2</p></div></div>
<p>During the <code>setf</code> expansion of these <i>forms</i>, it is necessary to call 
<code>get-setf-expansion</code> 
in order to figure out how the inner, nested generalized variable must be treated.  
</p>
<p>The information from
<code>get-setf-expansion</code>
is used as follows.
</p>
<dl compact="compact">
<dt><code>ldb</code></dt>
<dd>

<p>In a form such as:
</p>
<p><code>(setf (ldb <var>byte-spec</var> <var>place-form</var>) <var>value-form</var>)</code>
</p>
<p>the place referred to by the <var>place-form</var> must always be both <i>read</i> 
and <i>written</i>;  note that the update is to the generalized variable 
specified by <var>place-form</var>, not to any object of <i>type</i> <code>integer</code>.
</p>
<p>Thus this <code>setf</code> should generate code to do the following:
</p>

<ol>
<li> Evaluate <var>byte-spec</var> (and bind it into a temporary variable).
</li><li> Bind the temporary variables for <var>place-form</var>.
</li><li> Evaluate <var>value-form</var>  (and bind 
its value or values into the store variable).
</li><li> Do the <i>read</i> from <var>place-form</var>.
</li><li> Do the <i>write</i> into <var>place-form</var> with 
the given bits of the <i>integer</i>
fetched in step 4 replaced with the value from step 3.
</li></ol>

<p>If the evaluation of <var>value-form</var> 
in step 3 alters what is found in <var>place-form</var>,
such as setting different bits of <i>integer</i>,
then the change of the bits denoted by 
<var>byte-spec</var> is to that 
altered <i>integer</i>, 
because step 4 is done after the <var>value-form</var>
evaluation.  Nevertheless, the 
evaluations required for <i>binding</i> 
the temporary variables are done in steps 1 and 
2, and thus the expected left-to-right evaluation order is seen.
For example:
</p>
<div class="lisp">
<pre class="lisp"> (setq integer #x69) <span class="roman">→</span> #x69
 (rotatef (ldb (byte 4 4) integer) 
          (ldb (byte 4 0) integer))
 integer <span class="roman">→</span> #x96
;;; This example is trying to swap two independent bit fields 
;;; in an integer.  Note that the generalized variable of 
;;; interest here is just the (possibly local) program variable
;;; integer.
</pre></div>


</dd>
<dt><code>mask-field</code></dt>
<dd>

<p>This case is the same as <code>ldb</code> in all essential aspects.
</p>
</dd>
<dt><code>getf</code></dt>
<dd>

<p>In a form such as:
</p>
<p><code>(setf (getf <var>place-form</var> <var>ind-form</var>) <var>value-form</var>)</code>
</p>
<p>the place referred to by <var>place-form</var> must always be both <i>read</i>
and <i>written</i>;  note that the update is to the generalized variable 
specified by <var>place-form</var>, not necessarily to the particular 
<i>list</i>
that is the property list in question.
</p>
<p>Thus this <code>setf</code> should generate code to do the following:
</p>
<ol>
<li> Bind the temporary variables for <var>place-form</var>.
</li><li> Evaluate <var>ind-form</var> (and bind it into a temporary variable).
</li><li> Evaluate <var>value-form</var> (and bind 
its value or values into the store variable).
</li><li> Do the <i>read</i> from <var>place-form</var>.
</li><li> Do the <i>write</i> into <var>place-form</var> with a possibly-new property list
obtained by combining the values from steps 2, 3, and 4.  
(Note that the phrase &ldquo;possibly-new property list&rdquo; can mean that 
the former property list is somehow destructively re-used, or it can 
mean partial or full copying of it.  
Since either copying or destructive re-use can occur, 
the treatment of the resultant value for the 
possibly-new property list must proceed as if it were a different copy
needing to be stored back into the generalized variable.)
</li></ol>

<p>If the evaluation of <var>value-form</var> 
in step 3 alters what is found in
<var>place-form</var>, such as setting a different named property in the list,
then the change of the property denoted by <var>ind-form</var> 
is to that 
altered list, because step 4 is done after the 
<var>value-form</var>
evaluation.  Nevertheless, the 
evaluations required for <i>binding</i> 
the temporary variables  are done in steps 1 and 
2,  and thus the expected left-to-right evaluation order is seen.
</p>
<p>For example:
</p>
<div class="lisp">
<pre class="lisp"> (setq s (setq r (list (list 'a 1 'b 2 'c 3)))) <span class="roman">→</span> ((a 1 b 2 c 3))
 (setf (getf (car r) 'b) 
       (progn (setq r nil) 6)) <span class="roman">→</span> 6
 r <span class="roman">→</span> NIL
 s <span class="roman">→</span> ((A 1 B 6 C 3))
;;; Note that the (setq r nil) does not affect the actions of 
;;; the SETF because the value of R had already been saved in 
;;; a temporary variable as part of the step 1. Only the CAR
;;; of this value will be retrieved, and subsequently modified 
;;; after the value computation.
</pre></div>

</dd>
</dl>
</li></ul>




<span id="VALUES-Forms-as-Places"></span><h4 class="subsubsection">5.1.2.3 VALUES Forms as Places</h4>
<span id="SETFofVALUES"></span>
<p>A <code>values</code> <i>form</i> can be used as a <i>place</i>,
provided that each of its <i>subforms</i> is also a <i>place</i> form.
</p>
<p>A form such as
</p>
<p><code>(setf (values <var>place-1</var> &hellip; <var>place-n</var>) <var>values-form</var>)</code>
</p>
<p>does the following:
</p>

<ol>
<li> The <i>subforms</i> of each nested <var>place</var> are evaluated
in left-to-right order.
</li><li> The <var>values-form</var> is evaluated, and the first store
variable from each <var>place</var> is bound to its return values as if by 
<code>multiple-value-bind</code>.  
</li><li> If the <i>setf expansion</i> for any <var>place</var> 
involves more than one store variable, then the additional
store variables are bound to <code>nil</code>.
</li><li> The storing forms for each <var>place</var> are evaluated in
left-to-right order.
</li></ol>


<p>The storing form in the <i>setf expansion</i> of <code>values</code>
returns as <i>multiple values</i><sub>2</sub>
variables in step 2.  That is, the number of values returned is the
same as the number of <i>place</i> forms.  This may be more or fewer
values than are produced by the <var>values-form</var>.
</p>

<span id="THE-Forms-as-Places"></span><h4 class="subsubsection">5.1.2.4 THE Forms as Places</h4>

<p>A <code>the</code> <i>form</i> can be used as a <i>place</i>,
in which case the declaration is transferred to the <var>newvalue</var> form,
and the resulting <code>setf</code> is analyzed.  For example,
</p>
<div class="lisp">
<pre class="lisp"> (setf (the integer (cadr x)) (+ y 3))
</pre></div>

<p>is processed as if it were
</p>
<div class="lisp">
<pre class="lisp"> (setf (cadr x) (the integer (+ y 3)))
</pre></div>



<span id="APPLY-Forms-as-Places"></span><h4 class="subsubsection">5.1.2.5 APPLY Forms as Places</h4>
<span id="SETFofAPPLY"></span>
<p>The following situations involving <code>setf</code> of <code>apply</code> must be supported:
</p>

<ul>
<li> <code>(setf (apply #'aref <var>array</var>
<tt>{</tt>subscript<tt>}</tt>*
<var>more-subscripts</var>)
<var>new-element</var>)</code>
</li><li> <code>(setf (apply #'bit <var>array</var> 
<tt>{</tt>subscript<tt>}</tt>*
<var>more-subscripts</var>)
<var>new-element</var>)</code>
</li><li> <code>(setf (apply #'sbit <var>array</var> 
<tt>{</tt>subscript<tt>}</tt>*
<var>more-subscripts</var>) 
<var>new-element</var>)</code>
</li></ul>


<p>In all three cases, the <i>element</i> of <var>array</var> designated
by the concatenation of <var>subscripts</var> and <var>more-subscripts</var>
(<i>i.e.</i>, the same <i>element</i> which would be <i>read</i> by the call to
<i>apply</i> if it were not part of a <code>setf</code> <i>form</i>)
is changed to have the <i>value</i> given by <var>new-element</var>.
For these usages, the function name (<code>aref</code>, <code>bit</code>, or <code>sbit</code>)
must refer to the global function definition, rather than a locally defined
<i>function</i>.
</p>
<p>No other <i>standardized</i> <i>function</i> is required to be supported,
but an <i>implementation</i> may define such support.
An <i>implementation</i> may also define support 
for <i>implementation-defined</i> <i>operators</i>.
</p>
<p>If a user-defined <i>function</i> is used in this context,
the following equivalence is true, except that care is taken
to preserve proper left-to-right evaluation of argument <i>subforms</i>:
</p>
<div class="lisp">
<pre class="lisp"> (setf (apply #'<var>name</var> <tt>{</tt>arg<tt>}</tt>*) <var>val</var>)
 ≡ (apply #'(setf <var>name</var>) <var>val</var> <tt>{</tt>arg<tt>}</tt>*)
</pre></div>



<span id="Setf-Expansions-and-Places"></span><h4 class="subsubsection">5.1.2.6 Setf Expansions and Places</h4>

<p>Any <i>compound form</i> for which the <i>operator</i> has a
<i>setf expander</i>
defined can be used as a <i>place</i>.
The 
<i>operator</i>
must refer to the global function definition,
rather than a locally defined <i>function</i> or <i>macro</i>.
</p>


<span id="Macro-Forms-as-Places"></span><h4 class="subsubsection">5.1.2.7 Macro Forms as Places</h4>

<p>A <i>macro form</i> can be used as a <i>place</i>, 
in which case <span class="roman">Common Lisp</span>&nbsp;<!-- /@w -->expands the <i>macro form</i>
as if by <code>macroexpand-1</code>
and then uses the <i>macro expansion</i> in place of the original <i>place</i>.
Such <i>macro expansion</i> is attempted only after exhausting all other possibilities
other than expanding into a call to a function named <code>(setf <var>reader</var>)</code>.
</p>

<span id="Symbol-Macros-as-Places"></span><h4 class="subsubsection">5.1.2.8 Symbol Macros as Places</h4>

<p>A reference to a <i>symbol</i> that has been <i>established</i> as a <i>symbol macro</i> 
can be used as a <i>place</i>.  In this case,
<code>setf</code> expands the reference and then analyzes the resulting <i>form</i>.
</p>

<span id="Other-Compound-Forms-as-Places"></span><h4 class="subsubsection">5.1.2.9 Other Compound Forms as Places</h4>

<p>For any other <i>compound form</i> for which the <i>operator</i> is a
<i>symbol</i> <var>f</var>,
the <code>setf</code> <i>form</i> expands into a call 
to the <i>function</i> named <code>(setf <var>f</var>)</code>.
The first <i>argument</i> in the newly constructed <i>function form</i>
is <var>newvalue</var> and the
remaining <i>arguments</i> are the remaining <i>elements</i> of
<var>place</var>.
This expansion occurs regardless of whether <var>f</var> or <code>(setf <var>f</var>)</code>
is defined as a <i>function</i> locally, globally, or not at all.
For example,
</p>
<p><code>(setf (<var>f</var> <var>arg1</var> <var>arg2</var> ...) <var>new-value</var>)</code>
</p>
<p>expands into a form with the same effect and value as
</p>
<div class="lisp">
<pre class="lisp"> (let ((#:temp-1 arg1)          ;force correct order of evaluation
       (#:temp-2 arg2)
       ...
       (#:temp-0 <var>new-value</var>))
   (funcall (function (setf <var>f</var>)) #:temp-0 #:temp-1 #:temp-2...))
</pre></div>


<p>A <i>function</i> named <code>(setf <var>f</var>)</code> must return its first argument
as its only value in order to preserve the semantics of <code>setf</code>.
</p>



<hr>
<span id="Treatment-of-Other-Macros-Based-on-SETF"></span><div class="header">
<p>
Previous: <a href="#Kinds-of-Places" accesskey="p" rel="prev">Kinds of Places</a>, Up: <a href="#Generalized-Reference" accesskey="u" rel="up">Generalized Reference</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Treatment-of-Other-Macros-Based-on-SETF-1"></span><h4 class="subsection">5.1.3 Treatment of Other Macros Based on SETF</h4>


<p>For each of the &ldquo;read-modify-write&rdquo; <i>operators</i> in the next figure, 
and for any additional <i>macros</i> 
defined by the <i>programmer</i> using <code>define-modify-macro</code>,
an exception is made to the normal rule of left-to-right evaluation of arguments.
Evaluation of <i>argument</i> <i>forms</i> occurs in left-to-right order,
with the exception that for the <var>place</var> <i>argument</i>, the actual
<i>read</i> of the &ldquo;old value&rdquo; from that <var>place</var> happens 
after all of the <i>argument</i> <i>form</i> <i>evaluations</i>, 
and just before a &ldquo;new value&rdquo; is computed and <i>written</i> back into the <var>place</var>.
</p>
<p>Specifically, each of these <i>operators</i> can be viewed as involving a
<i>form</i> with the following general syntax:
</p>
<div class="lisp">
<pre class="lisp"> (<i>operator</i> <tt>{</tt>preceding-form<tt>}</tt>* <var>place</var> <tt>{</tt>following-form<tt>}</tt>*)
</pre></div>


<p>The evaluation of each such <i>form</i> proceeds like this:
</p>

<ol>
<li> <i>Evaluate</i> each of the <var>preceding-forms</var>, in left-to-right order.
</li><li> <i>Evaluate</i> the <i>subforms</i> of the <var>place</var>,
in the order specified by the second value of the <i>setf expansion</i>
for that <var>place</var>.
</li><li> <i>Evaluate</i> each of the <var>following-forms</var>, in left-to-right order.
</li><li> <i>Read</i> the old value from <var>place</var>.
</li><li> Compute the new value.
</li><li> Store the new value into <var>place</var>.
</li></ol>



<div class="float"><span id="fig5_002e9"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>decf</td><td>pop</td><td>pushnew</td></tr>
<tr><td>incf</td><td>push</td><td>remf</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.9: </strong>Read-Modify-Write Macros</p></div></div>



<hr>
<span id="Transfer-of-Control-to-an-Exit-Point"></span><div class="header">
<p>
Next: <a href="#apply" accesskey="n" rel="next">apply</a>, Previous: <a href="#Generalized-Reference" accesskey="p" rel="prev">Generalized Reference</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Transfer-of-Control-to-an-Exit-Point-1"></span><h3 class="section">5.2 Transfer of Control to an Exit Point</h3>

<p>When a transfer of control is initiated by <code>go</code>, 
<code>return-from</code>, or <code>throw</code>
the following events occur in order to accomplish the transfer of control.
Note that for <code>go</code>, 
the <i>exit point</i> is the <i>form</i> within the <code>tagbody</code>
that is being executed at the time the <code>go</code> is performed;
for <code>return-from</code>,
the <i>exit point</i> is the corresponding 
<code>block</code> <i>form</i>;
and for <code>throw</code>,
the <i>exit point</i> is the corresponding 
<code>catch</code> <i>form</i>. 
</p>

<ol>
<li> Intervening <i>exit points</i> are &ldquo;abandoned&rdquo;
(<i>i.e.</i>, their <i>extent</i> ends 
and it is no longer valid to attempt to transfer control through them).

</li><li> The cleanup clauses of any intervening <code>unwind-protect</code> clauses
are evaluated.

</li><li> Intervening dynamic <i>bindings</i> of <code>special</code> variables,
<i>catch tags</i>, <i>condition handlers</i>, and <i>restarts</i>
are undone.

</li><li> The <i>extent</i> of the <i>exit point</i> being invoked ends,
and control is passed to the target.
</li></ol>


<p>The extent of an exit being &ldquo;abandoned&rdquo; because it is being passed over
ends as soon as the transfer of control is initiated. That is,
event 1 occurs at the beginning of the initiation of the transfer of
control. 
The consequences are undefined if an attempt is made to transfer control 
to an <i>exit point</i> whose <i>dynamic extent</i> has ended.
</p>
<p>Events 2 and 3 are actually performed interleaved, in the order
corresponding to the reverse order in which they were established.
The effect of this is that the cleanup clauses of an <code>unwind-protect</code>
see the same dynamic <i>bindings</i> 
of variables and <i>catch tags</i> as were
visible when the <code>unwind-protect</code> was entered.
</p>
<p>Event 4 occurs at the end of the transfer of control.
</p>

<hr>
<span id="apply"></span><div class="header">
<p>
Next: <a href="#defun" accesskey="n" rel="next">defun</a>, Previous: <a href="#Transfer-of-Control-to-an-Exit-Point" accesskey="p" rel="prev">Transfer of Control to an Exit Point</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">apply</h4>
<span id="apply-_0028Function_0029"></span><h3 class="heading">apply (Function)</h3>
<span id="index-apply-2"></span>
<span id="index-apply"></span>


<span id="Syntax_003a-35"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-apply-1">Function: <strong>apply</strong> <em>function <tt>&amp;rest</tt> args+ <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-25"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function</var>&mdash;a <i>function designator</i>.
</p>
<p><var>args</var>&mdash;a <i>spreadable argument list designator</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by <var>function</var>.
</p>
<span id="Description_003a-54"></span><h4 class="subsubheading">Description:</h4>

<p><i>Applies</i> the <var>function</var> to the <var>args</var>.
</p>
<p>When the <var>function</var> receives its arguments via <code>&amp;rest</code>, it is 
permissible (but not required) for the <i>implementation</i> to <i>bind</i> 
the <i>rest parameter</i>
to an <i>object</i> that shares structure with the last argument to <code>apply</code>.
Because a <i>function</i> can neither detect whether it was called via <code>apply</code>
nor whether (if so) the last argument to <code>apply</code> was a <i>constant</i>,
<i>conforming programs</i> must neither rely on the <i>list</i> structure 
of a <i>rest list</i> to be freshly consed, nor modify that <i>list</i> structure. 
</p>
<p><code>setf</code> can be used with <code>apply</code> in certain circumstances;
see <a href="#SETFofAPPLY">Section 5.1.2.5 (APPLY Forms as Places)</a>.
</p>
<span id="Examples_003a-32"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (setq f '+) <span class="roman">→</span> +
 (apply f '(1 2)) <span class="roman">→</span> 3
 (setq f #'-) <span class="roman">→</span> #&lt;FUNCTION -&gt;
 (apply f '(1 2)) <span class="roman">→</span> -1
 (apply #'max 3 5 '(2 7 3)) <span class="roman">→</span> 7
 (apply 'cons '((+ 2 3) 4)) <span class="roman">→</span> ((+ 2 3) . 4)
 (apply #'+ '()) <span class="roman">→</span> 0

 (defparameter *some-list* '(a b c))
 (defun strange-test (&amp;rest x) (eq x *some-list*))
 (apply #'strange-test *some-list*) <span class="roman">→</span> <i>implementation-dependent</i>

 (defun bad-boy (&amp;rest x) (rplacd x 'y))
 (bad-boy 'a 'b 'c) has undefined consequences.
 (apply #'bad-boy *some-list*) has undefined consequences.
</pre></div>


<div class="lisp">
<pre class="lisp"> (defun foo (size &amp;rest keys &amp;key double &amp;allow-other-keys)
   (let ((v (apply #'make-array size :allow-other-keys t keys)))
     (if double (concatenate (type-of v) v v) v)))
 (foo 4 :initial-contents '(a b c d) :double t)
    <span class="roman">→</span> #(A B C D A B C D)
</pre></div>


<span id="See-Also_003a-41"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#funcall">funcall</a>,
<a href="#fdefinition">fdefinition</a>,
<a href="#function-_0028Special-Operator_0029">function (Special Operator)</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>,
<a href="#SETFofAPPLY">Section 5.1.2.5 (APPLY Forms as Places)</a>
</p>

<hr>
<span id="defun"></span><div class="header">
<p>
Next: <a href="#fdefinition" accesskey="n" rel="next">fdefinition</a>, Previous: <a href="#apply" accesskey="p" rel="prev">apply</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">defun</h4>
<span id="defun-_0028Macro_0029"></span><h3 class="heading">defun (Macro)</h3>
<span id="index-defun-2"></span>
<span id="index-defun"></span>



<span id="Syntax_003a-36"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-defun-1">Macro: <strong>defun</strong> <em>function-name lambda-list 〚<tt>{</tt>declaration<tt>}</tt>* <span class="roman">|</span> documentation〛 <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> function-name</em></dt>
</dl>

<span id="Arguments-and-Values_003a-26"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function-name</var>&mdash;a <i>function name</i>.
</p>
<p><var>lambda-list</var>&mdash;an <i>ordinary lambda list</i>.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>block-name</var>&mdash;the <i>function block name</i> of the <var>function-name</var>.
</p>
<span id="Description_003a-55"></span><h4 class="subsubheading">Description:</h4>

<p>Defines a new <i>function</i> named <var>function-name</var> in the <i>global environment</i>.
The body of the <i>function</i> defined by <code>defun</code> consists 
of <var>forms</var>; they are executed as an <i>implicit progn</i>
when the <i>function</i> is called. 
<code>defun</code> can be used
to define a new <i>function</i>,
to install a corrected version of an incorrect definition,
to redefine an already-defined <i>function</i>,
or to redefine a <i>macro</i> as a <i>function</i>.
</p>
<p><code>defun</code> implicitly puts a <code>block</code> named <var>block-name</var>
around the body <var>forms</var> 
(but not the <i>forms</i> in the <var>lambda-list</var>)
of the <i>function</i> defined.
</p>
<p><var>Documentation</var> is attached as a <i>documentation string</i> 
to <var>name</var> (as kind <code>function</code>)
and to the <i>function</i> <i>object</i>.
</p>
<p>Evaluating <code>defun</code> causes <var>function-name</var> to be a global name
for the <i>function</i> specified by the <i>lambda expression</i>
</p>
<div class="lisp">
<pre class="lisp"> (lambda <var>lambda-list</var>
   〚<tt>{</tt>declaration<tt>}</tt>* <span class="roman">|</span> documentation〛
   (block <var>block-name</var> <tt>{</tt>form<tt>}</tt>*))
</pre></div>


<p>processed in the <i>lexical environment</i> in which <code>defun</code> was executed.
</p>
<p>(None of the arguments are evaluated at macro expansion time.)
</p>
<p><code>defun</code> is not required to perform any compile-time side effects.
In particular, <code>defun</code> does not make the <i>function</i> definition available
at compile time.  An <i>implementation</i> may choose to store information
about the <i>function</i> for the purposes of compile-time error-checking
(such as checking the number of arguments on calls),
or to enable the <i>function</i> to be expanded inline.
</p>
<span id="Examples_003a-33"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (defun recur (x)
  (when (&gt; x 0)
    (recur (1- x)))) <span class="roman">→</span> RECUR 
 (defun ex (a b &amp;optional c (d 66) &amp;rest keys &amp;key test (start 0))
    (list a b c d keys test start)) <span class="roman">→</span> EX 
 (ex 1 2) <span class="roman">→</span> (1 2 NIL 66 NIL NIL 0)
 (ex 1 2 3 4 :test 'equal :start 50) 
<span class="roman">→</span> (1 2 3 4 (:TEST EQUAL :START 50) EQUAL 50)
 (ex :test 1 :start 2) <span class="roman">→</span> (:TEST 1 :START 2 NIL NIL 0)

 ;; This function assumes its callers have checked the types of the
 ;; arguments, and authorizes the compiler to build in that assumption.
 (defun discriminant (a b c)
   (declare (number a b c))
   &quot;Compute the discriminant for a quadratic equation.&quot;
   (- (* b b) (* 4 a c))) <span class="roman">→</span> DISCRIMINANT
 (discriminant 1 2/3 -2) <span class="roman">→</span> 76/9

 ;; This function assumes its callers have not checked the types of the
 ;; arguments, and performs explicit type checks before making any assumptions. 
 (defun careful-discriminant (a b c)
   &quot;Compute the discriminant for a quadratic equation.&quot;
   (check-type a number)
   (check-type b number)
   (check-type c number)
   (locally (declare (number a b c))
     (- (* b b) (* 4 a c)))) <span class="roman">→</span> CAREFUL-DISCRIMINANT
 (careful-discriminant 1 2/3 -2) <span class="roman">→</span> 76/9
</pre></div>


<span id="See-Also_003a-42"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#flet">flet</a>,
<a href="#labels">labels</a>, 
<a href="#block">block</a>,
<a href="#return_002dfrom">return-from</a>,
<a href="Evaluation-and-Compilation.html#declare">declare</a>, 
<a href="Environment.html#documentation">documentation</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>,
<a href="Evaluation-and-Compilation.html#Ordinary-Lambda-Lists">Section 3.4.1 (Ordinary Lambda Lists)</a>,
<a href="Evaluation-and-Compilation.html#Syntactic-Interaction-of-Documentation-Strings-and-Declarations">Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)</a>
</p>
<span id="Notes_003a-24"></span><h4 class="subsubheading">Notes:</h4>
<p><code>return-from</code> can be used to return
prematurely from a <i>function</i> defined by <code>defun</code>.
</p>
<p>Additional side effects might take place when additional information
(typically debugging information)
about the function definition is recorded. 
</p>


<hr>
<span id="fdefinition"></span><div class="header">
<p>
Next: <a href="#fboundp" accesskey="n" rel="next">fboundp</a>, Previous: <a href="#defun" accesskey="p" rel="prev">defun</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">fdefinition</h4>
<span id="fdefinition-_0028Accessor_0029"></span><h3 class="heading">fdefinition (Accessor)</h3>
<span id="index-fdefinition-2"></span>
<span id="index-fdefinition"></span>



<span id="Syntax_003a-37"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-fdefinition-1">Function: <strong>fdefinition</strong> <em>function-name <span class="roman">→</span> definition</em></dt>
</dl>
<p><tt>(setf (fdefinition function-name) new-definition)</tt>
</p>
<span id="Arguments-and-Values_003a-27"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function-name</var>&mdash;a <i>function name</i>.
In the non-<code>setf</code> case, 
the <i>name</i> must be <i>fbound</i> in the <i>global environment</i>.
</p>
<p><var>definition</var>&mdash;Current global function definition named by <var>function-name</var>.  
</p>
<p><var>new-definition</var>&mdash;a <i>function</i>.
</p>
<span id="Description_003a-56"></span><h4 class="subsubheading">Description:</h4>

<p><code>fdefinition</code> <i>accesses</i> the current global function definition
named by <var>function-name</var>.  The definition may be a
<i>function</i> or may be an <i>object</i> representing a 
<i>special form</i> or <i>macro</i>.
The value returned by <code>fdefinition</code> when <code>fboundp</code> returns true
but the <var>function-name</var> denotes a <i>macro</i> or 
<i>special form</i> is not well-defined, but <code>fdefinition</code> does not signal an error. 
</p>
<span id="Exceptional-Situations_003a-10"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>Should signal an error of <i>type</i> <code>type-error</code> if <var>function-name</var> is not a <i>function name</i>.
</p>
<p>An error of <i>type</i> <code>undefined-function</code> is signaled 
in the non-<code>setf</code> case if <var>function-name</var> is not <i>fbound</i>.
</p>
<span id="See-Also_003a-43"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#fboundp">fboundp</a>,
<a href="#fmakunbound">fmakunbound</a>,
<a href="Evaluation-and-Compilation.html#macro_002dfunction">macro-function</a>,
<a href="Evaluation-and-Compilation.html#special_002doperator_002dp">special-operator-p</a>,
<a href="Symbols.html#symbol_002dfunction">symbol-function</a>
</p>
<span id="Notes_003a-25"></span><h4 class="subsubheading">Notes:</h4>

<p><code>fdefinition</code> cannot <i>access</i> the value of a lexical function name
produced by <code>flet</code> or <code>labels</code>; it can <i>access</i> only
the global function value.
</p>
<p><code>setf</code> can be used with 
<code>fdefinition</code> to replace a global function
definition when the <var>function-name</var>&rsquo;s function definition 
does not represent a <i>special form</i>.
<code>setf</code> of <code>fdefinition</code> 
requires a <i>function</i> as the new value.
It is an error to set the <code>fdefinition</code> of a <var>function-name</var>
to a <i>symbol</i>, a <i>list</i>, or the value returned
by <code>fdefinition</code> on the name of a <i>macro</i> 
or <i>special form</i>.
</p>

<hr>
<span id="fboundp"></span><div class="header">
<p>
Next: <a href="#fmakunbound" accesskey="n" rel="next">fmakunbound</a>, Previous: <a href="#fdefinition" accesskey="p" rel="prev">fdefinition</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">fboundp</h4>
<span id="fboundp-_0028Function_0029"></span><h3 class="heading">fboundp (Function)</h3>
<span id="index-fboundp-2"></span>
<span id="index-fboundp"></span>


<span id="Syntax_003a-38"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-fboundp-1">Function: <strong>fboundp</strong> <em>name <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Pronunciation_003a"></span><h4 class="subsubheading">Pronunciation:</h4>

<p>[ˌefˈba\.undpē]
</p>
<span id="Arguments-and-Values_003a-28"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>function name</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-57"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <i>true</i> if <var>name</var> is <i>fbound</i>; otherwise, returns <i>false</i>.
</p>
<span id="Examples_003a-34"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (fboundp 'car) <span class="roman">→</span> <i>true</i>
 (fboundp 'nth-value) <span class="roman">→</span> <i>false</i>
 (fboundp 'with-open-file) <span class="roman">→</span> <i>true</i>
 (fboundp 'unwind-protect) <span class="roman">→</span> <i>true</i>
 (defun my-function (x) x) <span class="roman">→</span> MY-FUNCTION
 (fboundp 'my-function) <span class="roman">→</span> <i>true</i>
 (let ((saved-definition (symbol-function 'my-function)))
   (unwind-protect (progn (fmakunbound 'my-function)
                          (fboundp 'my-function))
     (setf (symbol-function 'my-function) saved-definition)))
<span class="roman">→</span> <i>false</i>
 (fboundp 'my-function) <span class="roman">→</span> <i>true</i>
 (defmacro my-macro (x) `',x) <span class="roman">→</span> MY-MACRO
 (fboundp 'my-macro) <span class="roman">→</span> <i>true</i>
 (fmakunbound 'my-function) <span class="roman">→</span> MY-FUNCTION
 (fboundp 'my-function) <span class="roman">→</span> <i>false</i>
 (flet ((my-function (x) x))
   (fboundp 'my-function)) <span class="roman">→</span> <i>false</i>
</pre></div>


<span id="Exceptional-Situations_003a-11"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>Should signal an error of <i>type</i> <code>type-error</code> if <var>name</var> is not a <i>function name</i>.
</p>
<span id="See-Also_003a-44"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Symbols.html#symbol_002dfunction">symbol-function</a>, <a href="#fmakunbound">fmakunbound</a>, <a href="#fdefinition">fdefinition</a>
</p>
<span id="Notes_003a-26"></span><h4 class="subsubheading">Notes:</h4>

<p>It is permissible to call <code>symbol-function</code> on any <i>symbol</i>
that is <i>fbound</i>.
</p>
<p><code>fboundp</code> is sometimes used to &ldquo;guard&rdquo;
an access to the <i>function cell</i>, as in:
</p><div class="lisp">
<pre class="lisp">(if (fboundp x) (symbol-function x))
</pre></div>


<p>Defining a <i>setf expander</i> <var>F</var> does not cause the <i>setf function</i>
<code>(setf <var>F</var>)</code> to become defined.
</p>

<hr>
<span id="fmakunbound"></span><div class="header">
<p>
Next: <a href="#flet_003b-labels_003b-macrolet" accesskey="n" rel="next">flet; labels; macrolet</a>, Previous: <a href="#fboundp" accesskey="p" rel="prev">fboundp</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">fmakunbound</h4>
<span id="fmakunbound-_0028Function_0029"></span><h3 class="heading">fmakunbound (Function)</h3>
<span id="index-fmakunbound-2"></span>
<span id="index-fmakunbound"></span>


<span id="Syntax_003a-39"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-fmakunbound-1">Function: <strong>fmakunbound</strong> <em>name <span class="roman">→</span> name</em></dt>
</dl>

<span id="Pronunciation_003a-1"></span><h4 class="subsubheading">Pronunciation:</h4>

<p>[ˌefˈmakə nˌba\.und]
or [ˌefˈmā kə nˌba\.und]
</p>
<span id="Arguments-and-Values_003a-29"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>function name</i>.
</p>
<span id="Description_003a-58"></span><h4 class="subsubheading">Description:</h4>

<p>Removes the <i>function</i> or <i>macro</i> definition, if any, of <var>name</var> 
in the <i>global environment</i>.
</p>
<span id="Examples_003a-35"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp">(defun add-some (x) (+ x 19)) <span class="roman">→</span> ADD-SOME
 (fboundp 'add-some) <span class="roman">→</span> <i>true</i>
 (flet ((add-some (x) (+ x 37)))
    (fmakunbound 'add-some)
    (add-some 1)) <span class="roman">→</span> 38
 (fboundp 'add-some) <span class="roman">→</span> <i>false</i>
</pre></div>


<span id="Exceptional-Situations_003a-12"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>Should signal an error of <i>type</i> <code>type-error</code> if <var>name</var> is not a <i>function name</i>.
</p>
<p>The consequences are undefined if <var>name</var> is a <i>special operator</i>.
</p>
<span id="See-Also_003a-45"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#fboundp">fboundp</a>, <a href="Symbols.html#makunbound">makunbound</a>
</p>

<hr>
<span id="flet_003b-labels_003b-macrolet"></span><div class="header">
<p>
Next: <a href="#funcall" accesskey="n" rel="next">funcall</a>, Previous: <a href="#fmakunbound" accesskey="p" rel="prev">fmakunbound</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">flet; labels; macrolet</h4>
<span id="flet_002c-labels_002c-macrolet-_0028Special-Operator_0029"></span><h3 class="heading">flet, labels, macrolet (Special Operator)</h3>
<span id="index-flet-2"></span>
<span id="index-flet"></span>
<span id="index-labels-2"></span>
<span id="index-labels"></span>
<span id="index-macrolet-3"></span>
<span id="index-macrolet-1"></span>
<span id="flet"></span><span id="labels"></span><span id="macrolet"></span>


<span id="Syntax_003a-40"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-flet-1">Special Form: <strong>flet</strong> <em><tt>(</tt><tt>{</tt><tt>(</tt><var><span class="nolinebreak">function-name</span></var>&nbsp;&nbsp;<var><span class="nolinebreak">lambda-list</span></var>&nbsp;〚<tt>{</tt><span class="nolinebreak">local-declaration</span><tt>}</tt>*&nbsp;<span class="roman">|</span>&nbsp;<span class="nolinebreak">local-documentation〛</span>&nbsp;<tt>{</tt><span class="nolinebreak">local-form</span><tt>}</tt>*<tt>)</tt><tt>}</tt>*<tt>)</tt><!-- /@w --> <tt>{</tt>declaration<tt>}</tt>*&nbsp;<tt>{</tt>form<tt>}</tt>*<!-- /@w --> <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl>
<dt id="index-labels-1">Special Form: <strong>labels</strong> <em><tt>(</tt><tt>{</tt><tt>(</tt><var><span class="nolinebreak">function-name</span></var>&nbsp;&nbsp;<var><span class="nolinebreak">lambda-list</span></var>&nbsp;〚<tt>{</tt><span class="nolinebreak">local-declaration</span><tt>}</tt>*&nbsp;<span class="roman">|</span>&nbsp;<span class="nolinebreak">local-documentation〛</span>&nbsp;<tt>{</tt><span class="nolinebreak">local-form</span><tt>}</tt>*<tt>)</tt><tt>}</tt>*<tt>)</tt><!-- /@w --> <tt>{</tt>declaration<tt>}</tt>*&nbsp;<tt>{</tt>form<tt>}</tt>*<!-- /@w --> <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl>
<dt id="index-macrolet-2">Special Form: <strong>macrolet</strong> <em><tt>(</tt><tt>{</tt><tt>(</tt><var>name</var>&nbsp;&nbsp;<var><span class="nolinebreak">lambda-list</span></var>&nbsp;〚<tt>{</tt><span class="nolinebreak">local-declaration</span><tt>}</tt>*&nbsp;<span class="roman">|</span>&nbsp;<span class="nolinebreak">local-documentation〛</span>&nbsp;<tt>{</tt><span class="nolinebreak">local-form</span><tt>}</tt>*<tt>)</tt><tt>}</tt>*<tt>)</tt><!-- /@w --> <tt>{</tt>declaration<tt>}</tt>*&nbsp;<tt>{</tt>form<tt>}</tt>*<!-- /@w --> <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-30"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function-name</var>&mdash;a <i>function name</i>.
</p>
<p><var>name</var>&mdash;a <i>symbol</i>.
</p>
<p><var>lambda-list</var>&mdash;a <i>lambda list</i>; 
for <code>flet</code> and <code>labels</code>,
it is an <i>ordinary lambda list</i>;
for <code>macrolet</code>,
it is a <i>macro lambda list</i>.
</p>
<p><var>local-declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>local-documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<p><var>local-forms</var>, <var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> of the <var>forms</var>.
</p>
<span id="Description_003a-59"></span><h4 class="subsubheading">Description:</h4>

<p><code>flet</code>, <code>labels</code>, and <code>macrolet</code>
define local <i>functions</i> and <i>macros</i>, and execute
<var>forms</var> using the local definitions.
<var>Forms</var> are executed  in order of occurrence.
</p>
<p>The body forms (but not the <i>lambda list</i>)
of each <i>function</i> created by <code>flet</code> and <code>labels</code> 
and each <i>macro</i> created by <code>macrolet</code>
are enclosed in an <i>implicit block</i> whose name 
is the <i>function block name</i> of the <var>function-name</var> or <var>name</var>, 
as appropriate.
</p>
<p>The scope of the <var>declarations</var>
between
the list of local function/macro definitions and the body <var>forms</var>
in <code>flet</code> and <code>labels</code> 
does not include the bodies of the
locally defined <i>functions</i>, except that for <code>labels</code>,
any <code>inline</code>, <code>notinline</code>, or <code>ftype</code> declarations
that refer to the locally defined functions do apply to the local function
bodies. That is, their <i>scope</i> 
is the same as the function name that they
affect.  
The scope of these <var>declarations</var> 
does not include the bodies of the macro expander
functions defined by <code>macrolet</code>.  
</p>

<dl compact="compact">
<dt><b>flet</b></dt>
<dd>

<p><code>flet</code> defines locally named <i>functions</i> and executes a series of
<var>forms</var> with these definition <i>bindings</i>.  Any number of
such local <i>functions</i> can be defined.  
</p>
<p>The <i>scope</i> of the name <i>binding</i> encompasses only the body.
Within the
body of <code>flet</code>, 
<var>function-names</var> matching those defined
by <code>flet</code> 
refer to the locally defined <i>functions</i> 
rather than to
the global function definitions of the same name.
Also, within the scope of <code>flet</code>, 
global <i>setf expander</i> definitions of the <var>function-name</var>
defined by <code>flet</code> do not apply. 
Note that this applies to 
<code>(defsetf <i>f</i> ...)</code>, not
<code>(defmethod (setf <i>f</i>) ...)</code>.
</p>
<p>The names of <i>functions</i> defined by <code>flet</code> 
are in the <i>lexical environment</i>; they retain
their local definitions only within the body of <code>flet</code>.
The function definition bindings are visible only in
the body of <code>flet</code>, not the definitions themselves.  Within the
function definitions, local function names
that match those being
defined refer to <i>functions</i> or 
<i>macros</i> defined outside the <code>flet</code>.
<code>flet</code> can locally <i>shadow</i> a global function name,
and the new definition can refer to the global definition.
</p>
<p>Any <var>local-documentation</var> is attached to the corresponding local <var>function</var>
(if one is actually created) as a <i>documentation string</i>.
</p>
</dd>
<dt><b>labels</b></dt>
<dd>

<p><code>labels</code> is equivalent to <code>flet</code> except that
the scope of the defined function names for <code>labels</code> 
encompasses the function definitions themselves as well as the body.
</p>
</dd>
<dt><b>macrolet</b></dt>
<dd>

<p><code>macrolet</code> 
establishes local <i>macro</i> definitions,
using the same format used by <code>defmacro</code>.
</p>
<p>Within the body of <code>macrolet</code>, 
global <i>setf expander</i> definitions of the <var>names</var> defined by the 
<code>macrolet</code> do not apply; rather, <code>setf</code> expands the
<i>macro form</i> and recursively process the resulting <i>form</i>.
</p>
<p>The macro-expansion functions defined by <code>macrolet</code> 
are defined in the 
<i>lexical environment</i> in which the <code>macrolet</code> form appears.
Declarations and <code>macrolet</code> and 
<code>symbol-macrolet</code> definitions
affect the local macro definitions in a <code>macrolet</code>, but the
consequences are undefined if the local macro definitions reference
any local <i>variable</i> or <i>function</i> <i>bindings</i> that are visible in that
<i>lexical environment</i>.
</p>
<p>Any <var>local-documentation</var> is attached to the corresponding local <var>macro function</var>
as a <i>documentation string</i>.
</p></dd>
</dl>


<span id="Examples_003a-36"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (defun foo (x flag)
   (macrolet ((fudge (z)
                 ;The parameters x and flag are not accessible
                 ; at this point; a reference to flag would be to
                 ; the global variable of that name.
                 ` <!-- /@w -->(if flag (* ,z ,z) ,z)))
    ;The parameters x and flag are accessible here.
     (+ x
        (fudge x)
        (fudge (+ x 1)))))
 ≡
 (defun foo (x flag)
   (+ x
      (if flag (* x x) x)
      (if flag (* (+ x 1) (+ x 1)) (+ x 1))))
</pre></div>

<p>after macro expansion.  The occurrences of <code>x</code> and <code>flag</code> legitimately
refer to the parameters of the function <code>foo</code> because those parameters are
visible at the site of the macro call which produced the expansion.
</p>

<div class="lisp">
<pre class="lisp"> (flet ((flet1 (n) (+ n n)))
    (flet ((flet1 (n) (+ 2 (flet1 n))))
      (flet1 2))) <span class="roman">→</span> 6

 (defun dummy-function () 'top-level) <span class="roman">→</span> DUMMY-FUNCTION 
 (funcall #'dummy-function) <span class="roman">→</span> TOP-LEVEL 
 (flet ((dummy-function () 'shadow)) 
      (funcall #'dummy-function)) <span class="roman">→</span> SHADOW 
 (eq (funcall #'dummy-function) (funcall 'dummy-function))
<span class="roman">→</span> <i>true</i> 
 (flet ((dummy-function () 'shadow))
   (eq (funcall #'dummy-function)
       (funcall 'dummy-function)))
<span class="roman">→</span> <i>false</i> 

 (defun recursive-times (k n)
   (labels ((temp (n) 
              (if (zerop n) 0 (+ k (temp (1- n))))))
     (temp n))) <span class="roman">→</span> RECURSIVE-TIMES
 (recursive-times 2 3) <span class="roman">→</span> 6

 (defmacro mlets (x &amp;environment env) 
    (let ((form `(babbit ,x)))
      (macroexpand form env))) <span class="roman">→</span> MLETS
 (macrolet ((babbit (z) `(+ ,z ,z))) (mlets 5)) <span class="roman">→</span> 10
</pre></div>


<div class="lisp">
<pre class="lisp"> (flet ((safesqrt (x) (sqrt (abs x))))
  ;; The safesqrt function is used in two places.
   (safesqrt (apply #'+ (map 'list #'safesqrt '(1 2 3 4 5 6)))))
<span class="roman">→</span> 3.291173
</pre></div>


<div class="lisp">
<pre class="lisp"> (defun integer-power (n k)     
   (declare (integer n))         
   (declare (type (integer 0 *) k))
   (labels ((expt0 (x k a)
              (declare (integer x a) (type (integer 0 *) k))
              (cond ((zerop k) a)
                    ((evenp k) (expt1 (* x x) (floor k 2) a))
                    (t (expt0 (* x x) (floor k 2) (* x a)))))
            (expt1 (x k a)
              (declare (integer x a) (type (integer 0 *) k))
              (cond ((evenp k) (expt1 (* x x) (floor k 2) a))
                    (t (expt0 (* x x) (floor k 2) (* x a))))))
    (expt0 n k 1))) <span class="roman">→</span> INTEGER-POWER
</pre></div>


<div class="lisp">
<pre class="lisp"> (defun example (y l)
   (flet ((attach (x)
            (setq l (append l (list x)))))
     (declare (inline attach))
     (dolist (x y)
       (unless (null (cdr x))
         (attach x)))
     l))

 (example '((a apple apricot) (b banana) (c cherry) (d) (e))
          '((1) (2) (3) (4 2) (5) (6 3 2)))
<span class="roman">→</span> ((1) (2) (3) (4 2) (5) (6 3 2) (A APPLE APRICOT) (B BANANA) (C CHERRY))
</pre></div>


<span id="See-Also_003a-46"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Evaluation-and-Compilation.html#declare">declare</a>,
<a href="Evaluation-and-Compilation.html#defmacro">defmacro</a>,
<a href="#defun">defun</a>,
<a href="Environment.html#documentation">documentation</a>,
<a href="#let">let</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>,
<a href="Evaluation-and-Compilation.html#Syntactic-Interaction-of-Documentation-Strings-and-Declarations">Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)</a>
</p>
<span id="Notes_003a-27"></span><h4 class="subsubheading">Notes:</h4>

<p>It is not possible to define recursive <i>functions</i> with <code>flet</code>.
<code>labels</code> can be used to define mutually recursive <i>functions</i>.
</p>
<p>If a <code>macrolet</code> <i>form</i> is a <i>top level form</i>,
the body <var>forms</var> are also processed as <i>top level forms</i>.
See <a href="Evaluation-and-Compilation.html#File-Compilation">Section 3.2.3 (File Compilation)</a>.
</p>


<hr>
<span id="funcall"></span><div class="header">
<p>
Next: <a href="#function-_0028Special-Operator_0029" accesskey="n" rel="next">function (Special Operator)</a>, Previous: <a href="#flet_003b-labels_003b-macrolet" accesskey="p" rel="prev">flet; labels; macrolet</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">funcall</h4>
<span id="funcall-_0028Function_0029"></span><h3 class="heading">funcall (Function)</h3>
<span id="index-funcall-2"></span>
<span id="index-funcall"></span>


<span id="Syntax_003a-41"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-funcall-1">Function: <strong>funcall</strong> <em>function <tt>&amp;rest</tt> args <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-31"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function</var>&mdash;a <i>function designator</i>.
</p>
<p><var>args</var>&mdash;<i>arguments</i> to the <var>function</var>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <var>function</var>.
</p>
<span id="Description_003a-60"></span><h4 class="subsubheading">Description:</h4>

<p><code>funcall</code> applies <var>function</var> to <var>args</var>.
If <var>function</var> is a <i>symbol</i>,
it is coerced to a <i>function</i> as if by
finding its <i>functional value</i> in the <i>global environment</i>.
</p>
<span id="Examples_003a-37"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (funcall #'+ 1 2 3) <span class="roman">→</span> 6
 (funcall 'car '(1 2 3)) <span class="roman">→</span> 1
 (funcall 'position 1 '(1 2 3 2 1) :start 1) <span class="roman">→</span> 4
 (cons 1 2) <span class="roman">→</span> (1 . 2)
 (flet ((cons (x y) `(kons ,x ,y)))
   (let ((cons (symbol-function '+)))
     (funcall #'cons
              (funcall 'cons 1 2)
              (funcall cons 1 2))))
<span class="roman">→</span> (KONS (1 . 2) 3)
</pre></div>


<span id="Exceptional-Situations_003a-13"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>An error of <i>type</i> <code>undefined-function</code> should be signaled if <var>function</var> 
is a <i>symbol</i> that does not have a global definition as a <i>function</i>
or that has a global definition as a <i>macro</i> or a <i>special operator</i>.
</p>
<span id="See-Also_003a-47"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#apply">apply</a>, <a href="#function-_0028Special-Operator_0029">function (Special Operator)</a>, <a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-28"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (funcall <var>function</var> <var>arg1</var> <var>arg2</var> ...)
 ≡ (apply <var>function</var> <var>arg1</var> <var>arg2</var> ... nil)
 ≡ (apply <var>function</var> (list <var>arg1</var> <var>arg2</var> ...))
</pre></div>


<p>The difference between <code>funcall</code> and an ordinary function call is that
in the former case the <var>function</var> is obtained by ordinary <i>evaluation</i>
of a <i>form</i>, and in the latter case it is obtained by the special 
interpretation of the function position that normally occurs.
</p>

<hr>
<span id="function-_0028Special-Operator_0029"></span><div class="header">
<p>
Next: <a href="#function_002dlambda_002dexpression" accesskey="n" rel="next">function-lambda-expression</a>, Previous: <a href="#funcall" accesskey="p" rel="prev">funcall</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">function (Special Operator)</h4>
<span id="function-_0028Special-Operator_0029-1"></span><h3 class="heading">function (Special Operator)</h3>
<span id="index-function-5"></span>
<span id="index-function-2"></span>



<span id="Syntax_003a-42"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-function-3">Special Form: <strong>function</strong> <em>name <span class="roman">→</span> function</em></dt>
</dl>

<span id="Arguments-and-Values_003a-32"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>function name</i> or <i>lambda expression</i>.
</p>
<p><var>function</var>&mdash;a <i>function</i> <i>object</i>.
</p>
<span id="Description_003a-61"></span><h4 class="subsubheading">Description:</h4>

<p>The <i>value</i> of <code>function</code> is the <i>functional value</i> of <var>name</var>
in the current <i>lexical environment</i>.
</p>
<p>If <var>name</var> is a <i>function name</i>, the functional definition of that name
is that
established by the innermost lexically enclosing
<code>flet</code>, <code>labels</code>, or <code>macrolet</code> <i>form</i>,
if there is one.  Otherwise the global functional definition of the
<i>function name</i>
is returned.
</p>
<p>If <var>name</var> is a <i>lambda expression</i>, then a <i>lexical closure</i>
is returned.  In situations where a <i>closure</i> over the same set of
<i>bindings</i> might be produced more than once, the various resulting
<i>closures</i> might or might not be <code>eq</code>.
</p>
<p>It is an error to use <code>function</code> on a <i>function name</i> 
that does not denote a <i>function</i> in the lexical environment in
which the <code>function</code> form appears. 
Specifically, it is an error to use <code>function</code> on a <i>symbol</i> 
that denotes a <i>macro</i> or <i>special form</i>.
An implementation may choose not to signal this error for
performance reasons, but implementations are forbidden from
defining the failure to signal an error as a useful behavior.
</p>
<span id="Examples_003a-38"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (defun adder (x) (function (lambda (y) (+ x y))))
</pre></div>

<p>The result of <code>(adder 3)</code> is a function that adds <code>3</code> to its argument:
</p>
<div class="lisp">
<pre class="lisp"> (setq add3 (adder 3))
 (funcall add3 5) <span class="roman">→</span> 8
</pre></div>

<p>This works because <code>function</code> creates a <i>closure</i> of
the <i>lambda expression</i> that is able to refer to the <i>value</i> <code>3</code>
of the variable <code>x</code> even after control has returned from the function <code>adder</code>.
</p>
<span id="See-Also_003a-48"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#defun">defun</a>,
<a href="#fdefinition">fdefinition</a>,
<a href="#flet">flet</a>,
<a href="#labels">labels</a>,
<a href="Symbols.html#symbol_002dfunction">symbol-function</a>,
<a href="Evaluation-and-Compilation.html#SymbolsAsForms">Section 3.1.2.1.1 (Symbols as Forms)</a>,
<a href="Syntax.html#SharpsignQuote">Section 2.4.8.2 (Sharpsign Single-Quote)</a>,
<a href="Printer.html#PrintingOtherObjects">Section 22.1.3.13 (Printing Other Objects)</a>
</p>
<span id="Notes_003a-29"></span><h4 class="subsubheading">Notes:</h4>

<p>The notation <code>#'<var>name</var></code> may be used as an abbreviation
for <code>(function <var>name</var>)</code>.
</p>

<hr>
<span id="function_002dlambda_002dexpression"></span><div class="header">
<p>
Next: <a href="#functionp" accesskey="n" rel="next">functionp</a>, Previous: <a href="#function-_0028Special-Operator_0029" accesskey="p" rel="prev">function (Special Operator)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">function-lambda-expression</h4>
<span id="function_002dlambda_002dexpression-_0028Function_0029"></span><h3 class="heading">function-lambda-expression (Function)</h3>
<span id="index-function_002dlambda_002dexpression-2"></span>
<span id="index-function_002dlambda_002dexpression"></span>



<span id="Syntax_003a-43"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-function_002dlambda_002dexpression-1">Function: <strong>function-lambda-expression</strong> <em>function <span class="roman">→</span> lambda-expression, closure-p, name</em></dt>
</dl>

<span id="Arguments-and-Values_003a-33"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function</var>&mdash;a <i>function</i>.
</p>
<p><var>lambda-expression</var>&mdash;a <i>lambda expression</i> or <code>nil</code>.
</p>
<p><var>closure-p</var>&mdash;a <i>generalized boolean</i>.
</p>
<p><var>name</var>&mdash;an <i>object</i>.
</p>
<span id="Description_003a-62"></span><h4 class="subsubheading">Description:</h4>

<p>Returns information about <var>function</var> as follows:
</p>
<p>The <i>primary value</i>, <var>lambda-expression</var>,
is <var>function</var>&rsquo;s defining <i>lambda expression</i>, 
or <code>nil</code>&nbsp;<!-- /@w -->if the information is not available.  The <i>lambda expression</i>
may have been pre-processed in some ways, but it should remain a suitable 
argument to <code>compile</code> or <code>function</code>.
Any <i>implementation</i> may legitimately return <code>nil</code>&nbsp;<!-- /@w -->
as the <var>lambda-expression</var> of any <var>function</var>.
</p>
<p>The <i>secondary value</i>, <var>closure-p</var>,
is <code>nil</code>&nbsp;<!-- /@w -->if <var>function</var>&rsquo;s definition was enclosed
in the <i>null lexical environment</i> or something <i>non-nil</i> if
<var>function</var>&rsquo;s definition might have been enclosed in some 
<i>non-null lexical environment</i>.
Any <i>implementation</i> may legitimately return <i>true</i>
as the <var>closure-p</var> of any <var>function</var>.
</p>
<p>The <i>tertiary value</i>, <var>name</var>,
is the &ldquo;name&rdquo; of <var>function</var>. 
The name is intended for debugging only and is not necessarily one that would
be valid for use as a name in <code>defun</code> or <code>function</code>, for example.
By convention, <code>nil</code>&nbsp;<!-- /@w -->is used to mean that <var>function</var> has no name.
Any <i>implementation</i> may legitimately return <code>nil</code>&nbsp;<!-- /@w -->
as the <var>name</var> of any <var>function</var>.
</p>

<span id="Examples_003a-39"></span><h4 class="subsubheading">Examples:</h4>

<p>The following examples illustrate some possible return values, but
are not intended to be exhaustive:
</p>
<div class="lisp">
<pre class="lisp"> (function-lambda-expression #'(lambda (x) x))
<span class="roman">→</span> NIL, <i>false</i>, NIL
or<span class="roman">→</span> NIL, <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) X), <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) X), <i>false</i>, NIL

 (function-lambda-expression
    (funcall #'(lambda () #'(lambda (x) x))))
<span class="roman">→</span> NIL, <i>false</i>, NIL
or<span class="roman">→</span> NIL, <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) X), <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) X), <i>false</i>, NIL
 
 (function-lambda-expression 
    (funcall #'(lambda (x) #'(lambda () x)) nil))
<span class="roman">→</span> NIL, <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA () X), <i>true</i>, NIL
not<span class="roman">→</span> NIL, <i>false</i>, NIL
not<span class="roman">→</span> (LAMBDA () X), <i>false</i>, NIL
  
 (flet ((foo (x) x))
   (setf (symbol-function 'bar) #'foo)
   (function-lambda-expression #'bar))
<span class="roman">→</span> NIL, <i>false</i>, NIL
or<span class="roman">→</span> NIL, <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) (BLOCK FOO X)), <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) (BLOCK FOO X)), <i>false</i>, FOO
or<span class="roman">→</span> (SI::BLOCK-LAMBDA FOO (X) X), <i>false</i>, FOO
 
 (defun foo ()
   (flet ((bar (x) x))
     #'bar))
 (function-lambda-expression (foo))
<span class="roman">→</span> NIL, <i>false</i>, NIL
or<span class="roman">→</span> NIL, <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) (BLOCK BAR X)), <i>true</i>, NIL
or<span class="roman">→</span> (LAMBDA (X) (BLOCK BAR X)), <i>true</i>, (:INTERNAL FOO 0 BAR)
or<span class="roman">→</span> (LAMBDA (X) (BLOCK BAR X)), <i>false</i>, &quot;BAR in FOO&quot;
</pre></div>


<span id="Notes_003a-30"></span><h4 class="subsubheading">Notes:</h4>

<p>Although <i>implementations</i> are free to return &ldquo;<code>nil</code>, <i>true</i>, <code>nil</code>&rdquo; in all cases, 
they are encouraged to return a <i>lambda expression</i> as the <i>primary value</i>
in the case where the argument was created by a call to <code>compile</code> 
or <code>eval</code> (as opposed to being created by <i>loading</i> a <i>compiled file</i>).
</p>


<hr>
<span id="functionp"></span><div class="header">
<p>
Next: <a href="#compiled_002dfunction_002dp" accesskey="n" rel="next">compiled-function-p</a>, Previous: <a href="#function_002dlambda_002dexpression" accesskey="p" rel="prev">function-lambda-expression</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">functionp</h4>
<span id="functionp-_0028Function_0029"></span><h3 class="heading">functionp (Function)</h3>
<span id="index-functionp-2"></span>
<span id="index-functionp"></span>



<span id="Syntax_003a-44"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-functionp-1">Function: <strong>functionp</strong> <em>object <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-34"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>object</var>&mdash;an <i>object</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-63"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <i>true</i> if <var>object</var> is of <i>type</i> <code>function</code>;
otherwise, returns <i>false</i>.
</p>
<span id="Examples_003a-40"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (functionp 'append) <span class="roman">→</span> <i>false</i>
 (functionp #'append) <span class="roman">→</span> <i>true</i>
 (functionp (symbol-function 'append)) <span class="roman">→</span> <i>true</i>
 (flet ((f () 1)) (functionp #'f)) <span class="roman">→</span> <i>true</i>
 (functionp (compile nil '(lambda () 259))) <span class="roman">→</span> <i>true</i>
 (functionp nil) <span class="roman">→</span> <i>false</i>
 (functionp 12) <span class="roman">→</span> <i>false</i>
 (functionp '(lambda (x) (* x x))) <span class="roman">→</span> <i>false</i>
 (functionp #'(lambda (x) (* x x))) <span class="roman">→</span> <i>true</i>
</pre></div>


<span id="Notes_003a-31"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (functionp <var>object</var>) ≡ (typep <var>object</var> 'function)
</pre></div>




<hr>
<span id="compiled_002dfunction_002dp"></span><div class="header">
<p>
Next: <a href="#call_002darguments_002dlimit" accesskey="n" rel="next">call-arguments-limit</a>, Previous: <a href="#functionp" accesskey="p" rel="prev">functionp</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">compiled-function-p</h4>
<span id="compiled_002dfunction_002dp-_0028Function_0029"></span><h3 class="heading">compiled-function-p (Function)</h3>
<span id="index-compiled_002dfunction_002dp-2"></span>
<span id="index-compiled_002dfunction_002dp"></span>


<span id="Syntax_003a-45"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-compiled_002dfunction_002dp-1">Function: <strong>compiled-function-p</strong> <em>object <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-35"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>object</var>&mdash;an <i>object</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-64"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <i>true</i> if <var>object</var> is of <i>type</i> <code>compiled-function</code>;
otherwise, returns <i>false</i>.
</p>
<span id="Examples_003a-41"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (defun f (x) x) <span class="roman">→</span> F
 (compiled-function-p #'f)
<span class="roman">→</span> <i>false</i>
or<span class="roman">→</span> <i>true</i>
 (compiled-function-p 'f) <span class="roman">→</span> <i>false</i>
 (compile 'f) <span class="roman">→</span> F
 (compiled-function-p #'f) <span class="roman">→</span> <i>true</i>
 (compiled-function-p 'f) <span class="roman">→</span> <i>false</i>
 (compiled-function-p (compile nil '(lambda (x) x)))
<span class="roman">→</span> <i>true</i>
 (compiled-function-p #'(lambda (x) x))
<span class="roman">→</span> <i>false</i>
or<span class="roman">→</span> <i>true</i>
 (compiled-function-p '(lambda (x) x)) <span class="roman">→</span> <i>false</i>
</pre></div>


<span id="See-Also_003a-49"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Evaluation-and-Compilation.html#compile">compile</a>,
<a href="System-Construction.html#compile_002dfile">compile-file</a>,
<a href="Types-and-Classes.html#compiled_002dfunction">compiled-function</a>
</p>
<span id="Notes_003a-32"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (compiled-function-p <var>object</var>) ≡ (typep <var>object</var> 'compiled-function)
</pre></div>



<hr>
<span id="call_002darguments_002dlimit"></span><div class="header">
<p>
Next: <a href="#lambda_002dlist_002dkeywords" accesskey="n" rel="next">lambda-list-keywords</a>, Previous: <a href="#compiled_002dfunction_002dp" accesskey="p" rel="prev">compiled-function-p</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">call-arguments-limit</h4>
<span id="call_002darguments_002dlimit-_0028Constant-Variable_0029"></span><h3 class="heading">call-arguments-limit (Constant Variable)</h3>
<span id="index-call_002darguments_002dlimit-1"></span>
<span id="index-call_002darguments_002dlimit"></span>


<span id="Constant-Value_003a"></span><h4 class="subsubheading">Constant Value:</h4>

<p>An integer not smaller than <code>50</code> and at least as great as 
the <i>value</i> of <code>lambda-parameters-limit</code>, 
the exact magnitude of which is <i>implementation-dependent</i>.
</p>
<span id="Description_003a-65"></span><h4 class="subsubheading">Description:</h4>

<p>The upper exclusive bound on the number of <i>arguments</i> that 
may be passed to a <i>function</i>.
</p>
<span id="See-Also_003a-50"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#lambda_002dparameters_002dlimit">lambda-parameters-limit</a>, <a href="#multiple_002dvalues_002dlimit">multiple-values-limit</a>
</p>

<hr>
<span id="lambda_002dlist_002dkeywords"></span><div class="header">
<p>
Next: <a href="#lambda_002dparameters_002dlimit" accesskey="n" rel="next">lambda-parameters-limit</a>, Previous: <a href="#call_002darguments_002dlimit" accesskey="p" rel="prev">call-arguments-limit</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">lambda-list-keywords</h4>
<span id="lambda_002dlist_002dkeywords-_0028Constant-Variable_0029"></span><h3 class="heading">lambda-list-keywords (Constant Variable)</h3>
<span id="index-lambda_002dlist_002dkeywords-1"></span>
<span id="index-lambda_002dlist_002dkeywords"></span>


<span id="Constant-Value_003a-1"></span><h4 class="subsubheading">Constant Value:</h4>

<p>a <i>list</i>, the <i>elements</i> of which are <i>implementation-dependent</i>, 
but which must contain at least the <i>symbols</i> 
<code>&amp;allow-other-keys</code>,
<code>&amp;aux</code>,
<code>&amp;body</code>,
<code>&amp;environment</code>,
<code>&amp;key</code>,
<code>&amp;optional</code>,
<code>&amp;rest</code>,
and
<code>&amp;whole</code>.
</p>
<span id="Description_003a-66"></span><h4 class="subsubheading">Description:</h4>

<p>A <i>list</i> of all the <i>lambda list keywords</i> used 
in the <i>implementation</i>, including the additional ones
used only by <i>macro</i> definition <i>forms</i>.
</p>
<span id="See-Also_003a-51"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#defun">defun</a>,
<a href="#flet">flet</a>,
<a href="Evaluation-and-Compilation.html#defmacro">defmacro</a>,
<a href="#macrolet">macrolet</a>,
<a href="Evaluation-and-Compilation.html#The-Evaluation-Model">Section 3.1.2 (The Evaluation Model)</a>
</p>

<hr>
<span id="lambda_002dparameters_002dlimit"></span><div class="header">
<p>
Next: <a href="#defconstant" accesskey="n" rel="next">defconstant</a>, Previous: <a href="#lambda_002dlist_002dkeywords" accesskey="p" rel="prev">lambda-list-keywords</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">lambda-parameters-limit</h4>
<span id="lambda_002dparameters_002dlimit-_0028Constant-Variable_0029"></span><h3 class="heading">lambda-parameters-limit (Constant Variable)</h3>
<span id="index-lambda_002dparameters_002dlimit-1"></span>
<span id="index-lambda_002dparameters_002dlimit"></span>


<span id="Constant-Value_003a-2"></span><h4 class="subsubheading">Constant Value:</h4>

<p><i>implementation-dependent</i>, but not smaller than <code>50</code>.
</p>
<span id="Description_003a-67"></span><h4 class="subsubheading">Description:</h4>

<p>A positive <i>integer</i> that is the upper exclusive bound on 
the number of <i>parameter</i> <i>names</i> that can appear 
in a single <i>lambda list</i>.
</p>
<span id="See-Also_003a-52"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#call_002darguments_002dlimit">call-arguments-limit</a>
</p>
<span id="Notes_003a-33"></span><h4 class="subsubheading">Notes:</h4>

<p>Implementors are encouraged to make the <i>value</i> of
<code>lambda-parameters-limit</code> as large as possible.
</p>

<hr>
<span id="defconstant"></span><div class="header">
<p>
Next: <a href="#defparameter_003b-defvar" accesskey="n" rel="next">defparameter; defvar</a>, Previous: <a href="#lambda_002dparameters_002dlimit" accesskey="p" rel="prev">lambda-parameters-limit</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">defconstant</h4>
<span id="defconstant-_0028Macro_0029"></span><h3 class="heading">defconstant (Macro)</h3>
<span id="index-defconstant-2"></span>
<span id="index-defconstant"></span>


<span id="Syntax_003a-46"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-defconstant-1">Macro: <strong>defconstant</strong> <em>name initial-value <tt>[</tt>documentation<tt>]</tt> <span class="roman">→</span> name</em></dt>
</dl>

<span id="Arguments-and-Values_003a-36"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>symbol</i>; not evaluated.
</p>
<p><var>initial-value</var>&mdash;a <i>form</i>; evaluated.
</p>
<p><var>documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<span id="Description_003a-68"></span><h4 class="subsubheading">Description:</h4>

<p><code>defconstant</code> 
causes the global variable named by <var>name</var> to be 
given a value that is the result of evaluating <var>initial-value</var>.
</p>
<p>A constant defined by <code>defconstant</code> can be redefined
with <code>defconstant</code>.
However, the consequences are undefined if an attempt is made to assign
a <i>value</i> to the <i>symbol</i> using another operator, or to
assign it to a <i>different</i>
<i>value</i> using a subsequent
<code>defconstant</code>.
</p>
<p>If <var>documentation</var> is supplied, it is attached to <var>name</var> as a
<i>documentation string</i> of kind <tt>variable</tt>. 
</p>
<p><code>defconstant</code> 
normally appears as a <i>top level form</i>, but it is meaningful
for it to appear as a <i>non-top-level form</i>.
However, the compile-time side
effects described below
only take place when <code>defconstant</code> appears as a 
<i>top level form</i>.
</p>

<p>The consequences are undefined if there are any 
<i>bindings</i>
of the variable named by <var>name</var> at the time <code>defconstant</code> 
is executed or if the value is not <code>eql</code> to the value of
<var>initial-value</var>.
</p>
<p>The consequences are undefined when constant <i>symbols</i> are rebound
as either lexical or dynamic variables.  In other words, a reference to a
<i>symbol</i> declared with <code>defconstant</code> always refers to its global value.
</p>
<p>The side effects of the execution of <code>defconstant</code> must
be equivalent to at least the side effects of the execution of the following
code:
</p>
<div class="lisp">
<pre class="lisp"> (setf (symbol-value '<i>name</i>) <i>initial-value</i>)
 (setf (documentation '<i>name</i> 'variable) '<i>documentation</i>)
</pre></div>


<p>If a <code>defconstant</code> <i>form</i> appears as a <i>top level form</i>,
the <i>compiler</i> must recognize that <var>name</var> names
a <i>constant variable</i>.  An implementation may choose to
evaluate the value-form at compile time, load time, or both.
Therefore, users must ensure that the <var>initial-value</var>
can be <i>evaluated</i> at compile time
(regardless of whether or not references to <var>name</var>
appear in the file) and that it always <i>evaluates</i>
to the same value.
</p>



<span id="Examples_003a-42"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (defconstant this-is-a-constant 'never-changing &quot;for a test&quot;) <span class="roman">→</span> THIS-IS-A-CONSTANT
this-is-a-constant <span class="roman">→</span> NEVER-CHANGING
 (documentation 'this-is-a-constant 'variable) <span class="roman">→</span> &quot;for a test&quot;
 (constantp 'this-is-a-constant) <span class="roman">→</span> <i>true</i>
</pre></div>


<span id="See-Also_003a-53"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Evaluation-and-Compilation.html#declaim">declaim</a>,
<a href="#defparameter">defparameter</a>, 
<a href="#defvar">defvar</a>,
<a href="Environment.html#documentation">documentation</a>,
<a href="Evaluation-and-Compilation.html#proclaim">proclaim</a>,
<a href="Evaluation-and-Compilation.html#ConstantVars">Section 3.1.2.1.1.3 (Constant Variables)</a>,
<a href="Evaluation-and-Compilation.html#Compilation">Section 3.2 (Compilation)</a>
</p>

<hr>
<span id="defparameter_003b-defvar"></span><div class="header">
<p>
Next: <a href="#destructuring_002dbind" accesskey="n" rel="next">destructuring-bind</a>, Previous: <a href="#defconstant" accesskey="p" rel="prev">defconstant</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">defparameter; defvar</h4>
<span id="defparameter_002c-defvar-_0028Macro_0029"></span><h3 class="heading">defparameter, defvar (Macro)</h3>
<span id="index-defparameter-2"></span>
<span id="index-defparameter"></span>
<span id="index-defvar-2"></span>
<span id="index-defvar"></span>
<span id="defparameter"></span><span id="defvar"></span>

<span id="Syntax_003a-47"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-defparameter-1">Macro: <strong>defparameter</strong> <em>name         initial-value <tt>[</tt>documentation<tt>]</tt>  <span class="roman">→</span> name</em></dt>
</dl>
<dl>
<dt id="index-defvar-1">Macro: <strong>defvar</strong> <em>name <tt>[</tt>initial-value <tt>[</tt>documentation<tt>]</tt><tt>]</tt> <span class="roman">→</span> name</em></dt>
</dl>

<span id="Arguments-and-Values_003a-37"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>symbol</i>; not evaluated.
</p>

<p><var>initial-value</var>&mdash;a <i>form</i>; 
for <code>defparameter</code>, it is always <i>evaluated</i>,
but for <code>defvar</code> it is <i>evaluated</i> 
only if <var>name</var> is not already <i>bound</i>.
</p>
<p><var>documentation</var>&mdash;a <var>string</var>; not evaluated.
</p>
<span id="Description_003a-69"></span><h4 class="subsubheading">Description:</h4>

<p><code>defparameter</code> and <code>defvar</code> <i>establish</i> <var>name</var> 
as a <i>dynamic variable</i>.
</p>
<p><code>defparameter</code> unconditionally
<i>assigns</i> the <var>initial-value</var> to the <i>dynamic variable</i> named <var>name</var>.
<code>defvar</code>, by contrast, <i>assigns</i> <var>initial-value</var> (if supplied) 
to the <i>dynamic variable</i> named <var>name</var> 
only if <var>name</var> is not already <i>bound</i>.
</p>
<p>If no <var>initial-value</var> is supplied,
<code>defvar</code> leaves the <i>value cell</i> of 
the <i>dynamic variable</i> named <var>name</var> undisturbed;
if <var>name</var> was previously <i>bound</i>, its old <i>value</i> persists,
and if it was previously <i>unbound</i>, it remains <i>unbound</i>.
</p>
<p>If <var>documentation</var> is supplied, it is attached to <var>name</var> as a
<i>documentation string</i> of kind <tt>variable</tt>. 
</p>
<p><code>defparameter</code> and <code>defvar</code> normally appear as a <i>top level form</i>, 
but it is meaningful for them to appear as <i>non-top-level forms</i>.  However,
the compile-time side effects described below only take place when
they appear as <i>top level forms</i>.
</p>
<span id="Examples_003a-43"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (defparameter *p* 1) <span class="roman">→</span> *P*
 *p* <span class="roman">→</span> 1
 (constantp '*p*) <span class="roman">→</span> <i>false</i>
 (setq *p* 2) <span class="roman">→</span> 2
 (defparameter *p* 3) <span class="roman">→</span> *P*
 *p* <span class="roman">→</span> 3

 (defvar *v* 1) <span class="roman">→</span> *V*
 *v* <span class="roman">→</span> 1
 (constantp '*v*) <span class="roman">→</span> <i>false</i>
 (setq *v* 2) <span class="roman">→</span> 2
 (defvar *v* 3) <span class="roman">→</span> *V*
 *v* <span class="roman">→</span> 2

 (defun foo ()
   (let ((*p* 'p) (*v* 'v))
     (bar))) <span class="roman">→</span> FOO
 (defun bar () (list *p* *v*)) <span class="roman">→</span> BAR
 (foo) <span class="roman">→</span> (P V)
</pre></div>


<p>The principal operational distinction between <code>defparameter</code> and <code>defvar</code>
is that <code>defparameter</code> makes an unconditional assignment to <var>name</var>,
while <code>defvar</code> makes a conditional one.  In practice, this means that
<code>defparameter</code> is useful in situations where loading or reloading the definition
would want to pick up a new value of the variable, while <code>defvar</code> is used in
situations where the old value would want to be retained if the file were loaded or reloaded.
For example, one might create a file which contained:
</p>
<div class="lisp">
<pre class="lisp"> (defvar *the-interesting-numbers* '())
 (defmacro define-interesting-number (name n)
   `(progn (defvar ,name ,n)
           (pushnew ,name *the-interesting-numbers*)
           ',name))
 (define-interesting-number *my-height* 168) ;cm
 (define-interesting-number *my-weight* 13)  ;stones
</pre></div>


<p>Here the initial value, <code>()</code>, for the variable <code>*the-interesting-numbers*</code>
is just a seed that we are never likely to want to reset to something else
once something has been grown from it.  As such, we have used <code>defvar</code> 
to avoid having the <code>*interesting-numbers*</code> information reset if the file is
loaded a second time.  It is true that the two calls to
<code>define-interesting-number</code> here would be reprocessed, but
if there were additional calls in another file, they would not be and that 
information would be lost.  On the other hand, consider the following code:
</p>
<div class="lisp">
<pre class="lisp"> (defparameter *default-beep-count* 3)
 (defun beep (&amp;optional (n *default-beep-count*))
   (dotimes (i n) (si:%beep 1000. 100000.) (sleep 0.1)))
</pre></div>


<p>Here we could easily imagine editing the code to change the initial value of
<code>*default-beep-count*</code>, and then reloading the file to pick up the new value.
In order to make value updating easy, we have used <code>defparameter</code>.
</p>
<p>On the other hand, there is potential value to using <code>defvar</code> in this
situation.  For example, suppose that someone had predefined an alternate
value for <code>*default-beep-count*</code>, or had loaded the file and then manually
changed the value.  In both cases, if we had used <code>defvar</code> instead of
<code>defparameter</code>, those user preferences would not be overridden by
(re)loading the file.
</p>
<p>The choice of whether to use <code>defparameter</code> or <code>defvar</code> has
visible consequences to programs, but is nevertheless often made for subjective
reasons.
</p>
<span id="Side-Effects_003a"></span><h4 class="subsubheading">Side Effects:</h4>

<p>If a <code>defvar</code> or <code>defparameter</code> <i>form</i> appears as a <i>top level form</i>,
the <i>compiler</i> must recognize that the <var>name</var> has been
proclaimed <code>special</code>.  However, it must neither <i>evaluate</i> 
the <var>initial-value</var> <i>form</i> nor <i>assign</i> the 
<i>dynamic variable</i> named <var>name</var> at compile time.
</p>
<p>There may be additional (<i>implementation-defined</i>) compile-time or 
run-time side effects, as long as such effects do not interfere with the
correct operation of <i>conforming programs</i>.
</p>
<span id="Affected-By_003a-4"></span><h4 class="subsubheading">Affected By:</h4>

<p><code>defvar</code> is affected by whether <var>name</var> is already <i>bound</i>.
</p>
<span id="See-Also_003a-54"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Evaluation-and-Compilation.html#declaim">declaim</a>, 
<a href="#defconstant">defconstant</a>,
<a href="Environment.html#documentation">documentation</a>,
<a href="Evaluation-and-Compilation.html#Compilation">Section 3.2 (Compilation)</a>
</p>
<span id="Notes_003a-34"></span><h4 class="subsubheading">Notes:</h4>

<p>It is customary to name <i>dynamic variables</i> with an <i>asterisk</i>
at the beginning and end of the name.  e.g., <code>*foo*</code> is a good name for
a <i>dynamic variable</i>, but not for a <i>lexical variable</i>;
<code>foo</code> is a good name for a <i>lexical variable</i>, 
but not for a <i>dynamic variable</i>.
This naming convention is observed for all <i>defined names</i> in <span class="roman">Common Lisp</span>;
however, neither <i>conforming programs</i> nor <i>conforming implementations</i>
are obliged to adhere to this convention.
</p>
<p>The intent of the permission for additional side effects is to allow
<i>implementations</i> to do normal &ldquo;bookkeeping&rdquo; that accompanies
definitions.  For example, the <i>macro expansion</i> of a <code>defvar</code>
or <code>defparameter</code> <i>form</i> might include code that arranges to
record the name of the source file in which the definition occurs.
</p>
<p><code>defparameter</code> and <code>defvar</code> might be defined as follows:
</p>
<div class="lisp">
<pre class="lisp"> (defmacro defparameter (name initial-value 
                         &amp;optional (documentation nil documentation-p))
   `(progn (declaim (special ,name))
           (setf (symbol-value ',name) ,initial-value)
           ,(when documentation-p
              `(setf (documentation ',name 'variable) ',documentation))
           ',name))
 (defmacro defvar (name &amp;optional
                        (initial-value nil initial-value-p)
                        (documentation nil documentation-p))
   `(progn (declaim (special ,name))
           ,(when initial-value-p
              `(unless (boundp ',name)
                 (setf (symbol-value ',name) ,initial-value)))
           ,(when documentation-p
              `(setf (documentation ',name 'variable) ',documentation))
           ',name))
</pre></div>



<hr>
<span id="destructuring_002dbind"></span><div class="header">
<p>
Next: <a href="#let_003b-let_002a" accesskey="n" rel="next">let; let*</a>, Previous: <a href="#defparameter_003b-defvar" accesskey="p" rel="prev">defparameter; defvar</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">destructuring-bind</h4>
<span id="destructuring_002dbind-_0028Macro_0029"></span><h3 class="heading">destructuring-bind (Macro)</h3>
<span id="index-destructuring_002dbind-2"></span>
<span id="index-destructuring_002dbind"></span>



<span id="Syntax_003a-48"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-destructuring_002dbind-1">Macro: <strong>destructuring-bind</strong> <em>lambda-list expression <tt>{</tt>declaration<tt>}</tt>* <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-38"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>lambda-list</var>&mdash;a <i>destructuring lambda list</i>.
</p>
<p><var>expression</var>&mdash;a <i>form</i>.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated. 
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <i>forms</i>.
</p>
<span id="Description_003a-70"></span><h4 class="subsubheading">Description:</h4>

<p><code>destructuring-bind</code> binds the variables specified in <var>lambda-list</var>
to the corresponding values in the tree structure resulting from the evaluation 
of <var>expression</var>; then <code>destructuring-bind</code> evaluates <var>forms</var>.
</p>

<p>The <var>lambda-list</var> supports destructuring as described in
<a href="Evaluation-and-Compilation.html#Destructuring-Lambda-Lists">Section 3.4.5 (Destructuring Lambda Lists)</a>.
</p>
<span id="Examples_003a-44"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (defun iota (n) (loop for i from 1 to n collect i))       ;helper
 (destructuring-bind ((a &amp;optional (b 'bee)) one two three)
     `((alpha) ,@(iota 3))
   (list a b three two one)) <span class="roman">→</span> (ALPHA BEE 3 2 1)
</pre></div>



<span id="Exceptional-Situations_003a-14"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>If the result of evaluating the <var>expression</var> does not match the 
destructuring pattern, an error of <i>type</i> <code>error</code> should be signaled. 
</p>
<span id="See-Also_003a-55"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#macrolet">macrolet</a>, <a href="Evaluation-and-Compilation.html#defmacro">defmacro</a>
</p>


<hr>
<span id="let_003b-let_002a"></span><div class="header">
<p>
Next: <a href="#progv" accesskey="n" rel="next">progv</a>, Previous: <a href="#destructuring_002dbind" accesskey="p" rel="prev">destructuring-bind</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">let; let*</h4>
<span id="let_002c-let_002a-_0028Special-Operator_0029"></span><h3 class="heading">let, let* (Special Operator)</h3>
<span id="index-let-2"></span>
<span id="index-let"></span>
<span id="index-let_002a-2"></span>
<span id="index-let_002a"></span>
<span id="let"></span>


<span id="Syntax_003a-49"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-let-1">Special Form: <strong>let</strong> <em><tt>(</tt><tt>{</tt>var <span class="roman">|</span> (var [init-form])<tt>}</tt>*<tt>)</tt> <tt>{</tt>declaration<tt>}</tt>* <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl>
<dt id="index-let_002a-1">Special Form: <strong>let*</strong> <em><tt>(</tt><tt>{</tt>var <span class="roman">|</span> (var [init-form])<tt>}</tt>*<tt>)</tt> <tt>{</tt>declaration<tt>}</tt>* <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-39"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>var</var>&mdash;a <i>symbol</i>.
</p>
<p><var>init-form</var>&mdash;a <i>form</i>.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <i>forms</i>.
</p>
<span id="Description_003a-71"></span><h4 class="subsubheading">Description:</h4>

<p><code>let</code> and <code>let*</code>
create new variable <i>bindings</i> and
execute a series of <var>forms</var> that use these <i>bindings</i>.
<code>let</code> performs the <i>bindings</i> in parallel and 
<code>let*</code> does them sequentially.
</p>

<p>The form
</p>
<div class="lisp">
<pre class="lisp"> (let ((<var>var1</var> <var>init-form-1</var>)
       (<var>var2</var> <var>init-form-2</var>)
       ...
       (<var>varm</var> <var>init-form-m</var>))
   <var>declaration1</var>
   <var>declaration2</var>
   ...
   <var>declarationp</var>
   <var>form1</var>
   <var>form2</var>
   ...
   <var>formn</var>)
</pre></div>

<p>first evaluates the expressions <var>init-form-1</var>, <var>init-form-2</var>, and so on,
in that order, saving the resulting values.
Then all of the variables <var>varj</var> are bound to the corresponding
values; each <i>binding</i> is lexical unless
there is a <code>special</code> declaration to the contrary.
The expressions <var>formk</var> are then evaluated
in order; the values of all but the last are discarded
(that is, the body of a <code>let</code> 
is an <i>implicit progn</i>).
</p>
<p><code>let*</code>
is similar to <code>let</code>, but the <i>bindings</i> of variables
are performed sequentially rather than in parallel.  
The expression for the <var>init-form</var> of a 
<var>var</var> can refer to <var>vars</var>
previously bound in the <code>let*</code>.
</p>
<p>The form
</p>
<div class="lisp">
<pre class="lisp"> (let* ((<var>var1</var> <var>init-form-1</var>)
        (<var>var2</var> <var>init-form-2</var>)
        ...
        (<var>varm</var> <var>init-form-m</var>))
   <var>declaration1</var>
   <var>declaration2</var>
   ...
   <var>declarationp</var>
   <var>form1</var>
   <var>form2</var>
   ...
   <var>formn</var>)
</pre></div>

<p>first evaluates the expression <var>init-form-1</var>, then binds the variable
<var>var1</var> to that value; then it evaluates <var>init-form-2</var> and binds 
<var>var2</var>, and so on.
The expressions <var>formj</var> are then evaluated
in order; the values of all but the last are discarded
(that is, the body of <code>let*</code> is an implicit <code>progn</code>).
</p>
<p>For both <code>let</code> and <code>let*</code>,
if there is not an <var>init-form</var> associated with a <var>var</var>,
<var>var</var> is initialized to <code>nil</code>.  
</p>
<p>The special form <code>let</code> 
has the property that the <i>scope</i> 
of the name binding does not include any
initial value form.
For <code>let*</code>, a variable&rsquo;s <i>scope</i> also includes the 
remaining initial value forms for subsequent variable bindings.
</p>
<span id="Examples_003a-45"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (setq a 'top) <span class="roman">→</span> TOP
 (defun dummy-function () a) <span class="roman">→</span> DUMMY-FUNCTION
 (let ((a 'inside) (b a))
    (format nil &quot;~S ~S ~S&quot; a b (dummy-function))) <span class="roman">→</span> &quot;INSIDE TOP TOP&quot; 
 (let* ((a 'inside) (b a))
    (format nil &quot;~S ~S ~S&quot; a b (dummy-function))) <span class="roman">→</span> &quot;INSIDE INSIDE TOP&quot; 
 (let ((a 'inside) (b a))
    (declare (special a))
    (format nil &quot;~S ~S ~S&quot; a b (dummy-function))) <span class="roman">→</span> &quot;INSIDE TOP INSIDE&quot;
</pre></div>


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The code
</p>
<div class="lisp">
<pre class="lisp"> (let (x)
   (declare (integer x))
   (setq x (gcd y z))
   ...)
</pre></div>

<p>is incorrect; although <code>x</code> is indeed set before it is used,
and is set to a value of the declared type <i>integer</i>, nevertheless
<code>x</code> initially takes on the value <code>nil</code>&nbsp;<!-- /@w -->in violation of the type
declaration.
</p>
<span id="See-Also_003a-56"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#progv">progv</a>
</p>


<hr>
<span id="progv"></span><div class="header">
<p>
Next: <a href="#setq" accesskey="n" rel="next">setq</a>, Previous: <a href="#let_003b-let_002a" accesskey="p" rel="prev">let; let*</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">progv</h4>
<span id="progv-_0028Special-Operator_0029"></span><h3 class="heading">progv (Special Operator)</h3>
<span id="index-progv-2"></span>
<span id="index-progv"></span>


<span id="Syntax_003a-50"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-progv-1">Special Form: <strong>progv</strong> <em><var>symbols</var> <var>values</var> <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-40"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>symbols</var>&mdash;a <i>list</i> of <i>symbols</i>; evaluated.
</p>
<p><var>values</var>&mdash;a <i>list</i> of <i>objects</i>; evaluated.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <i>forms</i>.
</p>
<span id="Description_003a-72"></span><h4 class="subsubheading">Description:</h4>

<p><code>progv</code> creates new dynamic variable <i>bindings</i> and
executes each <var>form</var> using those <i>bindings</i>.
Each <var>form</var> is evaluated in  order.
</p>
<p><code>progv</code> allows <i>binding</i> one or more dynamic
variables whose names may be determined at run time.  
Each <var>form</var> is evaluated in order 
with the dynamic variables whose names are in 
<var>symbols</var> bound to corresponding <var>values</var>.
If too few <var>values</var> 
are supplied, the remaining <i>symbols</i> are bound and then
made to have no value. If too many <var>values</var> are
supplied, the excess values are ignored.
The <i>bindings</i> of the dynamic variables are undone on
exit from <code>progv</code>. 
</p>
<span id="Examples_003a-46"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (setq *x* 1) <span class="roman">→</span> 1
 (progv '(*x*) '(2) *x*) <span class="roman">→</span> 2
 *x* <span class="roman">→</span> 1

Assuming *x* is not globally special,

 (let ((*x* 3)) 
    (progv '(*x*) '(4) 
      (list *x* (symbol-value '*x*)))) <span class="roman">→</span> (3 4)
</pre></div>


<span id="See-Also_003a-57"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#let">let</a>, <a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-35"></span><h4 class="subsubheading">Notes:</h4>

<p>Among other things, <code>progv</code> is useful when writing 
interpreters for languages embedded in <span class="roman">Lisp</span>; it provides a handle
on the mechanism for <i>binding</i> <i>dynamic variables</i>.
</p>

<hr>
<span id="setq"></span><div class="header">
<p>
Next: <a href="#psetq" accesskey="n" rel="next">psetq</a>, Previous: <a href="#progv" accesskey="p" rel="prev">progv</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">setq</h4>
<span id="setq-_0028Special-Form_0029"></span><h3 class="heading">setq (Special Form)</h3>
<span id="index-setq-2"></span>
<span id="index-setq"></span>


<span id="Syntax_003a-51"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-setq-1">Special Form: <strong>setq</strong> <em><tt>{</tt><tt>↓</tt>pair<tt>}</tt>* <span class="roman">→</span> result</em></dt>
</dl>

<dl compact="compact">
<dt><var>pair</var>::=</dt>
<dd><p>var form
</p></dd>
</dl>

<span id="Pronunciation_003a-2"></span><h4 class="subsubheading">Pronunciation:</h4>

<p>[ˈsetˌkyü]
</p>
<span id="Arguments-and-Values_003a-41"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>var</var>&mdash;a <i>symbol</i> naming a <i>variable</i> other than a <i>constant variable</i>.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>result</var>&mdash;the <i>primary value</i> of the last <var>form</var>,
or <code>nil</code>&nbsp;<!-- /@w -->if no <var>pairs</var> were supplied.
</p>
<span id="Description_003a-73"></span><h4 class="subsubheading">Description:</h4>

<p>Assigns values to <i>variables</i>.
</p>
<p><code>(setq <i>var1</i> <i>form1</i> <i>var2</i> <i>form2</i> ...)</code>
is the simple variable assignment statement of <span class="roman">Lisp</span>.
First <var>form1</var> is evaluated
and the result is stored in the variable <var>var1</var>, then <var>form2</var>
is evaluated and the result stored in <var>var2</var>, and so forth.
<code>setq</code> may be used for assignment of both lexical
and dynamic variables.
</p>
<p>If any <var>var</var> refers to a <i>binding</i> 
made by <code>symbol-macrolet</code>,
then that <var>var</var> is treated as if <code>setf</code>
(not <code>setq</code>) had been used.
</p>
<span id="Examples_003a-47"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> ;; A simple use of SETQ to establish values for variables.
 (setq a 1 b 2 c 3) <span class="roman">→</span> 3
 a <span class="roman">→</span> 1
 b <span class="roman">→</span> 2
 c <span class="roman">→</span> 3

 ;; Use of SETQ to update values by sequential assignment.
 (setq a (1+ b) b (1+ a) c (+ a b)) <span class="roman">→</span> 7
 a <span class="roman">→</span> 3
 b <span class="roman">→</span> 4
 c <span class="roman">→</span> 7

 ;; This illustrates the use of SETQ on a symbol macro.
 (let ((x (list 10 20 30)))
   (symbol-macrolet ((y (car x)) (z (cadr x)))
     (setq y (1+ z) z (1+ y))
     (list x y z)))
<span class="roman">→</span> ((21 22 30) 21 22)
</pre></div>


<span id="Side-Effects_003a-1"></span><h4 class="subsubheading">Side Effects:</h4>

<p>The <i>primary value</i> of each <var>form</var> is assigned to the corresponding <var>var</var>.
</p>
<span id="See-Also_003a-58"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#psetq">psetq</a>,
<a href="Symbols.html#set">set</a>,
<a href="#setf">setf</a>
</p>

<hr>
<span id="psetq"></span><div class="header">
<p>
Next: <a href="#block" accesskey="n" rel="next">block</a>, Previous: <a href="#setq" accesskey="p" rel="prev">setq</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">psetq</h4>
<span id="psetq-_0028Macro_0029"></span><h3 class="heading">psetq (Macro)</h3>
<span id="index-psetq-2"></span>
<span id="index-psetq"></span>


<span id="Syntax_003a-52"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-psetq-1">Macro: <strong>psetq</strong> <em><tt>{</tt><tt>↓</tt>pair<tt>}</tt>* <span class="roman">→</span> <code>nil</code></em></dt>
</dl>

<dl compact="compact">
<dt><var>pair</var>::=</dt>
<dd><p>var form
</p></dd>
</dl>

<span id="Pronunciation_003a-3"></span><h4 class="subsubheading">Pronunciation:</h4>

<p><code>psetq</code>: [ːpēˈsetˌkyü]
</p>
<span id="Arguments-and-Values_003a-42"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>var</var>&mdash;a <i>symbol</i> naming a <i>variable</i> other than a <i>constant variable</i>.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<span id="Description_003a-74"></span><h4 class="subsubheading">Description:</h4>

<p>Assigns values to <i>variables</i>.
</p>
<p>This is just like <code>setq</code>, except that the assignments 
happen &ldquo;in parallel.&rdquo;  That is, first all of the forms are
evaluated, and only then are the variables set to the resulting values.
In this way, the assignment to one variable does not affect the value
computation of another in the way that would occur with <code>setq</code>&rsquo;s 
sequential assignment.
</p>
<p>If any <var>var</var> refers to a <i>binding</i> 
made by <code>symbol-macrolet</code>,
then that <var>var</var> is treated as if <code>psetf</code> (not <code>psetq</code>)
had been used.
</p>
<span id="Examples_003a-48"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> ;; A simple use of PSETQ to establish values for variables.
 ;; As a matter of style, many programmers would prefer SETQ 
 ;; in a simple situation like this where parallel assignment
 ;; is not needed, but the two have equivalent effect.
 (psetq a 1 b 2 c 3) <span class="roman">→</span> NIL
 a <span class="roman">→</span> 1
 b <span class="roman">→</span> 2
 c <span class="roman">→</span> 3

 ;; Use of PSETQ to update values by parallel assignment.
 ;; The effect here is very different than if SETQ had been used.
 (psetq a (1+ b) b (1+ a) c (+ a b)) <span class="roman">→</span> NIL
 a <span class="roman">→</span> 3
 b <span class="roman">→</span> 2
 c <span class="roman">→</span> 3

 ;; Use of PSETQ on a symbol macro.
 (let ((x (list 10 20 30)))
   (symbol-macrolet ((y (car x)) (z (cadr x)))
     (psetq y (1+ z) z (1+ y))
     (list x y z)))
<span class="roman">→</span> ((21 11 30) 21 11)

 ;; Use of parallel assignment to swap values of A and B.
 (let ((a 1) (b 2))
   (psetq a b  b a)
   (values a b))
<span class="roman">→</span> 2, 1
</pre></div>


<span id="Side-Effects_003a-2"></span><h4 class="subsubheading">Side Effects:</h4>

<p>The values of <var>forms</var> are assigned to <var>vars</var>.
</p>
<span id="See-Also_003a-59"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#psetf">psetf</a>,
<a href="#setq">setq</a>
</p>

<hr>
<span id="block"></span><div class="header">
<p>
Next: <a href="#catch" accesskey="n" rel="next">catch</a>, Previous: <a href="#psetq" accesskey="p" rel="prev">psetq</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">block</h4>
<span id="block-_0028Special-Operator_0029"></span><h3 class="heading">block (Special Operator)</h3>
<span id="index-block-2"></span>
<span id="index-block"></span>


<span id="Syntax_003a-53"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-block-1">Special Form: <strong>block</strong> <em><var>name</var> <var>form</var>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-43"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>symbol</i>.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> of the <i>forms</i> if a <i>normal return</i> occurs,
or else, if an <i>explicit return</i> occurs, the <i>values</i> that were transferred.
</p>
<span id="Description_003a-75"></span><h4 class="subsubheading">Description:</h4>

<p><code>block</code> <i>establishes</i> a <i>block</i> named <var>name</var>
and then evaluates <var>forms</var> as an <i>implicit progn</i>.
</p>
<p>The <i>special operators</i> <code>block</code> and <code>return-from</code> work together to
provide a structured, lexical, non-local exit facility.  At any point lexically
contained within <i>forms</i>, <code>return-from</code> can be used with the
given <var>name</var> to return control and values from the <code>block</code> 
<i>form</i>, except when an intervening <i>block</i> with the same name
has been <i>established</i>, in which case the outer <i>block</i> is 
shadowed by the inner one.
</p>
<p>The <i>block</i> named <i>name</i> has
<i>lexical scope</i> and <i>dynamic extent</i>.  
</p>
<p>Once established, a <i>block</i> may only be exited once, 
whether by <i>normal return</i> or <i>explicit return</i>.
</p>
<span id="Examples_003a-49"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (block empty) <span class="roman">→</span> NIL
 (block whocares (values 1 2) (values 3 4)) <span class="roman">→</span> 3, 4
 (let ((x 1)) 
   (block stop (setq x 2) (return-from stop) (setq x 3))
   x) <span class="roman">→</span> 2
 (block early (return-from early (values 1 2)) (values 3 4)) <span class="roman">→</span> 1, 2
 (block outer (block inner (return-from outer 1)) 2) <span class="roman">→</span> 1
 (block twin (block twin (return-from twin 1)) 2) <span class="roman">→</span> 2
 ;; Contrast behavior of this example with corresponding example of CATCH.
 (block b
   (flet ((b1 () (return-from b 1)))
     (block b (b1) (print 'unreachable))
     2)) <span class="roman">→</span> 1
</pre></div>


<span id="See-Also_003a-60"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#return">return</a>, <a href="#return_002dfrom">return-from</a>, <a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-36"></span><h4 class="subsubheading">Notes:</h4>


<hr>
<span id="catch"></span><div class="header">
<p>
Next: <a href="#go" accesskey="n" rel="next">go</a>, Previous: <a href="#block" accesskey="p" rel="prev">block</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">catch</h4>
<span id="catch-_0028Special-Operator_0029"></span><h3 class="heading">catch (Special Operator)</h3>
<span id="index-catch-2"></span>
<span id="index-catch"></span>


<span id="Syntax_003a-54"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-catch-1">Special Form: <strong>catch</strong> <em><var>tag</var> <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-44"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>tag</var>&mdash;a <i>catch tag</i>; evaluated.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;if the <var>forms</var> exit normally,
the <i>values</i> returned by the <var>forms</var>;
if a throw occurs to the <var>tag</var>,
the <i>values</i> that are thrown.
</p>
<span id="Description_003a-76"></span><h4 class="subsubheading">Description:</h4>

<p><code>catch</code> is used as the destination of a non-local 
control transfer by <code>throw</code>.
<var>Tags</var> are used to find the <code>catch</code>
to which a <code>throw</code> is transferring control.
<code>(catch 'foo <i>form</i>)</code> catches a 
<code>(throw 'foo <i>form</i>)</code> but not a
<code>(throw 'bar <i>form</i>)</code>.
</p>
<p>The order of execution of <code>catch</code> follows:
<span id="index-order-of-evaluation-3"></span>
<span id="index-evaluation-order-3"></span>
</p>

<ol>
<li> <var>Tag</var> is evaluated.
It serves as the name of the
<code>catch</code>.  

</li><li> <var>Forms</var> are then evaluated as an implicit <code>progn</code>,
and the results of the last <var>form</var> are returned unless a 
<code>throw</code> occurs.

</li><li> If a <code>throw</code> occurs 
during the execution of one of the <var>forms</var>, control
is transferred  to the <code>catch</code> <i>form</i> whose <var>tag</var> 
is <code>eq</code> to
the tag argument of the <code>throw</code>
and which is the most recently established <code>catch</code> with that 
<var>tag</var>.
No further evaluation of <var>forms</var> occurs.

</li><li> The <var>tag</var> <i>established</i> 
by <code>catch</code> is <i>disestablished</i>
just before the results are returned.
</li></ol>


<p>If during the execution of one of the <var>forms</var>, a <code>throw</code>
is executed whose tag is <code>eq</code> to the <code>catch</code> tag, 
then the values specified by the <code>throw</code> are
returned as the result of the dynamically most recently established
<code>catch</code> form with that tag.
</p>
<p>The mechanism for <code>catch</code> and <code>throw</code> works even
if <code>throw</code> is not within the lexical scope of <code>catch</code>.
<code>throw</code> must occur within the <i>dynamic extent</i> 
of the <i>evaluation</i> of the body of a <code>catch</code> with a corresponding <var>tag</var>.
</p>
<span id="Examples_003a-50"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (catch 'dummy-tag 1 2 (throw 'dummy-tag 3) 4) <span class="roman">→</span> 3
 (catch 'dummy-tag 1 2 3 4) <span class="roman">→</span> 4
 (defun throw-back (tag) (throw tag t)) <span class="roman">→</span> THROW-BACK
 (catch 'dummy-tag (throw-back 'dummy-tag) 2) <span class="roman">→</span> T

 ;; Contrast behavior of this example with corresponding example of BLOCK.
 (catch 'c
   (flet ((c1 () (throw 'c 1)))
     (catch 'c (c1) (print 'unreachable))
     2)) <span class="roman">→</span> 2
</pre></div>


<span id="Exceptional-Situations_003a-15"></span><h4 class="subsubheading">Exceptional Situations:</h4>
<p>An error of <i>type</i> <code>control-error</code> is signaled
if <code>throw</code> is done
when there is no suitable <code>catch</code> <var>tag</var>. 
</p><span id="See-Also_003a-61"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#throw">throw</a>, <a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-37"></span><h4 class="subsubheading">Notes:</h4>

<p>It is customary for <i>symbols</i> to be used
as <var>tags</var>, but any <i>object</i> is permitted.  
However, numbers should not be
used because the comparison is done using <code>eq</code>.
</p>
<p><code>catch</code> differs from <code>block</code> in that 
<code>catch</code>
tags have dynamic <i>scope</i> while 
<code>block</code> names have <i>lexical scope</i>.
</p>

<hr>
<span id="go"></span><div class="header">
<p>
Next: <a href="#return_002dfrom" accesskey="n" rel="next">return-from</a>, Previous: <a href="#catch" accesskey="p" rel="prev">catch</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">go</h4>
<span id="go-_0028Special-Operator_0029"></span><h3 class="heading">go (Special Operator)</h3>
<span id="index-go-2"></span>
<span id="index-go"></span>


<span id="Syntax_003a-55"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-go-1">Special Form: <strong>go</strong> <em>tag <span class="roman">→</span><span class="roman">|</span></em></dt>
</dl>

<span id="Arguments-and-Values_003a-45"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>tag</var>&mdash;a <i>go tag</i>.
</p>
<span id="Description_003a-77"></span><h4 class="subsubheading">Description:</h4>

<p><code>go</code> transfers control to the point in the body 
of an enclosing <code>tagbody</code> form labeled by a
tag <code>eql</code> to <var>tag</var>.  
If there is no such <var>tag</var>  in the body, the
bodies of lexically containing <code>tagbody</code> <i>forms</i>
(if any) are examined as well.
If several tags are <code>eql</code> 
to <var>tag</var>, control is transferred to
whichever matching <var>tag</var> 
is contained in the innermost <code>tagbody</code> form that
contains the <code>go</code>.
The consequences are undefined
if there is no matching <var>tag</var> lexically visible
to the point of the <code>go</code>.
</p>
<p>The transfer of control initiated by <code>go</code> is performed
as described in <a href="#Transfer-of-Control-to-an-Exit-Point">Section 5.2 (Transfer of Control to an Exit Point)</a>.
</p>
<span id="Examples_003a-51"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (tagbody
   (setq val 2)
   (go lp)
   (incf val 3)
   lp (incf val 4)) <span class="roman">→</span> NIL
 val <span class="roman">→</span> 6 
</pre></div>





<p>The following is in error because there is a normal exit 
of the <code>tagbody</code> before the 
<code>go</code> is executed.
</p>
<div class="lisp">
<pre class="lisp"> (let ((a nil)) 
   (tagbody t (setq a #'(lambda () (go t))))
   (funcall a))
</pre></div>


<p>The following is in error because the <code>tagbody</code> is passed over
before the <code>go</code> <i>form</i> is executed.
</p>
<div class="lisp">
<pre class="lisp"> (funcall (block nil
            (tagbody a (return #'(lambda () (go a))))))
</pre></div>


<span id="See-Also_003a-62"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#tagbody">tagbody</a>
</p>

<hr>
<span id="return_002dfrom"></span><div class="header">
<p>
Next: <a href="#return" accesskey="n" rel="next">return</a>, Previous: <a href="#go" accesskey="p" rel="prev">go</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">return-from</h4>
<span id="return_002dfrom-_0028Special-Operator_0029"></span><h3 class="heading">return-from (Special Operator)</h3>
<span id="index-return_002dfrom-2"></span>
<span id="index-return_002dfrom"></span>


<span id="Syntax_003a-56"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-return_002dfrom-1">Special Form: <strong>return-from</strong> <em><var>name</var> <tt>[</tt><var>result</var><tt>]</tt> <span class="roman">→</span><span class="roman">|</span></em></dt>
</dl>

<span id="Arguments-and-Values_003a-46"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>block tag</i>; not evaluated.
</p>
<p><var>result</var>&mdash;a <i>form</i>; evaluated.
The default is <code>nil</code>.
</p>
<span id="Description_003a-78"></span><h4 class="subsubheading">Description:</h4>

<p>Returns control and <i>multiple values</i><sub>2</sub>
</p>
<p>A <code>block</code> <i>form</i> named <var>name</var> must lexically enclose
the occurrence of <code>return-from</code>;  any <i>values</i> <i>yielded</i>
by the <i>evaluation</i> of <var>result</var> are immediately returned from
the innermost such lexically enclosing <i>block</i>.
</p>
<p>The transfer of control initiated by <code>return-from</code> is performed
as described in <a href="#Transfer-of-Control-to-an-Exit-Point">Section 5.2 (Transfer of Control to an Exit Point)</a>.
</p>
<span id="Examples_003a-52"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (block alpha (return-from alpha) 1) <span class="roman">→</span> NIL
 (block alpha (return-from alpha 1) 2) <span class="roman">→</span> 1
 (block alpha (return-from alpha (values 1 2)) 3) <span class="roman">→</span> 1, 2
 (let ((a 0))
    (dotimes (i 10) (incf a) (when (oddp i) (return)))
    a) <span class="roman">→</span> 2
 (defun temp (x)
    (if x (return-from temp 'dummy))
    44) <span class="roman">→</span> TEMP
 (temp nil) <span class="roman">→</span> 44
 (temp t) <span class="roman">→</span> DUMMY
 (block out
   (flet ((exit (n) (return-from out n)))
     (block out (exit 1)))
   2) <span class="roman">→</span> 1
 (block nil   
   (unwind-protect (return-from nil 1)
     (return-from nil 2)))
<span class="roman">→</span> 2
 (dolist (flag '(nil t))
   (block nil
     (let ((x 5))
       (declare (special x))
       (unwind-protect (return-from nil)
         (print x))))
   (print 'here))
▷ 5
▷ HERE
▷ 5
▷ HERE
<span class="roman">→</span> NIL
 (dolist (flag '(nil t))
   (block nil
     (let ((x 5))
       (declare (special x))
       (unwind-protect
           (if flag (return-from nil))
         (print x))))
   (print 'here))
▷ 5
▷ HERE
▷ 5
▷ HERE
<span class="roman">→</span> NIL
</pre></div>


<p>The following has undefined consequences because the <code>block</code> <i>form</i>
exits normally before the <code>return-from</code> <i>form</i> is attempted.
</p>
<div class="lisp">
<pre class="lisp"> (funcall (block nil #'(lambda () (return-from nil)))) is an error.
</pre></div>



<span id="See-Also_003a-63"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#block">block</a>,
<a href="#return">return</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>

<hr>
<span id="return"></span><div class="header">
<p>
Next: <a href="#tagbody" accesskey="n" rel="next">tagbody</a>, Previous: <a href="#return_002dfrom" accesskey="p" rel="prev">return-from</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">return</h4>
<span id="return-_0028Macro_0029"></span><h3 class="heading">return (Macro)</h3>
<span id="index-return-2"></span>
<span id="index-return"></span>


<span id="Syntax_003a-57"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-return-1">Macro: <strong>return</strong> <em><tt>[</tt><var>result</var><tt>]</tt> <span class="roman">→</span><span class="roman">|</span></em></dt>
</dl>

<span id="Arguments-and-Values_003a-47"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>result</var>&mdash;a <i>form</i>; evaluated.
The default is <code>nil</code>.
</p>
<span id="Description_003a-79"></span><h4 class="subsubheading">Description:</h4>

<p>Returns, as if by <code>return-from</code>, from the <i>block</i> named <code>nil</code>.
</p>
<span id="Examples_003a-53"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (block nil (return) 1) <span class="roman">→</span> NIL
 (block nil (return 1) 2) <span class="roman">→</span> 1
 (block nil (return (values 1 2)) 3) <span class="roman">→</span> 1, 2
 (block nil (block alpha (return 1) 2)) <span class="roman">→</span> 1
 (block alpha (block nil (return 1)) 2) <span class="roman">→</span> 2
 (block nil (block nil (return 1) 2)) <span class="roman">→</span> 1
</pre></div>


<span id="See-Also_003a-64"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#block">block</a>,
<a href="#return_002dfrom">return-from</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-38"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (return) ≡ (return-from nil)
 (return <var>form</var>) ≡ (return-from nil <var>form</var>)
</pre></div>


<p>The <i>implicit blocks</i> <i>established</i> by <i>macros</i> such as <code>do</code>
are often named <code>nil</code>, so that <code>return</code> can be used to exit from
such <i>forms</i>.
</p>

<hr>
<span id="tagbody"></span><div class="header">
<p>
Next: <a href="#throw" accesskey="n" rel="next">throw</a>, Previous: <a href="#return" accesskey="p" rel="prev">return</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">tagbody</h4>
<span id="tagbody-_0028Special-Operator_0029"></span><h3 class="heading">tagbody (Special Operator)</h3>
<span id="index-tagbody-2"></span>
<span id="index-tagbody"></span>


<span id="Syntax_003a-58"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-tagbody-1">Special Form: <strong>tagbody</strong> <em><tt>{</tt><var>tag</var> | <var>statement</var><tt>}</tt>* <span class="roman">→</span> <code>nil</code></em></dt>
</dl>

<span id="Arguments-and-Values_003a-48"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>tag</var>&mdash;a <i>go tag</i>; not evaluated.
</p>
<p><var>statement</var>&mdash;a <i>compound form</i>; evaluated as described below.
</p>
<span id="Description_003a-80"></span><h4 class="subsubheading">Description:</h4>

<p>Executes zero or more <i>statements</i> in a 
<i>lexical environment</i>
that provides for control transfers to labels indicated by the <var>tags</var>.
</p>
<p>The <var>statements</var> in a <code>tagbody</code> are <i>evaluated</i> in order
from left to right, and their <i>values</i> are discarded.  If at any time
there are no remaining <var>statements</var>, <code>tagbody</code> returns <code>nil</code>.
However, if <code>(go <var>tag</var>)</code> is <i>evaluated</i>, control jumps to the
part of the body labeled with the <var>tag</var>.  (Tags are compared with <code>eql</code>.)
</p>
<p>A <var>tag</var> established by <code>tagbody</code> has <i>lexical scope</i>
and has <i>dynamic extent</i>.  Once <code>tagbody</code> has been exited,
it is no longer valid to <code>go</code> to a <var>tag</var> in its body.
It is permissible for <code>go</code> to jump to a <code>tagbody</code> that is 
not the innermost <code>tagbody</code> containing that <code>go</code>;
the <var>tags</var> established by a <code>tagbody</code> only shadow
other <var>tags</var> of like name.
</p>
<p>The determination of which elements of the body are <var>tags</var> 
and which are <var>statements</var> is made prior to any <i>macro expansion</i>
of that element.  If a <var>statement</var> is a <i>macro form</i> and
its <i>macro expansion</i> is an <i>atom</i>, that <i>atom</i> is treated
as a <var>statement</var>, not a <var>tag</var>.
</p>
<span id="Examples_003a-54"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (let (val)
    (tagbody
      (setq val 1)
      (go point-a)
      (incf val 16)
     point-c
      (incf val 04)
      (go point-b)
      (incf val 32)
     point-a
      (incf val 02)
      (go point-c)
      (incf val 64)
     point-b
      (incf val 08))
    val)
<span class="roman">→</span> 15
 (defun f1 (flag)
   (let ((n 1))
     (tagbody 
       (setq n (f2 flag #'(lambda () (go out))))
      out
       (prin1 n))))
<span class="roman">→</span> F1
 (defun f2 (flag escape)
   (if flag (funcall escape) 2))
<span class="roman">→</span> F2
 (f1 nil)
▷ 2
<span class="roman">→</span> NIL
 (f1 t)
▷ 1
<span class="roman">→</span> NIL
</pre></div>


<span id="See-Also_003a-65"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#go">go</a>
</p>
<span id="Notes_003a-39"></span><h4 class="subsubheading">Notes:</h4>

<p>The <i>macros</i> in the next figure&nbsp;<!-- /@w -->have <i>implicit tagbodies</i>.
</p>

<div class="float"><span id="fig5_002e10"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>do</td><td>do-external-symbols</td><td>dotimes</td></tr>
<tr><td>do*</td><td>do-symbols</td><td>prog</td></tr>
<tr><td>do-all-symbols</td><td>dolist</td><td>prog*</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.10: </strong>Macros that have implicit tagbodies.</p></div></div>


<hr>
<span id="throw"></span><div class="header">
<p>
Next: <a href="#unwind_002dprotect" accesskey="n" rel="next">unwind-protect</a>, Previous: <a href="#tagbody" accesskey="p" rel="prev">tagbody</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">throw</h4>
<span id="throw-_0028Special-Operator_0029"></span><h3 class="heading">throw (Special Operator)</h3>
<span id="index-throw-2"></span>
<span id="index-throw"></span>


<span id="Syntax_003a-59"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-throw-1">Special Form: <strong>throw</strong> <em>tag result-form <span class="roman">→</span><span class="roman">|</span></em></dt>
</dl>

<span id="Arguments-and-Values_003a-49"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>tag</var>&mdash;a <i>catch tag</i>; evaluated.
</p>
<p><var>result-form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<span id="Description_003a-81"></span><h4 class="subsubheading">Description:</h4>

<p><code>throw</code> causes a non-local control transfer
to a <code>catch</code> whose tag is <code>eq</code> to <var>tag</var>. 
</p>
<p><var>Tag</var> is evaluated first to produce an <i>object</i>
called the throw tag; then <var>result-form</var> is evaluated,
and its results are saved. If the <var>result-form</var> produces
multiple values, then all the values are saved.
The most recent outstanding <code>catch</code> 
whose <var>tag</var> is <code>eq</code> to the throw tag
is exited; the saved results are returned as the value or 
values of <code>catch</code>.
</p>
<p>The transfer of control initiated by <code>throw</code> is performed
as described in <a href="#Transfer-of-Control-to-an-Exit-Point">Section 5.2 (Transfer of Control to an Exit Point)</a>.
</p>
<span id="Examples_003a-55"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (catch 'result
    (setq i 0 j 0)
    (loop (incf j 3) (incf i)
          (if (= i 3) (throw 'result (values i j))))) <span class="roman">→</span> 3, 9

</pre></div>


<div class="lisp">
<pre class="lisp"> (catch nil 
   (unwind-protect (throw nil 1)
     (throw nil 2))) <span class="roman">→</span> 2
</pre></div>


<p>The consequences of the following are undefined 
because the <code>catch</code> of <code>b</code> 
is passed over by the first <code>throw</code>, 
hence portable programs must assume that 
its <i>dynamic extent</i> is terminated. 
The <i>binding</i> of the <i>catch tag</i> is not yet <i>disestablished</i>
and therefore it is the target of the second <code>throw</code>.
</p>
<div class="lisp">
<pre class="lisp"> (catch 'a
   (catch 'b
     (unwind-protect (throw 'a 1)
       (throw 'b 2))))
</pre></div>


<p>The following prints &ldquo;<code>The inner catch returns :SECOND-THROW</code>&rdquo;
and then returns <code>:outer-catch</code>.
</p>
<div class="lisp">
<pre class="lisp"> (catch 'foo
         (format t &quot;The inner catch returns ~s.~%&quot;
                 (catch 'foo
                     (unwind-protect (throw 'foo :first-throw)
                         (throw 'foo :second-throw))))
         :outer-catch)
▷ The inner catch returns :SECOND-THROW
<span class="roman">→</span> :OUTER-CATCH
</pre></div>




<span id="Exceptional-Situations_003a-16"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>If there is no outstanding <i>catch tag</i> that matches the throw tag,
no unwinding of the stack is performed,
and an error of <i>type</i> <code>control-error</code> is signaled.
When the error is signaled, 
the <i>dynamic environment</i> is that which was
in force at the point of the <code>throw</code>.
</p>
<span id="See-Also_003a-66"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#block">block</a>,
<a href="#catch">catch</a>,
<a href="#return_002dfrom">return-from</a>,
<a href="#unwind_002dprotect">unwind-protect</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-40"></span><h4 class="subsubheading">Notes:</h4>

<p><code>catch</code> and <code>throw</code> are normally used when the <i>exit point</i>
must have <i>dynamic scope</i> (<i>e.g.</i>, the <code>throw</code> is not lexically enclosed
by the <code>catch</code>), while <code>block</code> and <code>return</code> are used 
when <i>lexical scope</i> is sufficient.
</p>

<hr>
<span id="unwind_002dprotect"></span><div class="header">
<p>
Next: <a href="#nil-_0028Constant-Variable_0029" accesskey="n" rel="next">nil (Constant Variable)</a>, Previous: <a href="#throw" accesskey="p" rel="prev">throw</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">unwind-protect</h4>
<span id="unwind_002dprotect-_0028Special-Operator_0029"></span><h3 class="heading">unwind-protect (Special Operator)</h3>
<span id="index-unwind_002dprotect-2"></span>
<span id="index-unwind_002dprotect"></span>


<span id="Syntax_003a-60"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-unwind_002dprotect-1">Special Form: <strong>unwind-protect</strong> <em><var>protected-form</var> <tt>{</tt>cleanup-form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-50"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>protected-form</var>&mdash;a <i>form</i>.
</p>
<p><var>cleanup-form</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> of the <i>protected-form</i>.
</p>
<span id="Description_003a-82"></span><h4 class="subsubheading">Description:</h4>
<p><code>unwind-protect</code> evaluates <var>protected-form</var>
and guarantees that <var>cleanup-forms</var> are executed
before <code>unwind-protect</code> exits,
whether it terminates
normally or is aborted by a control transfer of some kind. 
<code>unwind-protect</code> is intended to be used
to make sure that
certain side effects take place after the evaluation of 
<var>protected-form</var>.
</p>
<p>If a <i>non-local exit</i> occurs during execution of <var>cleanup-forms</var>,
no special action is taken.  The <var>cleanup-forms</var> of 
<code>unwind-protect</code>
are not protected by that <code>unwind-protect</code>.
</p>
<p><code>unwind-protect</code> protects against all attempts to exit 
from <var>protected-form</var>, including
<code>go</code>,
<code>handler-case</code>,
<code>ignore-errors</code>,
<code>restart-case</code>,
<code>return-from</code>,
<code>throw</code>,
and <code>with-simple-restart</code>.
</p>
<p>Undoing of <i>handler</i> and <i>restart</i> <i>bindings</i> during an exit
happens in parallel with the undoing of the bindings of <i>dynamic variables</i>
and <code>catch</code> tags, in the reverse order in which they were established.
The effect of this is that <var>cleanup-form</var> sees the same <i>handler</i>
and <i>restart</i> <i>bindings</i>, as well as <i>dynamic variable</i> <i>bindings</i>
and <code>catch</code> tags, as were visible when the <code>unwind-protect</code> was entered.
</p>
<span id="Examples_003a-56"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (tagbody
   (let ((x 3))
     (unwind-protect
       (if (numberp x) (go out))
       (print x)))
  out
   ...)
</pre></div>

<p>When <code>go</code> is executed, the call to <code>print</code> is executed first,
and then the transfer of control to the tag <code>out</code> is completed.
</p>
<div class="lisp">
<pre class="lisp"> (defun dummy-function (x)
    (setq state 'running)
    (unless (numberp x) (throw 'abort 'not-a-number))
    (setq state (1+ x))) <span class="roman">→</span> DUMMY-FUNCTION
 (catch 'abort (dummy-function 1)) <span class="roman">→</span> 2
 state <span class="roman">→</span> 2
 (catch 'abort (dummy-function 'trash)) <span class="roman">→</span> NOT-A-NUMBER
 state <span class="roman">→</span> RUNNING
 (catch 'abort (unwind-protect (dummy-function 'trash) 
                  (setq state 'aborted))) <span class="roman">→</span> NOT-A-NUMBER
 state <span class="roman">→</span> ABORTED
</pre></div>


<p>The following code
is not correct:
</p>
<div class="lisp">
<pre class="lisp"> (unwind-protect
   (progn (incf *access-count*)
          (perform-access))
   (decf *access-count*))
</pre></div>

<p>If an exit occurs before completion of <code>incf</code>,
the <code>decf</code> <i>form</i> is executed anyway, resulting in an
incorrect value for <code>*access-count*</code>.
The correct way to code this is as follows:
</p>
<div class="lisp">
<pre class="lisp"> (let ((old-count *access-count*))
   (unwind-protect
     (progn (incf *access-count*)
            (perform-access))
     (setq *access-count* old-count)))
</pre></div>



<div class="lisp">
<pre class="lisp">;;; The following returns 2.
 (block nil   
   (unwind-protect (return 1)
     (return 2)))
 
;;; The following has undefined consequences.
 (block a    
   (block b
     (unwind-protect (return-from a 1)
       (return-from b 2))))
 
;;; The following returns 2.
 (catch nil 
   (unwind-protect (throw nil 1)
     (throw nil 2)))
 
;;; The following has undefined consequences because the catch of B is 
;;; passed over by the first THROW, hence portable programs must assume 
;;; its dynamic extent is terminated.  The binding of the catch tag is not
;;; yet disestablished and therefore it is the target of the second throw.
 (catch 'a
   (catch 'b
     (unwind-protect (throw 'a 1)
       (throw 'b 2))))
 
;;; The following prints &quot;The inner catch returns :SECOND-THROW&quot;
;;; and then returns :OUTER-CATCH.
 (catch 'foo
         (format t &quot;The inner catch returns ~s.~%&quot;
                 (catch 'foo
                     (unwind-protect (throw 'foo :first-throw)
                         (throw 'foo :second-throw))))
         :outer-catch)
 
 
;;; The following returns 10. The inner CATCH of A is passed over, but 
;;; because that CATCH is disestablished before the THROW to A is executed,
;;; it isn't seen.
 (catch 'a
   (catch 'b
     (unwind-protect (1+ (catch 'a (throw 'b 1)))
       (throw 'a 10))))
 
 
;;; The following has undefined consequences because the extent of
;;; the (CATCH 'BAR ...) exit ends when the (THROW 'FOO ...)
;;; commences.
 (catch 'foo
   (catch 'bar
       (unwind-protect (throw 'foo 3)
         (throw 'bar 4)
         (print 'xxx))))
 
 
;;; The following returns 4; XXX is not printed.
;;; The (THROW 'FOO ...) has no effect on the scope of the BAR
;;; catch tag or the extent of the (CATCH 'BAR ...) exit.
 (catch 'bar
   (catch 'foo
       (unwind-protect (throw 'foo 3)
         (throw 'bar 4)
         (print 'xxx))))
 
 
;;; The following prints 5.
 (block nil
   (let ((x 5))
     (declare (special x))
     (unwind-protect (return)
       (print x))))          
</pre></div>


<span id="See-Also_003a-67"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#catch">catch</a>,
<a href="#go">go</a>,
<a href="Conditions.html#handler_002dcase">handler-case</a>,
<a href="Conditions.html#restart_002dcase">restart-case</a>,
<a href="#return">return</a>, 
<a href="#return_002dfrom">return-from</a>,
<a href="#throw">throw</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>

<hr>
<span id="nil-_0028Constant-Variable_0029"></span><div class="header">
<p>
Next: <a href="#not-_0028Function_0029" accesskey="n" rel="next">not (Function)</a>, Previous: <a href="#unwind_002dprotect" accesskey="p" rel="prev">unwind-protect</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">nil (Constant Variable)</h4>
<span id="nil-_0028Constant-Variable_0029-1"></span><h3 class="heading">nil (Constant Variable)</h3>
<span id="index-nil-5"></span>
<span id="index-nil-3"></span>


<span id="Constant-Value_003a-3"></span><h4 class="subsubheading">Constant Value:</h4>

<p><code>nil</code>.
</p>
<span id="Description_003a-83"></span><h4 class="subsubheading">Description:</h4>

<p><code>nil</code>&nbsp;<!-- /@w -->represents both <i>boolean</i> (and <i>generalized boolean</i>) <i>false</i>
and the <i>empty list</i>.
</p>
<span id="Examples_003a-57"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> nil <span class="roman">→</span> NIL 
</pre></div>


<span id="See-Also_003a-68"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#t-_0028Constant-Variable_0029">t (Constant Variable)</a>
</p>

<hr>
<span id="not-_0028Function_0029"></span><div class="header">
<p>
Next: <a href="#t-_0028Constant-Variable_0029" accesskey="n" rel="next">t (Constant Variable)</a>, Previous: <a href="#nil-_0028Constant-Variable_0029" accesskey="p" rel="prev">nil (Constant Variable)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">not (Function)</h4>
<span id="not-_0028Function_0029-1"></span><h3 class="heading">not (Function)</h3>
<span id="index-not-4"></span>
<span id="index-not-1"></span>



<span id="Syntax_003a-61"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-not-2">Function: <strong>not</strong> <em>x <span class="roman">→</span> boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-51"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>x</var>&mdash;a <i>generalized boolean</i> (<i>i.e.</i>, any <i>object</i>).
</p>
<p><var>boolean</var>&mdash;a <i>boolean</i>.
</p>
<span id="Description_003a-84"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <code>t</code> if <var>x</var> is <i>false</i>; otherwise, returns <code>nil</code>.
</p>
<span id="Examples_003a-58"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (not nil) <span class="roman">→</span> T
 (not '()) <span class="roman">→</span> T
 (not (integerp 'sss)) <span class="roman">→</span> T
 (not (integerp 1)) <span class="roman">→</span> NIL
 (not 3.7) <span class="roman">→</span> NIL
 (not 'apple) <span class="roman">→</span> NIL
</pre></div>



<span id="See-Also_003a-69"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Conses.html#null-_0028Function_0029">null (Function)</a>
</p>
<span id="Notes_003a-41"></span><h4 class="subsubheading">Notes:</h4>

<p><code>not</code> is intended to be used to invert the &lsquo;truth value&rsquo; of a <i>boolean</i>
(or <i>generalized boolean</i>)
whereas <code>null</code> is intended to be used to test for the <i>empty list</i>.
Operationally, <code>not</code> and <code>null</code> compute the same result;
which to use is a matter of style.
</p>

<hr>
<span id="t-_0028Constant-Variable_0029"></span><div class="header">
<p>
Next: <a href="#eq" accesskey="n" rel="next">eq</a>, Previous: <a href="#not-_0028Function_0029" accesskey="p" rel="prev">not (Function)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">t (Constant Variable)</h4>
<span id="t-_0028Constant-Variable_0029-1"></span><h3 class="heading">t (Constant Variable)</h3>
<span id="index-t-5"></span>
<span id="index-t-1"></span>


<span id="Constant-Value_003a-4"></span><h4 class="subsubheading">Constant Value:</h4>

<p><tt>t</tt>.
</p>
<span id="Description_003a-85"></span><h4 class="subsubheading">Description:</h4>

<p>The <i>boolean</i> representing true, 
and the canonical <i>generalized boolean</i> representing true.
Although any <i>object</i> 
other than <code>nil</code>&nbsp;<!-- /@w -->is considered <i>true</i>,
<code>t</code>&nbsp;<!-- /@w -->is generally used when there is no special reason 
to prefer one such <i>object</i> over another.
</p>
<p>The <i>symbol</i> <code>t</code>&nbsp;<!-- /@w -->is also sometimes used for other purposes as well.
For example,
as the <i>name</i> of a <i>class</i>,
as a <i>designator</i> (<i>e.g.</i>, a <i>stream designator</i>)
or as a special symbol for some syntactic reason 
(<i>e.g.</i>, in <code>case</code> and <code>typecase</code> to label the <var>otherwise-clause</var>).
</p>
<span id="Examples_003a-59"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> t <span class="roman">→</span> T 
 (eq t 't) <span class="roman">→</span> <i>true</i>
 (find-class 't) <span class="roman">→</span> #&lt;CLASS T 610703333&gt;
 (case 'a (a 1) (t 2)) <span class="roman">→</span> 1
 (case 'b (a 1) (t 2)) <span class="roman">→</span> 2
 (prin1 'hello t)
▷ HELLO
<span class="roman">→</span> HELLO
</pre></div>


<span id="See-Also_003a-70"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#nil-_0028Constant-Variable_0029">nil (Constant Variable)</a>
</p>

<hr>
<span id="eq"></span><div class="header">
<p>
Next: <a href="#eql-_0028Function_0029" accesskey="n" rel="next">eql (Function)</a>, Previous: <a href="#t-_0028Constant-Variable_0029" accesskey="p" rel="prev">t (Constant Variable)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">eq</h4>
<span id="eq-_0028Function_0029"></span><h3 class="heading">eq (Function)</h3>
<span id="index-eq-2"></span>
<span id="index-eq"></span>


<span id="Syntax_003a-62"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-eq-1">Function: <strong>eq</strong> <em>x y <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-52"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>x</var>&mdash;an <i>object</i>.
</p>
<p><var>y</var>&mdash;an <i>object</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-86"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <i>true</i> if its <i>arguments</i> are the same, identical <i>object</i>;
otherwise, returns <i>false</i>.
</p>
<span id="Examples_003a-60"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (eq 'a 'b) <span class="roman">→</span> <i>false</i>
 (eq 'a 'a) <span class="roman">→</span> <i>true</i>
 (eq 3 3)
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (eq 3 3.0) <span class="roman">→</span> <i>false</i>
 (eq 3.0 3.0)
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (eq #c(3 -4) #c(3 -4))
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (eq #c(3 -4.0) #c(3 -4)) <span class="roman">→</span> <i>false</i>
 (eq (cons 'a 'b) (cons 'a 'c)) <span class="roman">→</span> <i>false</i>
 (eq (cons 'a 'b) (cons 'a 'b)) <span class="roman">→</span> <i>false</i>
 (eq '(a . b) '(a . b))
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (progn (setq x (cons 'a 'b)) (eq x x)) <span class="roman">→</span> <i>true</i>
 (progn (setq x '(a . b)) (eq x x)) <span class="roman">→</span> <i>true</i>
 (eq #\A #\A)
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (let ((x &quot;Foo&quot;)) (eq x x)) <span class="roman">→</span> <i>true</i>
 (eq &quot;Foo&quot; &quot;Foo&quot;)
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (eq &quot;Foo&quot; (copy-seq &quot;Foo&quot;)) <span class="roman">→</span> <i>false</i>
 (eq &quot;FOO&quot; &quot;foo&quot;) <span class="roman">→</span> <i>false</i>
 (eq &quot;string-seq&quot; (copy-seq &quot;string-seq&quot;)) <span class="roman">→</span> <i>false</i>
 (let ((x 5)) (eq x x))
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
</pre></div>


<span id="See-Also_003a-71"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#eql-_0028Function_0029">eql (Function)</a>,
<a href="#equal">equal</a>,
<a href="#equalp">equalp</a>,
<a href="Numbers.html#g_t_003d">=</a>,
<a href="Evaluation-and-Compilation.html#Compilation">Section 3.2 (Compilation)</a>
</p>
<span id="Notes_003a-42"></span><h4 class="subsubheading">Notes:</h4>
<p><i>Objects</i> that appear the same when printed are not necessarily
<code>eq</code> to each other.  <i>Symbols</i> that print the same 
usually are <code>eq</code> to each other because of the use of the
<code>intern</code> function.  However, <i>numbers</i> with the 
same value need not be <code>eq</code>, and two similar
<i>lists</i> are usually not <i>identical</i>.
</p>
<p>An implementation is permitted to make &ldquo;copies&rdquo; of 
<i>characters</i> and <i>numbers</i> at any time.  
The effect is that <span class="roman">Common Lisp</span>&nbsp;<!-- /@w -->makes no guarantee that <code>eq</code> 
is true even when both its arguments are &ldquo;the same thing&rdquo; if 
that thing is a <i>character</i> or <i>number</i>.
</p>
<p>Most <span class="roman">Common Lisp</span>&nbsp;<!-- /@w --><i>operators</i> use <code>eql</code> rather than
<code>eq</code> to compare objects, or else they default to <code>eql</code>
and only use <code>eq</code> if specifically requested to do so.
However, the following <i>operators</i> are defined to use <code>eq</code>
rather than <code>eql</code> in a way that cannot be overridden by the
<i>code</i> which employs them:
</p>

<div class="float"><span id="fig5_002e11"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>catch</td><td>getf</td><td>throw</td></tr>
<tr><td>get</td><td>remf</td><td></td></tr>
<tr><td>get-properties</td><td>remprop</td><td></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.11: </strong>Operators that always prefer EQ over EQL</p></div></div>


<hr>
<span id="eql-_0028Function_0029"></span><div class="header">
<p>
Next: <a href="#equal" accesskey="n" rel="next">equal</a>, Previous: <a href="#eq" accesskey="p" rel="prev">eq</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">eql (Function)</h4>
<span id="eql-_0028Function_0029-1"></span><h3 class="heading">eql (Function)</h3>
<span id="index-eql-4"></span>
<span id="index-eql-1"></span>


<span id="Syntax_003a-63"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-eql-2">Function: <strong>eql</strong> <em>x y <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-53"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>x</var>&mdash;an <i>object</i>.
</p>
<p><var>y</var>&mdash;an <i>object</i>. 
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-87"></span><h4 class="subsubheading">Description:</h4>

<p>The value of <code>eql</code> is <i>true</i> of two objects, <var>x</var> and
<var>y</var>, in the folowing cases:
</p>
<ol>
<li> If <var>x</var> and <var>y</var> are <code>eq</code>.
</li><li> If <var>x</var> and <var>y</var> are both <i>numbers</i> 
of the same <i>type</i> and the same value.
</li><li> If they are both <i>characters</i> that represent the 
same character.
</li></ol>


<p>Otherwise the value of <code>eql</code> is <i>false</i>.
</p>
<p>If an implementation supports positive and negative zeros as <i>distinct</i> values,
then <code>(eql 0.0 -0.0)</code> returns <i>false</i>.
Otherwise, when the syntax <code>-0.0</code> is read it is interpreted as the value <code>0.0</code>,
and so <code>(eql 0.0 -0.0)</code> returns <i>true</i>.  
</p>
<span id="Examples_003a-61"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (eql 'a 'b) <span class="roman">→</span> <i>false</i>
 (eql 'a 'a) <span class="roman">→</span> <i>true</i>
 (eql 3 3) <span class="roman">→</span> <i>true</i>
 (eql 3 3.0) <span class="roman">→</span> <i>false</i>
 (eql 3.0 3.0) <span class="roman">→</span> <i>true</i>
 (eql #c(3 -4) #c(3 -4)) <span class="roman">→</span> <i>true</i>
 (eql #c(3 -4.0) #c(3 -4)) <span class="roman">→</span> <i>false</i>
 (eql (cons 'a 'b) (cons 'a 'c)) <span class="roman">→</span> <i>false</i>
 (eql (cons 'a 'b) (cons 'a 'b)) <span class="roman">→</span> <i>false</i>
 (eql '(a . b) '(a . b))
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (progn (setq x (cons 'a 'b)) (eql x x)) <span class="roman">→</span> <i>true</i>
 (progn (setq x '(a . b)) (eql x x)) <span class="roman">→</span> <i>true</i>
 (eql #\A #\A) <span class="roman">→</span> <i>true</i>
 (eql &quot;Foo&quot; &quot;Foo&quot;)
<span class="roman">→</span> <i>true</i>
or<span class="roman">→</span> <i>false</i>
 (eql &quot;Foo&quot; (copy-seq &quot;Foo&quot;)) <span class="roman">→</span> <i>false</i>
 (eql &quot;FOO&quot; &quot;foo&quot;) <span class="roman">→</span> <i>false</i>
</pre></div>


<p>Normally <code>(eql 1.0s0 1.0d0)</code> is false, under the assumption
that <code>1.0s0</code> and <code>1.0d0</code> are of distinct data types.
However, implementations that do not provide four distinct floating-point
formats are permitted to &ldquo;collapse&rdquo; the four formats into some
smaller number of them; in such an implementation <code>(eql 1.0s0 1.0d0)</code>
might be true.  
</p>
<span id="See-Also_003a-72"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#eq">eq</a>,
<a href="#equal">equal</a>,
<a href="#equalp">equalp</a>,
<a href="Numbers.html#g_t_003d">=</a>,
<a href="Characters.html#char_003d">char=</a>
</p>
<span id="Notes_003a-43"></span><h4 class="subsubheading">Notes:</h4>

<p><code>eql</code> is the same as <code>eq</code>, except that if the
arguments are <i>characters</i> or <i>numbers</i> 
of the same type then their
values are compared.  Thus <code>eql</code> tells whether two <i>objects</i>
are conceptually the same, whereas <code>eq</code> tells whether two
<i>objects</i> are implementationally identical.  It is for this reason
that <code>eql</code>, not <code>eq</code>, is the default comparison predicate
for <i>operators</i> that take <i>sequences</i>
as arguments.
</p>
<p><code>eql</code> may not be true of two <i>floats</i>
even when they represent the same
value.  <code>=</code> is used to compare
mathematical values.
</p>
<p>Two <i>complex</i> numbers are considered to be <code>eql</code>
if their real parts are <code>eql</code> 
and their imaginary parts are <code>eql</code>.
For example, <code>(eql #C(4 5) #C(4 5))</code> is <i>true</i> and
<code>(eql #C(4 5) #C(4.0 5.0))</code> is <i>false</i>.
Note that while <code>(eql #C(5.0 0.0) 5.0)</code> is <i>false</i>,
<code>(eql #C(5 0) 5)</code> is <i>true</i>.
In the case of <code>(eql #C(5.0 0.0) 5.0)</code> the
two arguments are of different types,
and so cannot satisfy <code>eql</code>.
In the case of <code>(eql #C(5 0) 5)</code>, 
<code>#C(5 0)</code> is not a <i>complex</i> number, but
is automatically reduced 
to the <i>integer</i> <code>5</code>.
</p>

<hr>
<span id="equal"></span><div class="header">
<p>
Next: <a href="#equalp" accesskey="n" rel="next">equalp</a>, Previous: <a href="#eql-_0028Function_0029" accesskey="p" rel="prev">eql (Function)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">equal</h4>
<span id="equal-_0028Function_0029"></span><h3 class="heading">equal (Function)</h3>
<span id="index-equal-2"></span>
<span id="index-equal"></span>


<span id="Syntax_003a-64"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-equal-1">Function: <strong>equal</strong> <em>x y <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-54"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>x</var>&mdash;an <i>object</i>.
</p>
<p><var>y</var>&mdash;an <i>object</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-88"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <i>true</i> if <var>x</var> and <var>y</var> are structurally similar
(isomorphic) <i>objects</i>.  <i>Objects</i> are treated as follows by
<code>equal</code>.
</p>

<dl compact="compact">
<dt><i>Symbols</i>, <i>Numbers</i>, and <i>Characters</i></dt>
<dd>

<p><code>equal</code> is <i>true</i> of two <i>objects</i> 
if they are <i>symbols</i> that are <code>eq</code>,
if they are <i>numbers</i> that are <code>eql</code>, or
if they are <i>characters</i> that are <code>eql</code>.
</p>
</dd>
<dt><i>Conses</i></dt>
<dd>

<p>For <i>conses</i>, <code>equal</code> is defined recursively as
the two <i>cars</i> being <code>equal</code> 
and the two <i>cdrs</i> being <code>equal</code>.
</p>
</dd>
<dt><i>Arrays</i></dt>
<dd>

<p>Two <i>arrays</i> are <code>equal</code> only if they are <code>eq</code>,
with one exception:
<i>strings</i> and <i>bit vectors</i> are compared element-by-element (using <code>eql</code>).
If either <var>x</var> or <var>y</var> has a <i>fill pointer</i>, the 
<i>fill pointer</i> limits
the number of elements examined by <code>equal</code>.
Uppercase and lowercase letters in <i>strings</i> are considered by
<code>equal</code> to be different.  
</p>
</dd>
<dt><i>Pathnames</i></dt>
<dd>

<p>Two <i>pathnames</i> are <code>equal</code> if and only if
all the corresponding components
(host, device, and so on) are 
equivalent.  Whether or not
uppercase and lowercase letters are considered equivalent
in <i>strings</i> appearing in components is <i>implementation-dependent</i>.
<i>pathnames</i>
that are <code>equal</code> should be functionally equivalent.
</p>
</dd>
<dt><b>Other (Structures, hash-tables, instances, &hellip;)</b></dt>
<dd>

<p>Two other <i>objects</i> are <code>equal</code> only if they are <code>eq</code>.
</p>
</dd>
</dl>


<p><code>equal</code> does not descend any <i>objects</i> other than the
ones explicitly specified above.
The next figure&nbsp;<!-- /@w -->summarizes the information given in the previous list.
In addition, the figure specifies the priority of the behavior of <code>equal</code>,
with upper
entries taking priority over lower ones.
</p>

<div class="float"><span id="fig5_002e12"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<thead><tr><th>Type</th><th>Behavior</th></tr></thead>
<tr><td><i>number</i></td><td>uses <code>eql</code></td></tr>
<tr><td><i>character</i></td><td>uses <code>eql</code></td></tr>
<tr><td><i>cons</i></td><td>descends</td></tr>
<tr><td><i>bit vector</i></td><td>descends</td></tr>
<tr><td><i>string</i></td><td>descends</td></tr>
<tr><td><i>pathname</i></td><td>&ldquo;functionally equivalent&rdquo;</td></tr>
<tr><td><i>structure</i></td><td>uses <code>eq</code></td></tr>
<tr><td>Other <i>array</i></td><td>uses <code>eq</code></td></tr>
<tr><td><i>hash table</i></td><td>uses <code>eq</code></td></tr>
<tr><td>Other <i>object</i></td><td>uses <code>eq</code></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.12: </strong>Summary and priorities of behavior of <code>equal</code></p></div></div>

<p>Any two <i>objects</i> that are <code>eql</code> are also <code>equal</code>. 
</p>
<p><code>equal</code> may fail to terminate if <var>x</var> or <var>y</var> is circular.
</p>
<span id="Examples_003a-62"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (equal 'a 'b) <span class="roman">→</span> <i>false</i>
 (equal 'a 'a) <span class="roman">→</span> <i>true</i>
 (equal 3 3) <span class="roman">→</span> <i>true</i>
 (equal 3 3.0) <span class="roman">→</span> <i>false</i>
 (equal 3.0 3.0) <span class="roman">→</span> <i>true</i>
 (equal #c(3 -4) #c(3 -4)) <span class="roman">→</span> <i>true</i>
 (equal #c(3 -4.0) #c(3 -4)) <span class="roman">→</span> <i>false</i>
 (equal (cons 'a 'b) (cons 'a 'c)) <span class="roman">→</span> <i>false</i>
 (equal (cons 'a 'b) (cons 'a 'b)) <span class="roman">→</span> <i>true</i>
 (equal #\A #\A) <span class="roman">→</span> <i>true</i>
 (equal #\A #\a) <span class="roman">→</span> <i>false</i>
 (equal &quot;Foo&quot; &quot;Foo&quot;) <span class="roman">→</span> <i>true</i>
 (equal &quot;Foo&quot; (copy-seq &quot;Foo&quot;)) <span class="roman">→</span> <i>true</i>
 (equal &quot;FOO&quot; &quot;foo&quot;) <span class="roman">→</span> <i>false</i>
 (equal &quot;This-string&quot; &quot;This-string&quot;) <span class="roman">→</span> <i>true</i>
 (equal &quot;This-string&quot; &quot;this-string&quot;) <span class="roman">→</span> <i>false</i>
</pre></div>


<span id="See-Also_003a-73"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#eq">eq</a>, <a href="#eql-_0028Function_0029">eql (Function)</a>, <a href="#equalp">equalp</a>, <a href="Numbers.html#g_t_003d">=</a>, 
<a href="Strings.html#string_003d">string=</a>, <a href="Strings.html#string_002dequal">string-equal</a>, <a href="Characters.html#char_003d">char=</a>, 
<a href="Characters.html#char_002dequal">char-equal</a>, <a href="Conses.html#tree_002dequal">tree-equal</a>
</p>
<span id="Notes_003a-44"></span><h4 class="subsubheading">Notes:</h4>

<p><i>Object</i> equality is not a concept for which there is a uniquely
determined correct algorithm. The appropriateness of an equality
predicate can be judged only in the context of the needs of some
particular program. Although these functions take any type of
argument and their names sound very generic, 
<code>equal</code> and <code>equalp</code> are
not appropriate for every application. 
</p>
<p>A rough rule of thumb is that two <i>objects</i> are <code>equal</code> 
if and only if their printed representations are the same.
</p>

<hr>
<span id="equalp"></span><div class="header">
<p>
Next: <a href="#identity" accesskey="n" rel="next">identity</a>, Previous: <a href="#equal" accesskey="p" rel="prev">equal</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">equalp</h4>
<span id="equalp-_0028Function_0029"></span><h3 class="heading">equalp (Function)</h3>
<span id="index-equalp-2"></span>
<span id="index-equalp"></span>


<span id="Syntax_003a-65"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-equalp-1">Function: <strong>equalp</strong> <em>x y <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-55"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>x</var>&mdash;an <i>object</i>.
</p>
<p><var>y</var>&mdash;an <i>object</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>.
</p>
<span id="Description_003a-89"></span><h4 class="subsubheading">Description:</h4>

<p>Returns <i>true</i> if <var>x</var> and <var>y</var> are <code>equal</code>,
or if they have components that are of the same <i>type</i> as each other
and if those components are <code>equalp</code>;
specifically, <code>equalp</code> returns <i>true</i> in the following cases:
</p>
<dl compact="compact">
<dt><i>Characters</i></dt>
<dd>

<p>If two <i>characters</i> are <code>char-equal</code>.
</p>
</dd>
<dt><i>Numbers</i></dt>
<dd>

<p>If two <i>numbers</i> are the <i>same</i> under <code>=</code>. 
</p>
</dd>
<dt><i>Conses</i></dt>
<dd>

<p>If the two <i>cars</i> in the <i>conses</i> are <code>equalp</code> 
and the two <i>cdrs</i> in the <i>conses</i> are <code>equalp</code>.
</p>
</dd>
<dt><i>Arrays</i></dt>
<dd>

<p>If two <i>arrays</i> have the same
number of dimensions, the dimensions match,
and the corresponding
<i>active elements</i> 
are <code>equalp</code>.
The <i>types</i> for which the <i>arrays</i> are <i>specialized</i> need not match; 
for example, a <i>string</i> and a general <i>array</i> that happens to contain the same 
<i>characters</i> are <code>equalp</code>.
Because <code>equalp</code> performs <i>element</i>-by-<i>element</i> comparisons
of <i>strings</i> and ignores the <i>case</i> of <i>characters</i>,
<i>case</i> distinctions are ignored when <code>equalp</code> compares <i>strings</i>.
</p>
</dd>
<dt><i>Structures</i></dt>
<dd>

<p>If two <i>structures</i> S<sub>1</sub>
and the value of each <i>slot</i> in S<sub>1</sub>
as the value of the corresponding <i>slot</i> in S<sub>2</sub>
</p>
</dd>
<dt><i>Hash Tables</i></dt>
<dd>

<p><code>equalp</code> descends <i>hash-tables</i> by first comparing the count of entries
and the <tt>:test</tt> function; if those are the same, it compares the
keys of the tables using the <tt>:test</tt> function and then the values
of the matching keys using <code>equalp</code> recursively.
</p></dd>
</dl>


<p><code>equalp</code> does not descend any <i>objects</i>
other than the ones explicitly specified above.
The next figure&nbsp;<!-- /@w -->summarizes the information given in the previous list.
In addition, the figure specifies the priority of the behavior of <code>equalp</code>,
with upper
entries taking priority over lower ones.
</p>

<div class="float"><span id="fig5_002e13"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<thead><tr><th>Type</th><th>Behavior</th></tr></thead>
<tr><td><i>number</i></td><td>uses <code>=</code></td></tr>
<tr><td><i>character</i></td><td>uses <code>char-equal</code></td></tr>
<tr><td><i>cons</i></td><td>descends</td></tr>
<tr><td><i>bit vector</i></td><td>descends</td></tr>
<tr><td><i>string</i></td><td>descends</td></tr>
<tr><td><i>pathname</i></td><td>same as <code>equal</code></td></tr>
<tr><td><i>structure</i></td><td>descends, as described above</td></tr>
<tr><td>Other <i>array</i></td><td>descends</td></tr>
<tr><td><i>hash table</i></td><td>descends, as described above</td></tr>
<tr><td>Other <i>object</i></td><td>uses <code>eq</code></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 5.13: </strong>Summary and priorities of behavior of <code>equalp</code></p></div></div>

<span id="Examples_003a-63"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (equalp 'a 'b) <span class="roman">→</span> <i>false</i>
 (equalp 'a 'a) <span class="roman">→</span> <i>true</i>
 (equalp 3 3) <span class="roman">→</span> <i>true</i>
 (equalp 3 3.0) <span class="roman">→</span> <i>true</i>
 (equalp 3.0 3.0) <span class="roman">→</span> <i>true</i>
 (equalp #c(3 -4) #c(3 -4)) <span class="roman">→</span> <i>true</i>
 (equalp #c(3 -4.0) #c(3 -4)) <span class="roman">→</span> <i>true</i>
 (equalp (cons 'a 'b) (cons 'a 'c)) <span class="roman">→</span> <i>false</i>
 (equalp (cons 'a 'b) (cons 'a 'b)) <span class="roman">→</span> <i>true</i>
 (equalp #\A #\A) <span class="roman">→</span> <i>true</i>
 (equalp #\A #\a) <span class="roman">→</span> <i>true</i>
 (equalp &quot;Foo&quot; &quot;Foo&quot;) <span class="roman">→</span> <i>true</i>
 (equalp &quot;Foo&quot; (copy-seq &quot;Foo&quot;)) <span class="roman">→</span> <i>true</i>
 (equalp &quot;FOO&quot; &quot;foo&quot;) <span class="roman">→</span> <i>true</i>
</pre></div>

<div class="lisp">
<pre class="lisp"> (setq array1 (make-array 6 :element-type 'integer
                            :initial-contents '(1 1 1 3 5 7))) 
<span class="roman">→</span> #(1 1 1 3 5 7)
 (setq array2 (make-array 8 :element-type 'integer
                            :initial-contents '(1 1 1 3 5 7 2 6)
                            :fill-pointer 6))
<span class="roman">→</span> #(1 1 1 3 5 7)
 (equalp array1 array2) <span class="roman">→</span> <i>true</i>
 (setq vector1 (vector 1 1 1 3 5 7)) <span class="roman">→</span> #(1 1 1 3 5 7)
 (equalp array1 vector1) <span class="roman">→</span> <i>true</i> 
</pre></div>


<span id="See-Also_003a-74"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#eq">eq</a>, <a href="#eql-_0028Function_0029">eql (Function)</a>, <a href="#equal">equal</a>, <a href="Numbers.html#g_t_003d">=</a>, 
<a href="Strings.html#string_003d">string=</a>, <a href="Strings.html#string_002dequal">string-equal</a>, <a href="Characters.html#char_003d">char=</a>, 
<a href="Characters.html#char_002dequal">char-equal</a>
</p>
<span id="Notes_003a-45"></span><h4 class="subsubheading">Notes:</h4>

<p><i>Object</i> equality is not a concept for which there is a uniquely
determined correct algorithm. The appropriateness of an equality
predicate can be judged only in the context of the needs of some
particular program. Although these functions take any type of
argument and their names sound very generic, 
<code>equal</code> and <code>equalp</code> are
not appropriate for every application. 
</p>

<hr>
<span id="identity"></span><div class="header">
<p>
Next: <a href="#complement" accesskey="n" rel="next">complement</a>, Previous: <a href="#equalp" accesskey="p" rel="prev">equalp</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">identity</h4>
<span id="identity-_0028Function_0029"></span><h3 class="heading">identity (Function)</h3>
<span id="index-identity-2"></span>
<span id="index-identity"></span>


<span id="Syntax_003a-66"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-identity-1">Function: <strong>identity</strong> <em>object <span class="roman">→</span> object</em></dt>
</dl>

<span id="Arguments-and-Values_003a-56"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>object</var>&mdash;an <i>object</i>.
</p>
<span id="Description_003a-90"></span><h4 class="subsubheading">Description:</h4>

<p>Returns its argument <var>object</var>.
</p>
<span id="Examples_003a-64"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (identity 101) <span class="roman">→</span> 101
 (mapcan #'identity (list (list 1 2 3) '(4 5 6))) <span class="roman">→</span> (1 2 3 4 5 6)
</pre></div>


<span id="Notes_003a-46"></span><h4 class="subsubheading">Notes:</h4>

<p><code>identity</code> is intended for use with functions that require
a <i>function</i> as an argument.
</p>
<p><code>(eql x (identity x))</code> returns <i>true</i> for all possible values of <var>x</var>,
but <code>(eq x (identity x))</code> might return <i>false</i> when <var>x</var> is a <i>number</i>
or <i>character</i>.
</p>
<p><code>identity</code> could be defined by
</p>
<div class="lisp">
<pre class="lisp">(defun identity (x) x)
</pre></div>



<hr>
<span id="complement"></span><div class="header">
<p>
Next: <a href="#constantly" accesskey="n" rel="next">constantly</a>, Previous: <a href="#identity" accesskey="p" rel="prev">identity</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">complement</h4>
<span id="complement-_0028Function_0029"></span><h3 class="heading">complement (Function)</h3>
<span id="index-complement-2"></span>
<span id="index-complement"></span>



<span id="Syntax_003a-67"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-complement-1">Function: <strong>complement</strong> <em>function <span class="roman">→</span> complement-function</em></dt>
</dl>

<span id="Arguments-and-Values_003a-57"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function</var>&mdash;a <i>function</i>.
</p>
<p><var>complement-function</var>&mdash;a <i>function</i>.
</p>
<span id="Description_003a-91"></span><h4 class="subsubheading">Description:</h4>

<p>Returns a <i>function</i> that
takes the same <i>arguments</i> as <var>function</var>,
and has the same side-effect behavior as <var>function</var>,
but returns only a single value:
a <i>generalized boolean</i> with the opposite truth value of that
which would be returned as the <i>primary value</i> of <var>function</var>.
That is, when the <var>function</var> would have returned
<i>true</i> as its <i>primary value</i>
the <var>complement-function</var> returns <i>false</i>,
and when the <var>function</var> would have returned
<i>false</i> as its <i>primary value</i>
the <var>complement-function</var> returns <i>true</i>.
</p>
<span id="Examples_003a-65"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (funcall (complement #'zerop) 1) <span class="roman">→</span> <i>true</i>
 (funcall (complement #'characterp) #\A) <span class="roman">→</span> <i>false</i>
 (funcall (complement #'member) 'a '(a b c)) <span class="roman">→</span> <i>false</i>
 (funcall (complement #'member) 'd '(a b c)) <span class="roman">→</span> <i>true</i>
</pre></div>


<span id="See-Also_003a-75"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#not-_0028Function_0029">not (Function)</a>
</p>
<span id="Notes_003a-47"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (complement <i>x</i>) ≡ #'(lambda (&amp;rest arguments) (not (apply <i>x</i> arguments)))
</pre></div>


<p>In <span class="roman">Common Lisp</span>, functions with names like &ldquo;<code><i>xxx</i>-if-not</code>&rdquo;
are related to functions with names like &ldquo;<code><i>&rdquo; </i>
in that

</code></p><div class="lisp">
<pre class="lisp">(<i>xxx</i>-if-not <i>f</i> . <i>arguments</i>) ≡ (<i>xxx</i>-if (complement <i>f</i>) . <i>arguments</i>)
</pre></div>


<p>For example,
</p>
<div class="lisp">
<pre class="lisp"> (find-if-not #'zerop '(0 0 3)) ≡
 (find-if (complement #'zerop) '(0 0 3)) <span class="roman">→</span> 3
</pre></div>


<p>Note that since the &ldquo;<code><i>xxx</i>-if-not</code>&rdquo; <i>functions</i>
and the <tt>:test-not</tt> arguments have been deprecated,
uses of &ldquo;<code><i>xxx</i>-if</code>&rdquo; <i>functions</i> or 
<tt>:test</tt> arguments with <code>complement</code> are preferred.
</p>

<hr>
<span id="constantly"></span><div class="header">
<p>
Next: <a href="#every_003b-some_003b-notevery_003b-notany" accesskey="n" rel="next">every; some; notevery; notany</a>, Previous: <a href="#complement" accesskey="p" rel="prev">complement</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">constantly</h4>
<span id="constantly-_0028Function_0029"></span><h3 class="heading">constantly (Function)</h3>
<span id="index-constantly-2"></span>
<span id="index-constantly"></span>



<span id="Syntax_003a-68"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-constantly-1">Function: <strong>constantly</strong> <em>value <span class="roman">→</span> function</em></dt>
</dl>

<span id="Arguments-and-Values_003a-58"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>value</var>&mdash;an <i>object</i>.
</p>
<p><var>function</var>&mdash;a <i>function</i>.
</p>
<span id="Description_003a-92"></span><h4 class="subsubheading">Description:</h4>

<p><code>constantly</code> returns a <i>function</i> that accepts any number of
arguments, that has no side-effects, and that always returns <var>value</var>.
</p>
<span id="Examples_003a-66"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (mapcar (constantly 3) '(a b c d)) <span class="roman">→</span> (3 3 3 3)
 (defmacro with-vars (vars &amp;body forms)
   `((lambda ,vars ,@forms) ,@(mapcar (constantly nil) vars)))
<span class="roman">→</span> WITH-VARS
 (macroexpand '(with-vars (a b) (setq a 3 b (* a a)) (list a b)))
<span class="roman">→</span> ((LAMBDA (A B) (SETQ A 3 B (* A A)) (LIST A B)) NIL NIL), <i>true</i>
</pre></div>


<span id="See-Also_003a-76"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#identity">identity</a>
</p>
<span id="Notes_003a-48"></span><h4 class="subsubheading">Notes:</h4>

<p><code>constantly</code> could be defined by:
</p>
<div class="lisp">
<pre class="lisp"> (defun constantly (object)
   #'(lambda (&amp;rest arguments) object))
</pre></div>




<hr>
<span id="every_003b-some_003b-notevery_003b-notany"></span><div class="header">
<p>
Next: <a href="#and-_0028Macro_0029" accesskey="n" rel="next">and (Macro)</a>, Previous: <a href="#constantly" accesskey="p" rel="prev">constantly</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">every; some; notevery; notany</h4>
<span id="every_002c-some_002c-notevery_002c-notany-_0028Function_0029"></span><h3 class="heading">every, some, notevery, notany (Function)</h3>
<span id="index-every-2"></span>
<span id="index-every"></span>
<span id="index-some-2"></span>
<span id="index-some"></span>
<span id="index-notevery-2"></span>
<span id="index-notevery"></span>
<span id="index-notany-2"></span>
<span id="index-notany"></span>
<span id="every"></span><span id="some"></span>

<span id="Syntax_003a-69"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-every-1">Function: <strong>every</strong> <em>predicate <tt>&amp;rest</tt> sequences+ <span class="roman">→</span> generalized-boolean</em></dt>
</dl>
<dl>
<dt id="index-some-1">Function: <strong>some</strong> <em>predicate <tt>&amp;rest</tt> sequences+ <span class="roman">→</span> result</em></dt>
</dl>
<dl>
<dt id="index-notevery-1">Function: <strong>notevery</strong> <em>predicate <tt>&amp;rest</tt> sequences+ <span class="roman">→</span> generalized-boolean</em></dt>
</dl>
<dl>
<dt id="index-notany-1">Function: <strong>notany</strong> <em>predicate <tt>&amp;rest</tt> sequences+ <span class="roman">→</span> generalized-boolean</em></dt>
</dl>

<span id="Arguments-and-Values_003a-59"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>predicate</var>&mdash;a <i>designator</i> for a <i>function</i> of
as many <i>arguments</i> as there are <var>sequences</var>.
</p>
<p><var>sequence</var>&mdash;a <i>sequence</i>.
</p>
<p><var>result</var>&mdash;an <i>object</i>.
</p>
<p><var>generalized-boolean</var>&mdash;a <i>generalized boolean</i>. 
</p>
<span id="Description_003a-93"></span><h4 class="subsubheading">Description:</h4>

<p><code>every</code>, <code>some</code>, <code>notevery</code>, and <code>notany</code>
test <i>elements</i> of <var>sequences</var> for satisfaction of a given <var>predicate</var>.
The first argument to <var>predicate</var> is an <i>element</i> of the first <var>sequence</var>;
each succeeding argument is an <i>element</i> of a succeeding <var>sequence</var>.
</p>
<p><var>Predicate</var> is first applied to the elements
with index <code>0</code> in each of the <var>sequences</var>, and possibly then to
the elements with index <code>1</code>, and so on, until a termination
criterion is met or the end of the shortest of the <var>sequences</var> is reached.
</p>
<p><code>every</code> returns <i>false</i> as soon 
as any invocation of <var>predicate</var> returns <i>false</i>.
If the end of a <var>sequence</var> is reached,
<code>every</code> returns <i>true</i>.
Thus, <code>every</code> returns <i>true</i> if and only if
every invocation of <var>predicate</var> returns <i>true</i>.
</p>
<p><code>some</code> returns the first <i>non-nil</i> value 
which is returned by an invocation of <var>predicate</var>.
If the end of a <var>sequence</var> is reached without any invocation of the
<var>predicate</var> returning <i>true</i>, <code>some</code> returns <i>false</i>.
Thus, <code>some</code> returns <i>true</i> if and only if
some invocation of <var>predicate</var> returns <i>true</i>.
</p>
<p><code>notany</code> returns <i>false</i> 
as soon as any invocation of <var>predicate</var> returns <i>true</i>.
If the end of a <var>sequence</var> is reached,
<code>notany</code> returns <i>true</i>.
Thus, <code>notany</code> returns <i>true</i> if and only if 
it is not the case that any invocation of <var>predicate</var> returns <i>true</i>.
</p>
<p><code>notevery</code> returns <i>true</i> as soon as any invocation of
<var>predicate</var> returns <i>false</i>.
If the end of a <var>sequence</var> is reached,
<code>notevery</code> returns <i>false</i>.
Thus, <code>notevery</code> returns <i>true</i> if and only if 
it is not the case that every invocation of <var>predicate</var> returns <i>true</i>.
</p>
<span id="Examples_003a-67"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (every #'characterp &quot;abc&quot;) <span class="roman">→</span> <i>true</i>
 (some #'= '(1 2 3 4 5) '(5 4 3 2 1)) <span class="roman">→</span> <i>true</i>
 (notevery #'&lt; '(1 2 3 4) '(5 6 7 8) '(9 10 11 12)) <span class="roman">→</span> <i>false</i>
 (notany #'&gt; '(1 2 3 4) '(5 6 7 8) '(9 10 11 12)) <span class="roman">→</span> <i>true</i> 
</pre></div>


<span id="Exceptional-Situations_003a-17"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>Should signal <code>type-error</code> if its first argument is neither a
<i>symbol</i> nor a <i>function</i> or if any subsequent
argument is not a <i>proper sequence</i>.
</p>
<p>Other exceptional situations are possible, depending on the nature
of the <var>predicate</var>.
</p>
<span id="See-Also_003a-77"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#and-_0028Macro_0029">and (Macro)</a>,
<a href="#or-_0028Macro_0029">or (Macro)</a>,
<a href="Evaluation-and-Compilation.html#Traversal-Rules-and-Side-Effects">Section 3.6 (Traversal Rules and Side Effects)</a>
</p>
<span id="Notes_003a-49"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (notany <var>predicate</var> <tt>{</tt>sequence<tt>}</tt>*) ≡ (not (some <var>predicate</var> <tt>{</tt>sequence<tt>}</tt>*))
 (notevery <var>predicate</var> <tt>{</tt>sequence<tt>}</tt>*) ≡ (not (every <var>predicate</var> <tt>{</tt>sequence<tt>}</tt>*))
</pre></div>



<hr>
<span id="and-_0028Macro_0029"></span><div class="header">
<p>
Next: <a href="#cond" accesskey="n" rel="next">cond</a>, Previous: <a href="#every_003b-some_003b-notevery_003b-notany" accesskey="p" rel="prev">every; some; notevery; notany</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">and (Macro)</h4>
<span id="and-_0028Macro_0029-1"></span><h3 class="heading">and (Macro)</h3>
<span id="index-and-5"></span>
<span id="index-and-1"></span>


<span id="Syntax_003a-70"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-and-3">Macro: <strong>and</strong> <em><tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-60"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> resulting from the evaluation of 
the last <var>form</var>, or the symbols <code>nil</code>&nbsp;<!-- /@w -->or <code>t</code>.
</p>
<span id="Description_003a-94"></span><h4 class="subsubheading">Description:</h4>

<p>The macro <code>and</code> evaluates each <var>form</var> one at a time from left to right. 
As soon as any <var>form</var> evaluates to <code>nil</code>, <code>and</code> returns
<code>nil</code>&nbsp;<!-- /@w -->without evaluating the remaining <var>forms</var>.  If all <var>forms</var>
but the last evaluate to <i>true</i> values, <code>and</code> returns the results
produced by evaluating the last <var>form</var>.
</p>
<p>If no <var>forms</var> are supplied, <code>(and)</code> returns <code>t</code>.
</p>
<p><code>and</code> passes back multiple values from the last <i>subform</i>
but not from subforms other than the last.
</p>
<span id="Examples_003a-68"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (if (and (&gt;= n 0)
          (&lt; n (length a-simple-vector))
          (eq (elt a-simple-vector n) 'foo))
     (princ &quot;Foo!&quot;))
</pre></div>

<p>The above expression prints <code>Foo!</code> if element <code>n</code> of <code>a-simple-vector</code>
is the symbol <code>foo</code>, provided also that <code>n</code> is indeed a valid index
for <code>a-simple-vector</code>.  Because <code>and</code> guarantees 
left-to-right testing
of its parts, <code>elt</code> is not called if <code>n</code> is out of range.
</p>
<div class="lisp">
<pre class="lisp"> (setq temp1 1 temp2 1 temp3 1) <span class="roman">→</span> 1 
 (and (incf temp1) (incf temp2) (incf temp3)) <span class="roman">→</span> 2 
 (and (eql 2 temp1) (eql 2 temp2) (eql 2 temp3)) <span class="roman">→</span> <i>true</i>
 (decf temp3) <span class="roman">→</span> 1 
 (and (decf temp1) (decf temp2) (eq temp3 'nil) (decf temp3)) <span class="roman">→</span> NIL 
 (and (eql temp1 temp2) (eql temp2 temp3)) <span class="roman">→</span> <i>true</i>
 (and) <span class="roman">→</span> T 
</pre></div>


<span id="See-Also_003a-78"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#cond">cond</a>,
<a href="#every">every</a>,
<a href="#if">if</a>,
<a href="#or-_0028Macro_0029">or (Macro)</a>,
<a href="#when">when</a>
</p>
<span id="Notes_003a-50"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (and <var>form</var>) ≡ (let () <var>form</var>)
 (and <var>form1</var> <var>form2</var> ...) ≡ (when <var>form1</var> (and <var>form2</var> ...))
</pre></div>



<hr>
<span id="cond"></span><div class="header">
<p>
Next: <a href="#if" accesskey="n" rel="next">if</a>, Previous: <a href="#and-_0028Macro_0029" accesskey="p" rel="prev">and (Macro)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">cond</h4>
<span id="cond-_0028Macro_0029"></span><h3 class="heading">cond (Macro)</h3>
<span id="index-cond-2"></span>
<span id="index-cond"></span>
                                         

<span id="Syntax_003a-71"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-cond-1">Macro: <strong>cond</strong> <em><tt>{</tt><tt>↓</tt>clause<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl compact="compact">
<dt><var>clause</var>::=</dt>
<dd><p><tt>(</tt>test-form <tt>{</tt>form<tt>}</tt>*<tt>)</tt>
</p></dd>
</dl>

<span id="Arguments-and-Values_003a-61"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>test-form</var>&mdash;a <i>form</i>.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> of the <var>forms</var> 
in the first <var>clause</var> whose <var>test-form</var> <i>yields</i> <i>true</i>,
or the <i>primary value</i> of the <var>test-form</var>
if there are no <var>forms</var> in that <var>clause</var>,
or else <code>nil</code>&nbsp;<!-- /@w -->if no <var>test-form</var> <i>yields</i> <i>true</i>.
</p>
<span id="Description_003a-95"></span><h4 class="subsubheading">Description:</h4>

<p><code>cond</code> allows the execution of <var>forms</var> to be dependent
on <var>test-form</var>.
</p>
<p><var>Test-forms</var> are evaluated one at a time in the order in which
they are given in the argument list until a <var>test-form</var> is found that
evaluates to <i>true</i>.
</p>
<p>If there are no <i>forms</i> in that clause, the <i>primary value</i> 
of the <var>test-form</var> is returned by the <code>cond</code> <i>form</i>.
Otherwise, the <var>forms</var> associated with this <var>test-form</var> are
evaluated in order, left to right, as an <i>implicit progn</i>, and the
<i>values</i> returned by the last <var>form</var> 
are returned by the <code>cond</code> <i>form</i>.
</p>
<p>Once one <var>test-form</var> has <i>yielded</i> <i>true</i>,
no additional <var>test-forms</var> are <i>evaluated</i>.
If no <var>test-form</var> <i>yields</i> <i>true</i>, <code>nil</code>&nbsp;<!-- /@w -->is returned.
</p>
<span id="Examples_003a-69"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (defun select-options ()
   (cond ((= a 1) (setq a 2))
         ((= a 2) (setq a 3))
         ((and (= a 3) (floor a 2)))
         (t (floor a 3)))) <span class="roman">→</span> SELECT-OPTIONS
 (setq a 1) <span class="roman">→</span> 1
 (select-options) <span class="roman">→</span> 2
 a <span class="roman">→</span> 2
 (select-options) <span class="roman">→</span> 3
 a <span class="roman">→</span> 3
 (select-options) <span class="roman">→</span> 1
 (setq a 5) <span class="roman">→</span> 5
 (select-options) <span class="roman">→</span> 1, 2
</pre></div>


<span id="See-Also_003a-79"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#if">if</a>, <a href="#case">case</a>.
</p>

<hr>
<span id="if"></span><div class="header">
<p>
Next: <a href="#or-_0028Macro_0029" accesskey="n" rel="next">or (Macro)</a>, Previous: <a href="#cond" accesskey="p" rel="prev">cond</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">if</h4>
<span id="if-_0028Special-Operator_0029"></span><h3 class="heading">if (Special Operator)</h3>
<span id="index-if-2"></span>
<span id="index-if"></span>


<span id="Syntax_003a-72"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-if-1">Special Form: <strong>if</strong> <em><var>test-form</var> <var>then-form</var> <tt>[</tt><var>else-form</var><tt>]</tt> <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-62"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>Test-form</var>&mdash;a <i>form</i>.
</p>
<p><var>Then-form</var>&mdash;a <i>form</i>.
</p>
<p><var>Else-form</var>&mdash;a <i>form</i>.
The default is <code>nil</code>.
</p>
<p><var>results</var>&mdash;if the <var>test-form</var> <i>yielded</i> <i>true</i>,
the <i>values</i> returned by the <var>then-form</var>; otherwise,
the <i>values</i> returned by the <var>else-form</var>.
</p>
<span id="Description_003a-96"></span><h4 class="subsubheading">Description:</h4>

<p><code>if</code> allows the execution of a <i>form</i> to be dependent
on a single <var>test-form</var>.
</p>
<p>First <var>test-form</var> is evaluated.
If the result is <i>true</i>, then <var>then-form</var> is selected;
otherwise <var>else-form</var> is selected.
Whichever form is selected is then evaluated.
</p>
<span id="Examples_003a-70"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (if t 1) <span class="roman">→</span> 1
 (if nil 1 2) <span class="roman">→</span> 2 
 (defun test ()
   (dolist (truth-value '(t nil 1 (a b c)))
     (if truth-value (print 'true) (print 'false))
     (prin1 truth-value))) <span class="roman">→</span> TEST
 (test)
▷ TRUE T
▷ FALSE NIL
▷ TRUE 1
▷ TRUE (A B C)
<span class="roman">→</span> NIL
</pre></div>


<span id="See-Also_003a-80"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#cond">cond</a>,
<a href="#unless">unless</a>,
<a href="#when">when</a>
</p>
<span id="Notes_003a-51"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (if <var>test-form</var> <var>then-form</var> <var>else-form</var>)
 ≡ (cond (<var>test-form</var> <var>then-form</var>) (t <var>else-form</var>))
</pre></div>



<hr>
<span id="or-_0028Macro_0029"></span><div class="header">
<p>
Next: <a href="#when_003b-unless" accesskey="n" rel="next">when; unless</a>, Previous: <a href="#if" accesskey="p" rel="prev">if</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">or (Macro)</h4>
<span id="or-_0028Macro_0029-1"></span><h3 class="heading">or (Macro)</h3>
<span id="index-or-5"></span>
<span id="index-or-1"></span>


<span id="Syntax_003a-73"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-or-3">Macro: <strong>or</strong> <em><tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>results<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-63"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> or <i>primary value</i> (see below)
resulting from the evaluation of
the last <var>form</var> executed or <code>nil</code>.
</p>
<span id="Description_003a-97"></span><h4 class="subsubheading">Description:</h4>

<p><code>or</code> evaluates each <var>form</var>, one at a time, from left to right.  
The evaluation of all <var>forms</var> terminates when a <var>form</var> evaluates
to <i>true</i> (<i>i.e.</i>, something other than <code>nil</code>).
</p>
<p>If the <i>evaluation</i> of any <var>form</var> other than the last returns a
<i>primary value</i> that is <i>true</i>, <code>or</code> immediately returns
that <i>value</i> (but no additional <i>values</i>) without evaluating the
remaining <var>forms</var>.
If every <var>form</var> but the last returns <i>false</i> as its <i>primary value</i>,
<code>or</code> returns all <i>values</i> returned by the last <var>form</var>.
If no <var>forms</var> are supplied, <code>or</code> returns <code>nil</code>.
</p>
<span id="Examples_003a-71"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (or) <span class="roman">→</span> NIL 
 (setq temp0 nil temp1 10 temp2 20 temp3 30) <span class="roman">→</span> 30
 (or temp0 temp1 (setq temp2 37)) <span class="roman">→</span> 10
 temp2 <span class="roman">→</span> 20
 (or (incf temp1) (incf temp2) (incf temp3)) <span class="roman">→</span> 11
 temp1 <span class="roman">→</span> 11
 temp2 <span class="roman">→</span> 20
 temp3 <span class="roman">→</span> 30
 (or (values) temp1) <span class="roman">→</span> 11
 (or (values temp1 temp2) temp3) <span class="roman">→</span> 11
 (or temp0 (values temp1 temp2)) <span class="roman">→</span> 11, 20
 (or (values temp0 temp1) (values temp2 temp3)) <span class="roman">→</span> 20, 30
</pre></div>


<span id="See-Also_003a-81"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#and-_0028Macro_0029">and (Macro)</a>,
<a href="#some">some</a>,
<a href="#unless">unless</a>
</p>

<hr>
<span id="when_003b-unless"></span><div class="header">
<p>
Next: <a href="#case_003b-ccase_003b-ecase" accesskey="n" rel="next">case; ccase; ecase</a>, Previous: <a href="#or-_0028Macro_0029" accesskey="p" rel="prev">or (Macro)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">when; unless</h4>
<span id="when_002c-unless-_0028Macro_0029"></span><h3 class="heading">when, unless (Macro)</h3>
<span id="index-when-2"></span>
<span id="index-when"></span>
<span id="index-unless-2"></span>
<span id="index-unless"></span>
<span id="when"></span><span id="unless"></span>

<span id="Syntax_003a-74"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-when-1">Macro: <strong>when</strong> <em>test-form <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl>
<dt id="index-unless-1">Macro: <strong>unless</strong> <em>test-form <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-64"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>test-form</var>&mdash;a <i>form</i>.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> of the <i>forms</i>
in a  <code>when</code>   <i>form</i> if the <var>test-form</var> <i>yields</i> <i>true</i> 
or in an <code>unless</code> <i>form</i> if the <var>test-form</var> <i>yields</i> <i>false</i>;
otherwise <code>nil</code>.
</p>
<span id="Description_003a-98"></span><h4 class="subsubheading">Description:</h4>

<p><code>when</code> and <code>unless</code> allow the execution of <var>forms</var> 
to be dependent on a single <var>test-form</var>.
</p>
<p>In a <code>when</code> <i>form</i>,
if the <var>test-form</var> <i>yields</i> <i>true</i>,
the <var>forms</var> are <i>evaluated</i> in order from left to right
and the <i>values</i> returned by the <var>forms</var> 
are returned from the <code>when</code> <i>form</i>. 
Otherwise, if the <var>test-form</var> <i>yields</i> <i>false</i>,
the <var>forms</var> are not <i>evaluated</i>,
and the <code>when</code> <i>form</i> returns <code>nil</code>.
</p>
<p>In an <code>unless</code> <i>form</i>,
if the <var>test-form</var> <i>yields</i> <i>false</i>,
the <var>forms</var> are <i>evaluated</i> in order from left to right
and the <i>values</i> returned by the <var>forms</var> 
are returned from the <code>unless</code> <i>form</i>. 
Otherwise, if the <var>test-form</var> <i>yields</i> <i>false</i>,
the <var>forms</var> are not <i>evaluated</i>,
and the <code>unless</code> <i>form</i> returns <code>nil</code>.
</p>
<span id="Examples_003a-72"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (when t 'hello) <span class="roman">→</span> HELLO
 (unless t 'hello) <span class="roman">→</span> NIL
 (when nil 'hello) <span class="roman">→</span> NIL
 (unless nil 'hello) <span class="roman">→</span> HELLO
 (when t) <span class="roman">→</span> NIL
 (unless nil) <span class="roman">→</span> NIL
 (when t (prin1 1) (prin1 2) (prin1 3))
▷ 123
<span class="roman">→</span> 3
 (unless t (prin1 1) (prin1 2) (prin1 3)) <span class="roman">→</span> NIL
 (when nil (prin1 1) (prin1 2) (prin1 3)) <span class="roman">→</span> NIL
 (unless nil (prin1 1) (prin1 2) (prin1 3))
▷ 123
<span class="roman">→</span> 3
 (let ((x 3))
   (list (when (oddp x) (incf x) (list x))
         (when (oddp x) (incf x) (list x))
         (unless (oddp x) (incf x) (list x))
         (unless (oddp x) (incf x) (list x))
         (if (oddp x) (incf x) (list x)) 
         (if (oddp x) (incf x) (list x)) 
         (if (not (oddp x)) (incf x) (list x)) 
         (if (not (oddp x)) (incf x) (list x))))
<span class="roman">→</span> ((4) NIL (5) NIL 6 (6) 7 (7))
</pre></div>


<span id="See-Also_003a-82"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#and-_0028Macro_0029">and (Macro)</a>,
<a href="#cond">cond</a>,
<a href="#if">if</a>,
<a href="#or-_0028Macro_0029">or (Macro)</a>
</p>
<span id="Notes_003a-52"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (when <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (and <var>test</var> (progn <tt>{</tt><var>form</var><tt>}</tt>+))
 (when <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (cond (<var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+))
 (when <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (if <var>test</var> (progn <tt>{</tt><var>form</var><tt>}</tt>+) nil)
 (when <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (unless (not <var>test</var>) <tt>{</tt><var>form</var><tt>}</tt>+)
 (unless <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (cond ((not <var>test</var>) <tt>{</tt><var>form</var><tt>}</tt>+))
 (unless <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (if <var>test</var> nil (progn <tt>{</tt><var>form</var><tt>}</tt>+))
 (unless <var>test</var> <tt>{</tt><var>form</var><tt>}</tt>+) ≡ (when (not <var>test</var>) <tt>{</tt><var>form</var><tt>}</tt>+)
</pre></div>



<hr>
<span id="case_003b-ccase_003b-ecase"></span><div class="header">
<p>
Next: <a href="#typecase_003b-ctypecase_003b-etypecase" accesskey="n" rel="next">typecase; ctypecase; etypecase</a>, Previous: <a href="#when_003b-unless" accesskey="p" rel="prev">when; unless</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">case; ccase; ecase</h4>
<span id="case_002c-ccase_002c-ecase-_0028Macro_0029"></span><h3 class="heading">case, ccase, ecase (Macro)</h3>
<span id="index-case-3"></span>
<span id="index-case"></span>
<span id="index-ccase-3"></span>
<span id="index-ccase"></span>
<span id="index-ecase-3"></span>
<span id="index-ecase"></span>
<span id="case"></span><span id="ccase"></span>

<span id="Syntax_003a-75"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-case-2">Macro: <strong>case</strong> <em>keyform  <tt>{</tt><tt>↓</tt>normal-clause<tt>}</tt>* <tt>[</tt><tt>↓</tt>otherwise-clause<tt>]</tt> <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>
<dl>
<dt id="index-ccase-2">Macro: <strong>ccase</strong> <em>keyplace <tt>{</tt><tt>↓</tt>normal-clause<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>
<dl>
<dt id="index-ecase-2">Macro: <strong>ecase</strong> <em>keyform  <tt>{</tt><tt>↓</tt>normal-clause<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl compact="compact">
<dt><var>normal-clause</var>::=</dt>
<dd><p><tt>(</tt>keys <tt>{</tt>form<tt>}</tt>*<tt>)</tt>
</p></dd>
</dl>
<dl compact="compact">
<dt><var>otherwise-clause</var>::=</dt>
<dd><p><tt>(</tt><tt>{</tt>otherwise | t<tt>}</tt> <tt>{</tt>form<tt>}</tt>*<tt>)</tt>
</p></dd>
</dl>
<dl compact="compact">
<dt><var>clause</var>::=</dt>
<dd><p>normal-clause | otherwise-clause
</p></dd>
</dl>
<span id="index-otherwise"></span>
<span id="index-t-2"></span>

<span id="Arguments-and-Values_003a-65"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>keyform</var>&mdash;a <i>form</i>; evaluated to produce a <var>test-key</var>.
</p>
<p><var>keyplace</var>&mdash;a <i>form</i>; evaluated initially to produce a <var>test-key</var>.
Possibly also used later as a <i>place</i> if no <var>keys</var> match.
</p>
<p><var>test-key</var>&mdash;an object produced by evaluating <var>keyform</var> or <var>keyplace</var>.
</p>
<p><var>keys</var>&mdash;a <i>designator</i> for a <i>list</i> of <i>objects</i>.
In the case of <code>case</code>, the <i>symbols</i> <code>t</code>&nbsp;<!-- /@w -->and <tt>otherwise</tt> may
not be used as the <var>keys</var> <i>designator</i>.  To refer to these <i>symbols</i>
by themselves as <var>keys</var>, the designators <code>(t)</code> and <code>(otherwise)</code>, respectively,
must be used instead.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <var>forms</var> 
in the matching <var>clause</var>.
</p>
<span id="Description_003a-99"></span><h4 class="subsubheading">Description:</h4>

<p>These <i>macros</i> allow the conditional execution of a body of <var>forms</var>
in a <var>clause</var> that is selected by matching the <var>test-key</var> on the
basis of its identity.
</p>
<p>The <var>keyform</var> or <var>keyplace</var> is <i>evaluated</i> to produce the
<var>test-key</var>.
</p>
<p>Each of the <var>normal-clauses</var> is then considered in turn.
If the <var>test-key</var> is the <i>same</i> as any <i>key</i> for 
that <var>clause</var>, the <var>forms</var> in that <var>clause</var> are
<var>evaluated</var> as an <i>implicit progn</i>, and the <i>values</i>
it returns are returned as the value of the <code>case</code>,
<code>ccase</code>, or <code>ecase</code> <i>form</i>.
</p>
<p>These <i>macros</i> differ only in their <i>behavior</i> when 
no <var>normal-clause</var> matches; specifically:
</p>

<dl compact="compact">
<dt><code>case</code></dt>
<dd>

<p>If no <var>normal-clause</var> matches, and there is an <var>otherwise-clause</var>,
then that <var>otherwise-clause</var> automatically matches; the <var>forms</var> in
that <var>clause</var> are <var>evaluated</var> as an <i>implicit progn</i>, 
and the <i>values</i> it returns are returned as the value of the <code>case</code>.
</p>
<p>If there is no <var>otherwise-clause</var>, <code>case</code> returns <code>nil</code>.
</p>
</dd>
<dt><code>ccase</code></dt>
<dd>

<p>If no <var>normal-clause</var> matches,
a <i>correctable</i> <i>error</i> of <i>type</i> <code>type-error</code> is signaled.
The offending datum is the <var>test-key</var> and
the expected type is <i>type equivalent</i> to <code>(member <var>key1</var> <var>key2</var> ...)</code>.
the <code>store-value</code> restart can be used to correct the error.
</p>
<p>If the <code>store-value</code> restart is invoked, its <i>argument</i> becomes the 
new <var>test-key</var>, and is stored in <var>keyplace</var> as if by
<code>(setf <var>keyplace</var> <var>test-key</var>)</code>.
Then <code>ccase</code> starts over, considering each <var>clause</var> anew.
</p>


<p>The subforms of <var>keyplace</var> might be evaluated again if
none of the cases holds.
</p>
</dd>
<dt><code>ecase</code></dt>
<dd>

<p>If no <var>normal-clause</var> matches,
a <i>non-correctable</i> <i>error</i> of <i>type</i> <code>type-error</code> is signaled.
The offending datum is the <var>test-key</var> and
the expected type is <i>type equivalent</i> to <code>(member <var>key1</var> <var>key2</var> ...)</code>.
</p>
<p>Note that in contrast with <code>ccase</code>,
the caller of <code>ecase</code> may rely on the fact that <code>ecase</code> 
does not return if a <var>normal-clause</var> does not match.
</p></dd>
</dl>


<span id="Examples_003a-73"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (dolist (k '(1 2 3 :four #\v () t 'other))
    (format t &quot;~S &quot;
       (case k ((1 2) 'clause1)
               (3 'clause2)
               (nil 'no-keys-so-never-seen)
               ((nil) 'nilslot)
               ((:four #\v) 'clause4)
               ((t) 'tslot)
               (otherwise 'others)))) 
▷ CLAUSE1 CLAUSE1 CLAUSE2 CLAUSE4 CLAUSE4 NILSLOT TSLOT OTHERS 
<span class="roman">→</span> NIL
 (defun add-em (x) (apply #'+ (mapcar #'decode x)))
<span class="roman">→</span> ADD-EM
 (defun decode (x)
   (ccase x
     ((i uno) 1)
     ((ii dos) 2)
     ((iii tres) 3)
     ((iv cuatro) 4)))
<span class="roman">→</span> DECODE
 (add-em '(uno iii)) <span class="roman">→</span> 4
 (add-em '(uno iiii))
▷ Error: The value of X, IIII, is not I, UNO, II, DOS, III,
▷        TRES, IV, or CUATRO.
▷  1: Supply a value to use instead.
▷  2: Return to Lisp Toplevel.
▷ Debug&gt; <kbd>:CONTINUE 1</kbd>
▷ Value to evaluate and use for X: <kbd>'IV</kbd>
<span class="roman">→</span> 5
</pre></div>


<span id="Side-Effects_003a-3"></span><h4 class="subsubheading">Side Effects:</h4>

<p>The debugger might be entered.
If the <code>store-value</code> restart is invoked,
the <i>value</i> of <var>keyplace</var> might be changed.
</p>
<span id="Affected-By_003a-5"></span><h4 class="subsubheading">Affected By:</h4>

<p><code>ccase</code> and <code>ecase</code>, since they might signal an error,
are potentially affected by existing <var>handlers</var> and <code>*debug-io*</code>.
</p>
<span id="Exceptional-Situations_003a-18"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p><code>ccase</code> and <code>ecase</code> signal an error of <i>type</i> <code>type-error</code>
if no <var>normal-clause</var> matches.
</p>
<span id="See-Also_003a-83"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#cond">cond</a>,
<a href="#typecase">typecase</a>,
<a href="#setf">setf</a>,
<a href="#Generalized-Reference">Section 5.1 (Generalized Reference)</a>
</p>
<span id="Notes_003a-53"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp">(case <var>test-key</var>
  <tt>{</tt>((<tt>{</tt>key<tt>}</tt>*) <tt>{</tt>form<tt>}</tt>*)<tt>}</tt>*)
≡
(let ((#1=#:g0001 <var>test-key</var>))
  (cond <tt>{</tt>((member #1# '(<tt>{</tt>key<tt>}</tt>*)) <tt>{</tt>form<tt>}</tt>*)<tt>}</tt>*))
</pre></div>


<p>The specific error message used by <code>ecase</code> and <code>ccase</code> can vary
between implementations.  In situations where control of the specific wording 
of the error message is important, it is better to use <code>case</code> with an
<var>otherwise-clause</var> that explicitly signals an error with an appropriate 
message.
</p>

<hr>
<span id="typecase_003b-ctypecase_003b-etypecase"></span><div class="header">
<p>
Next: <a href="#multiple_002dvalue_002dbind" accesskey="n" rel="next">multiple-value-bind</a>, Previous: <a href="#case_003b-ccase_003b-ecase" accesskey="p" rel="prev">case; ccase; ecase</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">typecase; ctypecase; etypecase</h4>
<span id="typecase_002c-ctypecase_002c-etypecase-_0028Macro_0029"></span><h3 class="heading">typecase, ctypecase, etypecase (Macro)</h3>
<span id="index-typecase-2"></span>
<span id="index-typecase"></span>
<span id="index-ctypecase-2"></span>
<span id="index-ctypecase"></span>
<span id="index-etypecase-2"></span>
<span id="index-etypecase"></span>
<span id="typecase"></span><span id="ctypecase"></span>

<span id="Syntax_003a-76"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-typecase-1">Macro: <strong>typecase</strong> <em>keyform  <tt>{</tt><tt>↓</tt>normal-clause<tt>}</tt>* <tt>[</tt><tt>↓</tt>otherwise-clause<tt>]</tt> <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>
<dl>
<dt id="index-ctypecase-1">Macro: <strong>ctypecase</strong> <em>keyplace <tt>{</tt><tt>↓</tt>normal-clause<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>
<dl>
<dt id="index-etypecase-1">Macro: <strong>etypecase</strong> <em>keyform  <tt>{</tt><tt>↓</tt>normal-clause<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl compact="compact">
<dt><var>normal-clause</var>::=</dt>
<dd><p><tt>(</tt>type <tt>{</tt>form<tt>}</tt>*<tt>)</tt>
</p></dd>
</dl>
<dl compact="compact">
<dt><var>otherwise-clause</var>::=</dt>
<dd><p><tt>(</tt><tt>{</tt>otherwise | t<tt>}</tt> <tt>{</tt>form<tt>}</tt>*<tt>)</tt>
</p></dd>
</dl>
<dl compact="compact">
<dt><var>clause</var>::=</dt>
<dd><p>normal-clause | otherwise-clause
</p></dd>
</dl>
<span id="index-otherwise-1"></span>
<span id="index-t-3"></span>

<span id="Arguments-and-Values_003a-66"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>keyform</var>&mdash;a <i>form</i>; evaluated to produce a <var>test-key</var>.
</p>
<p><var>keyplace</var>&mdash;a <i>form</i>; evaluated initially to produce a <var>test-key</var>.
Possibly also used later as a <i>place</i> if no <var>types</var> match.
</p>
<p><var>test-key</var>&mdash;an object produced by evaluating <var>keyform</var> or <var>keyplace</var>.
</p>
<p><var>type</var>&mdash;a <i>type specifier</i>.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <var>forms</var> 
in the matching <var>clause</var>.
</p>
<span id="Description_003a-100"></span><h4 class="subsubheading">Description:</h4>

<p>These <i>macros</i> allow the conditional execution of a body of <var>forms</var>
in a <var>clause</var> that is selected by matching the <var>test-key</var> on the basis 
of its <i>type</i>.
</p>
<p>The <var>keyform</var> or <var>keyplace</var> is <i>evaluated</i> to produce the
<var>test-key</var>.
</p>
<p>Each of the <var>normal-clauses</var> is then considered in turn.
If the <var>test-key</var> is of the <i>type</i> 
given by the <var>clauses</var>&rsquo;s <var>type</var>,
the <var>forms</var> in that <var>clause</var> are
<var>evaluated</var> as an <i>implicit progn</i>, and the <i>values</i>
it returns are returned as the value of the <code>typecase</code>,
<code>ctypecase</code>, or <code>etypecase</code> <i>form</i>.
</p>
<p>These <i>macros</i> differ only in their <i>behavior</i> when 
no <var>normal-clause</var> matches; specifically:
</p>

<dl compact="compact">
<dt><code>typecase</code></dt>
<dd>

<p>If no <var>normal-clause</var> matches, and there is an <var>otherwise-clause</var>,
then that <var>otherwise-clause</var> automatically matches; the <var>forms</var> in
that <var>clause</var> are <var>evaluated</var> as an <i>implicit progn</i>, 
and the <i>values</i> it returns are returned as the value of the <code>typecase</code>.
</p>
<p>If there is no <var>otherwise-clause</var>, <code>typecase</code> returns <code>nil</code>.
</p>
</dd>
<dt><code>ctypecase</code></dt>
<dd>

<p>If no <var>normal-clause</var> matches,
a <i>correctable</i> <i>error</i> of <i>type</i> <code>type-error</code> is signaled.
The offending datum is the <var>test-key</var> and
the expected type is <i>type equivalent</i> to <code>(or <var>type1</var> <var>type2</var> ...)</code>.
the <code>store-value</code> restart can be used to correct the error.
</p>
<p>If the <code>store-value</code> restart is invoked, its <i>argument</i> becomes the 
new <var>test-key</var>, and is stored in <var>keyplace</var> as if by
<code>(setf <var>keyplace</var> <var>test-key</var>)</code>.
Then <code>ctypecase</code> starts over, considering each <var>clause</var> anew.
</p>
<p>If the <code>store-value</code> restart is invoked interactively, 
the user is prompted for a new <var>test-key</var> to use.
</p>
<p>The subforms of <var>keyplace</var> might be evaluated again if
none of the cases holds.
</p>
</dd>
<dt><code>etypecase</code></dt>
<dd>

<p>If no <var>normal-clause</var> matches,
a <i>non-correctable</i> <i>error</i> of <i>type</i> <code>type-error</code> is signaled.
The offending datum is the <var>test-key</var> and
the expected type is <i>type equivalent</i> to <code>(or <var>type1</var> <var>type2</var> ...)</code>.
</p>
<p>Note that in contrast with <code>ctypecase</code>,
the caller of <code>etypecase</code> may rely on the fact that <code>etypecase</code> 
does not return if a <var>normal-clause</var> does not match.
</p></dd>
</dl>


<p>In all three cases, is permissible for more than one <var>clause</var> to specify a
matching <i>type</i>, particularly if one is a <i>subtype</i> of another;
the earliest applicable <var>clause</var> is chosen.
</p>
<span id="Examples_003a-74"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp">;;; (Note that the parts of this example which use TYPE-OF 
;;;  are implementation-dependent.)
 (defun what-is-it (x)
   (format t &quot;~&amp;~S is ~A.~%&quot;
           x (typecase x
               (float &quot;a float&quot;)
               (null &quot;a symbol, boolean false, or the empty list&quot;)
               (list &quot;a list&quot;)
               (t (format nil &quot;a(n) ~(~A~)&quot; (type-of x))))))
<span class="roman">→</span> WHAT-IS-IT
 (map 'nil #'what-is-it '(nil (a b) 7.0 7 box))
▷ NIL is a symbol, boolean false, or the empty list.
▷ (A B) is a list.
▷ 7.0 is a float.
▷ 7 is a(n) integer.
▷ BOX is a(n) symbol.
<span class="roman">→</span> NIL
 (setq x 1/3)
<span class="roman">→</span> 1/3
 (ctypecase x
     (integer (* x 4))
     (symbol  (symbol-value x)))
▷ Error: The value of X, 1/3, is neither an integer nor a symbol.
▷ To continue, type :CONTINUE followed by an option number:
▷  1: Specify a value to use instead.
▷  2: Return to Lisp Toplevel.
▷ Debug&gt; <kbd>:CONTINUE 1</kbd>
▷ Use value: <kbd>3.7</kbd>
▷ Error: The value of X, 3.7, is neither an integer nor a symbol.
▷ To continue, type :CONTINUE followed by an option number:
▷  1: Specify a value to use instead.
▷  2: Return to Lisp Toplevel.
▷ Debug&gt; <kbd>:CONTINUE 1</kbd>
▷ Use value: <kbd>12</kbd>
<span class="roman">→</span> 48
 x <span class="roman">→</span> 12
</pre></div>


<span id="Affected-By_003a-6"></span><h4 class="subsubheading">Affected By:</h4>

<p><code>ctypecase</code> and <code>etypecase</code>, since they might signal an error,
are potentially affected by existing <var>handlers</var> and <code>*debug-io*</code>.
</p>
<span id="Exceptional-Situations_003a-19"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p><code>ctypecase</code> and <code>etypecase</code> signal an error of <i>type</i> <code>type-error</code>
if no <var>normal-clause</var> matches.
</p>
<p>The <i>compiler</i> may choose to issue a warning of <i>type</i> <code>style-warning</code>
if a <var>clause</var> will never be selected because it is completely 
shadowed by earlier clauses.
</p>
<span id="See-Also_003a-84"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#case">case</a>,
<a href="#cond">cond</a>,
<a href="#setf">setf</a>,
<a href="#Generalized-Reference">Section 5.1 (Generalized Reference)</a>
</p>
<span id="Notes_003a-54"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp">(typecase <var>test-key</var>
  <tt>{</tt>(<var>type</var> <tt>{</tt>form<tt>}</tt>*)<tt>}</tt>*)
≡
(let ((#1=#:g0001 <var>test-key</var>))
  (cond <tt>{</tt>((typep #1# '<var>type</var>) <tt>{</tt>form<tt>}</tt>*)<tt>}</tt>*))
</pre></div>


<p>The specific error message used by <code>etypecase</code> and <code>ctypecase</code> can vary
between implementations.  In situations where control of the specific wording 
of the error message is important, it is better to use <code>typecase</code> with an
<var>otherwise-clause</var> that explicitly signals an error with an appropriate 
message.
</p>



<hr>
<span id="multiple_002dvalue_002dbind"></span><div class="header">
<p>
Next: <a href="#multiple_002dvalue_002dcall" accesskey="n" rel="next">multiple-value-call</a>, Previous: <a href="#typecase_003b-ctypecase_003b-etypecase" accesskey="p" rel="prev">typecase; ctypecase; etypecase</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">multiple-value-bind</h4>
<span id="multiple_002dvalue_002dbind-_0028Macro_0029"></span><h3 class="heading">multiple-value-bind (Macro)</h3>
<span id="index-multiple_002dvalue_002dbind-2"></span>
<span id="index-multiple_002dvalue_002dbind"></span>



<span id="Syntax_003a-77"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-multiple_002dvalue_002dbind-1">Macro: <strong>multiple-value-bind</strong> <em><tt>(</tt><tt>{</tt>var<tt>}</tt>*<tt>)</tt> <var>values-form</var> <tt>{</tt>declaration<tt>}</tt>* <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-67"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>var</var>&mdash;a <i>symbol</i> naming a variable; not evaluated.
</p>
<p><var>values-form</var>&mdash;a <i>form</i>; evaluated.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <var>forms</var>.
</p>
<span id="Description_003a-101"></span><h4 class="subsubheading">Description:</h4>

<p>Creates new variable <i>bindings</i> for the <var>vars</var> and
executes a series of <var>forms</var> that use these <i>bindings</i>.
</p>
<p>The variable <i>bindings</i> created are lexical unless
<code>special</code> declarations are specified.  
</p>
<p><var>Values-form</var> is evaluated, and each of the <var>vars</var> is
bound to the respective value returned by that <i>form</i>.  If there are more
<var>vars</var> than values returned, extra values of <code>nil</code>&nbsp;<!-- /@w -->are given to the
remaining <var>vars</var>. If there are more values than 
<var>vars</var>, the excess
values are discarded.  The <var>vars</var> are bound to the values over
the execution of the <var>forms</var>, which make up an implicit <code>progn</code>.
The consequences are unspecified if a type <var>declaration</var> is specified 
for a <var>var</var>, but the value to which
that <var>var</var> is bound  is not consistent with 
the type <var>declaration</var>.
</p>
<p>The <i>scopes</i> of the name binding and <var>declarations</var>
do not include the <var>values-form</var>.
</p>
<span id="Examples_003a-75"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (multiple-value-bind (f r) 
     (floor 130 11)
   (list f r)) <span class="roman">→</span> (11 9)
</pre></div>


<span id="See-Also_003a-85"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#let">let</a>,
<a href="#multiple_002dvalue_002dcall">multiple-value-call</a>
</p>
<span id="Notes_003a-55"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (multiple-value-bind (<tt>{</tt>var<tt>}</tt>*) <var>values-form</var> <tt>{</tt>form<tt>}</tt>*)
 ≡ (multiple-value-call #'(lambda (&amp;optional <tt>{</tt>var<tt>}</tt>* &amp;rest #1=#:ignore)
                             (declare (ignore #1#))
                             <tt>{</tt>form<tt>}</tt>*)
                         <var>values-form</var>)
</pre></div>




<hr>
<span id="multiple_002dvalue_002dcall"></span><div class="header">
<p>
Next: <a href="#multiple_002dvalue_002dlist" accesskey="n" rel="next">multiple-value-list</a>, Previous: <a href="#multiple_002dvalue_002dbind" accesskey="p" rel="prev">multiple-value-bind</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">multiple-value-call</h4>
<span id="multiple_002dvalue_002dcall-_0028Special-Operator_0029"></span><h3 class="heading">multiple-value-call (Special Operator)</h3>
<span id="index-multiple_002dvalue_002dcall-2"></span>
<span id="index-multiple_002dvalue_002dcall"></span>


<span id="Syntax_003a-78"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-multiple_002dvalue_002dcall-1">Special Form: <strong>multiple-value-call</strong> <em><var>function-form</var> <var>form</var>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-68"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>function-form</var>&mdash;a <i>form</i>; evaluated to produce <var>function</var>.
</p>
<p><var>function</var>&mdash;a <i>function designator</i> 
resulting from the evaluation of <var>function-form</var>.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> returned by the <var>function</var>.
</p>
<span id="Description_003a-102"></span><h4 class="subsubheading">Description:</h4>

<p>Applies <var>function</var> to a <i>list</i> of the <i>objects</i> collected from groups of 
<i>multiple values</i><sub>2</sub>
</p>
<p><code>multiple-value-call</code> first evaluates the <var>function-form</var>
to obtain <var>function</var>, and then evaluates each <var>form</var>.
All the values
of each <var>form</var> are gathered together (not just one value from each)
and given as arguments to the <var>function</var>.  
</p>
<span id="Examples_003a-76"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (multiple-value-call #'list 1 '/ (values 2 3) '/ (values) '/ (floor 2.5))
<span class="roman">→</span> (1 / 2 3 / / 2 0.5)
 (+ (floor 5 3) (floor 19 4)) ≡ (+ 1 4)
<span class="roman">→</span> 5
 (multiple-value-call #'+ (floor 5 3) (floor 19 4)) ≡ (+ 1 2 4 3)
<span class="roman">→</span> 10
</pre></div>


<span id="See-Also_003a-86"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#multiple_002dvalue_002dlist">multiple-value-list</a>, <a href="#multiple_002dvalue_002dbind">multiple-value-bind</a>
</p>

<hr>
<span id="multiple_002dvalue_002dlist"></span><div class="header">
<p>
Next: <a href="#multiple_002dvalue_002dprog1" accesskey="n" rel="next">multiple-value-prog1</a>, Previous: <a href="#multiple_002dvalue_002dcall" accesskey="p" rel="prev">multiple-value-call</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">multiple-value-list</h4>
<span id="multiple_002dvalue_002dlist-_0028Macro_0029"></span><h3 class="heading">multiple-value-list (Macro)</h3>
<span id="index-multiple_002dvalue_002dlist-2"></span>
<span id="index-multiple_002dvalue_002dlist"></span>


<span id="Syntax_003a-79"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-multiple_002dvalue_002dlist-1">Macro: <strong>multiple-value-list</strong> <em>form <span class="roman">→</span> list</em></dt>
</dl>

<span id="Arguments-and-Values_003a-69"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<p><var>list</var>&mdash;a <i>list</i> of the <i>values</i> returned by <var>form</var>.
</p>
<span id="Description_003a-103"></span><h4 class="subsubheading">Description:</h4>

<p><code>multiple-value-list</code> evaluates <var>form</var> 
and creates a <i>list</i> of the <i>multiple values</i><sub>2</sub>
</p>
<span id="Examples_003a-77"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (multiple-value-list (floor -3 4)) <span class="roman">→</span> (-1 1)
</pre></div>


<span id="See-Also_003a-87"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#values_002dlist">values-list</a>,
<a href="#multiple_002dvalue_002dcall">multiple-value-call</a>
</p>
<span id="Notes_003a-56"></span><h4 class="subsubheading">Notes:</h4>

<p><code>multiple-value-list</code> and <code>values-list</code> are inverses
of each other.
</p>
<div class="lisp">
<pre class="lisp"> (multiple-value-list form) ≡ (multiple-value-call #'list form)
</pre></div>



<hr>
<span id="multiple_002dvalue_002dprog1"></span><div class="header">
<p>
Next: <a href="#multiple_002dvalue_002dsetq" accesskey="n" rel="next">multiple-value-setq</a>, Previous: <a href="#multiple_002dvalue_002dlist" accesskey="p" rel="prev">multiple-value-list</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">multiple-value-prog1</h4>
<span id="multiple_002dvalue_002dprog1-_0028Special-Operator_0029"></span><h3 class="heading">multiple-value-prog1 (Special Operator)</h3>
<span id="index-multiple_002dvalue_002dprog1-2"></span>
<span id="index-multiple_002dvalue_002dprog1"></span>


<span id="Syntax_003a-80"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-multiple_002dvalue_002dprog1-1">Special Form: <strong>multiple-value-prog1</strong> <em>first-form <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> first-form-results</em></dt>
</dl>

<span id="Arguments-and-Values_003a-70"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>first-form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<p><var>form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<p><var>first-form-results</var>&mdash;the <i>values</i> resulting from
the <i>evaluation</i> of <var>first-form</var>.      
</p>
<span id="Description_003a-104"></span><h4 class="subsubheading">Description:</h4>

<p><code>multiple-value-prog1</code> evaluates <var>first-form</var> and saves
all the values produced by that <i>form</i>. It then evaluates each 
<var>form</var> from left to right, discarding their values.  
</p>
<span id="Examples_003a-78"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (setq temp '(1 2 3)) <span class="roman">→</span> (1 2 3)
 (multiple-value-prog1
    (values-list temp)
    (setq temp nil)
    (values-list temp)) <span class="roman">→</span> 1, 2, 3
</pre></div>


<span id="See-Also_003a-88"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#prog1">prog1</a>
</p>

<hr>
<span id="multiple_002dvalue_002dsetq"></span><div class="header">
<p>
Next: <a href="#values-_0028Accessor_0029" accesskey="n" rel="next">values (Accessor)</a>, Previous: <a href="#multiple_002dvalue_002dprog1" accesskey="p" rel="prev">multiple-value-prog1</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">multiple-value-setq</h4>
<span id="multiple_002dvalue_002dsetq-_0028Macro_0029"></span><h3 class="heading">multiple-value-setq (Macro)</h3>
<span id="index-multiple_002dvalue_002dsetq-2"></span>
<span id="index-multiple_002dvalue_002dsetq"></span>


<span id="Syntax_003a-81"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-multiple_002dvalue_002dsetq-1">Macro: <strong>multiple-value-setq</strong> <em>vars form <span class="roman">→</span> result</em></dt>
</dl>

<span id="Arguments-and-Values_003a-71"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>vars</var>&mdash;a <i>list</i> of <i>symbols</i>
that are either <i>variable</i> <i>names</i>
or <i>names</i> of <i>symbol macros</i>.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<p><var>result</var>&mdash;The <i>primary value</i> returned by the <var>form</var>.
</p>
<span id="Description_003a-105"></span><h4 class="subsubheading">Description:</h4>

<p><code>multiple-value-setq</code> assigns values to <var>vars</var>.
</p>
<p>The <var>form</var> is evaluated,
and each <var>var</var> is <i>assigned</i> 
to the corresponding <i>value</i> returned by that <i>form</i>. 
If there are more <var>vars</var> than <i>values</i> returned,
<code>nil</code>&nbsp;<!-- /@w -->is <i>assigned</i> to the extra <var>vars</var>.
If there are more <i>values</i> than <var>vars</var>,
the extra <i>values</i> are discarded.
</p>
<p>If any <var>var</var> is the <i>name</i> of a <i>symbol macro</i>,
then it is <i>assigned</i> as if by <code>setf</code>.  Specifically,
</p>

<div class="lisp">
<pre class="lisp"> (multiple-value-setq (<i>symbol</i><sub>1</sub>
</pre></div>

<p>is defined to always behave in the same way as
</p>
<div class="lisp">
<pre class="lisp"> (values (setf (values <i>symbol</i><sub>1</sub>
</pre></div>


<p>in order that the rules for order of evaluation and side-effects be consistent
with those used by <code>setf</code>.
<span id="index-order-of-evaluation-4"></span>
<span id="index-evaluation-order-4"></span>
See <a href="#SETFofVALUES">Section 5.1.2.3 (VALUES Forms as Places)</a>.
</p>
<span id="Examples_003a-79"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (multiple-value-setq (quotient remainder) (truncate 3.2 2)) <span class="roman">→</span> 1
 quotient <span class="roman">→</span> 1
 remainder <span class="roman">→</span> 1.2
 (multiple-value-setq (a b c) (values 1 2)) <span class="roman">→</span> 1
 a <span class="roman">→</span> 1
 b <span class="roman">→</span> 2
 c <span class="roman">→</span> NIL
 (multiple-value-setq (a b) (values 4 5 6)) <span class="roman">→</span> 4
 a <span class="roman">→</span> 4
 b <span class="roman">→</span> 5
</pre></div>


<span id="See-Also_003a-89"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#setq">setq</a>,
<a href="Evaluation-and-Compilation.html#symbol_002dmacrolet">symbol-macrolet</a>
</p>

<hr>
<span id="values-_0028Accessor_0029"></span><div class="header">
<p>
Next: <a href="#values_002dlist" accesskey="n" rel="next">values-list</a>, Previous: <a href="#multiple_002dvalue_002dsetq" accesskey="p" rel="prev">multiple-value-setq</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">values (Accessor)</h4>
<span id="values-_0028Accessor_0029-1"></span><h3 class="heading">values (Accessor)</h3>
<span id="index-values-4"></span>
<span id="index-values-1"></span>


<span id="Syntax_003a-82"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-values-2">Function: <strong>values</strong> <em><tt>&amp;rest</tt> object <span class="roman">→</span> <tt>{</tt>object<tt>}</tt>*</em></dt>
</dl>
<p><tt>(setf (values <tt>&amp;rest</tt> place) new-values)</tt>
</p>
<span id="Arguments-and-Values_003a-72"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>object</var>&mdash;an <i>object</i>.
</p>
<p><var>place</var>&mdash;a <i>place</i>.
</p>
<p><var>new-value</var>&mdash;an <i>object</i>.
</p>
<span id="Description_003a-106"></span><h4 class="subsubheading">Description:</h4>

<p><code>values</code> 
returns the <var>objects</var> as <i>multiple values</i><sub>2</sub>
</p>
<p><code>setf</code> of <code>values</code> is used to store the
<i>multiple values</i><sub>2</sub>
See <a href="#SETFofVALUES">Section 5.1.2.3 (VALUES Forms as Places)</a>.
</p>
<span id="Examples_003a-80"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (values) <span class="roman">→</span> &lt;no <i>values</i>&gt;
 (values 1) <span class="roman">→</span> 1
 (values 1 2) <span class="roman">→</span> 1, 2
 (values 1 2 3) <span class="roman">→</span> 1, 2, 3
 (values (values 1 2 3) 4 5) <span class="roman">→</span> 1, 4, 5
 (defun polar (x y)
   (values (sqrt (+ (* x x) (* y y))) (atan y x))) <span class="roman">→</span> POLAR
 (multiple-value-bind (r theta) (polar 3.0 4.0)
   (vector r theta))
<span class="roman">→</span> #(5.0 0.927295)
</pre></div>


<p>Sometimes it is desirable to indicate explicitly that a function returns
exactly one value.  For example, the function
</p>
<div class="lisp">
<pre class="lisp"> (defun foo (x y)
   (floor (+ x y) y)) <span class="roman">→</span> FOO
</pre></div>

<p>returns two values because <code>floor</code> returns
two values.  It may be that the second value makes no sense,
or that for efficiency reasons it is desired not to compute the
second value.  <code>values</code> is the standard idiom
for indicating that only one value is to be returned:
</p>
<div class="lisp">
<pre class="lisp"> (defun foo (x y)
   (values (floor (+ x y) y))) <span class="roman">→</span> FOO
</pre></div>

<p>This works because <code>values</code> 
returns exactly one value for each of
<var>args</var>; as for any function call,
if any of <var>args</var> produces more than one value, all but the
first are discarded.
</p>
<span id="See-Also_003a-90"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#values_002dlist">values-list</a>,
<a href="#multiple_002dvalue_002dbind">multiple-value-bind</a>,
<a href="#multiple_002dvalues_002dlimit">multiple-values-limit</a>,
<a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-57"></span><h4 class="subsubheading">Notes:</h4>

<p>Since <code>values</code> is a <i>function</i>, not a <i>macro</i> or <i>special form</i>,
it receives as <i>arguments</i> only the <i>primary values</i> of 
its <i>argument</i> <i>forms</i>.
</p>

<hr>
<span id="values_002dlist"></span><div class="header">
<p>
Next: <a href="#multiple_002dvalues_002dlimit" accesskey="n" rel="next">multiple-values-limit</a>, Previous: <a href="#values-_0028Accessor_0029" accesskey="p" rel="prev">values (Accessor)</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">values-list</h4>
<span id="values_002dlist-_0028Function_0029"></span><h3 class="heading">values-list (Function)</h3>
<span id="index-values_002dlist-2"></span>
<span id="index-values_002dlist"></span>


<span id="Syntax_003a-83"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-values_002dlist-1">Function: <strong>values-list</strong> <em>list <span class="roman">→</span> <tt>{</tt>element<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-73"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>list</var>&mdash;a <i>list</i>.
</p>
<p><var>elements</var>&mdash;the <i>elements</i> of the <var>list</var>.
</p>
<span id="Description_003a-107"></span><h4 class="subsubheading">Description:</h4>

<p>Returns the <i>elements</i> of the <var>list</var> as <i>multiple values</i><sub>2</sub>
</p>
<span id="Examples_003a-81"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (values-list nil) <span class="roman">→</span> &lt;no <i>values</i>&gt;
 (values-list '(1)) <span class="roman">→</span> 1
 (values-list '(1 2)) <span class="roman">→</span> 1, 2
 (values-list '(1 2 3)) <span class="roman">→</span> 1, 2, 3
</pre></div>


<span id="Exceptional-Situations_003a-20"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>Should signal <code>type-error</code> if its argument is not a <i>proper list</i>.
</p>
<span id="See-Also_003a-91"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#multiple_002dvalue_002dbind">multiple-value-bind</a>,
<a href="#multiple_002dvalue_002dlist">multiple-value-list</a>,
<a href="#multiple_002dvalues_002dlimit">multiple-values-limit</a>,
<a href="#values-_0028Accessor_0029">values (Accessor)</a>
</p>
<span id="Notes_003a-58"></span><h4 class="subsubheading">Notes:</h4>

<div class="lisp">
<pre class="lisp"> (values-list <var>list</var>) ≡ (apply #'values <var>list</var>)
</pre></div>


<p><code>(equal <var>x</var> (multiple-value-list (values-list <var>x</var>)))</code>
returns <i>true</i> for all <i>lists</i> <var>x</var>.
</p>

<hr>
<span id="multiple_002dvalues_002dlimit"></span><div class="header">
<p>
Next: <a href="#nth_002dvalue" accesskey="n" rel="next">nth-value</a>, Previous: <a href="#values_002dlist" accesskey="p" rel="prev">values-list</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">multiple-values-limit</h4>
<span id="multiple_002dvalues_002dlimit-_0028Constant-Variable_0029"></span><h3 class="heading">multiple-values-limit (Constant Variable)</h3>
<span id="index-multiple_002dvalues_002dlimit-1"></span>
<span id="index-multiple_002dvalues_002dlimit"></span>


<span id="Constant-Value_003a-5"></span><h4 class="subsubheading">Constant Value:</h4>

<p>An <i>integer</i> not smaller than <code>20</code>, 
the exact magnitude of which is <i>implementation-dependent</i>.
</p>
<span id="Description_003a-108"></span><h4 class="subsubheading">Description:</h4>

<p>The upper exclusive bound on the number of <i>values</i> that may be
returned from a <i>function</i>,
bound or assigned by <code>multiple-value-bind</code> or <code>multiple-value-setq</code>,
or passed as a first argument to <code>nth-value</code>.
(If these individual limits might differ, the minimum value is used.)
</p>
<span id="See-Also_003a-92"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#lambda_002dparameters_002dlimit">lambda-parameters-limit</a>, <a href="#call_002darguments_002dlimit">call-arguments-limit</a>
</p>
<span id="Notes_003a-59"></span><h4 class="subsubheading">Notes:</h4>

<p>Implementors are encouraged to make this limit as large as possible.
</p>

<hr>
<span id="nth_002dvalue"></span><div class="header">
<p>
Next: <a href="#prog_003b-prog_002a" accesskey="n" rel="next">prog; prog*</a>, Previous: <a href="#multiple_002dvalues_002dlimit" accesskey="p" rel="prev">multiple-values-limit</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">nth-value</h4>
<span id="nth_002dvalue-_0028Macro_0029"></span><h3 class="heading">nth-value (Macro)</h3>
<span id="index-nth_002dvalue-2"></span>
<span id="index-nth_002dvalue"></span>
                         


<span id="Syntax_003a-84"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-nth_002dvalue-1">Macro: <strong>nth-value</strong> <em>n form <span class="roman">→</span> object</em></dt>
</dl>

<span id="Arguments-and-Values_003a-74"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>n</var>&mdash;a non-negative <i>integer</i>; evaluated.
</p>
<p><var>form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<p><var>object</var>&mdash;an <i>object</i>.
</p>
<span id="Description_003a-109"></span><h4 class="subsubheading">Description:</h4>

<p>Evaluates <var>n</var> and then <var>form</var>,
returning as its only value the <var>n</var>th value <i>yielded</i> by <var>form</var>,
or <code>nil</code>&nbsp;<!-- /@w -->if <var>n</var> is greater than or equal to the number of <i>values</i>
returned by <var>form</var>.  (The first returned value is numbered <code>0</code>.)
</p>
<span id="Examples_003a-82"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (nth-value 0 (values 'a 'b)) <span class="roman">→</span> A
 (nth-value 1 (values 'a 'b)) <span class="roman">→</span> B
 (nth-value 2 (values 'a 'b)) <span class="roman">→</span> NIL
 (let* ((x 83927472397238947423879243432432432)
        (y 32423489732)
        (a (nth-value 1 (floor x y)))
        (b (mod x y)))
   (values a b (= a b)))
<span class="roman">→</span> 3332987528, 3332987528, <i>true</i>
</pre></div>


<span id="See-Also_003a-93"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#multiple_002dvalue_002dlist">multiple-value-list</a>,
<a href="Conses.html#nth">nth</a>
</p>
<span id="Notes_003a-60"></span><h4 class="subsubheading">Notes:</h4>

<p>Operationally, the following relationship is true, although <code>nth-value</code> 
might be more efficient in some <i>implementations</i> 
because, for example, some <i>consing</i> might be avoided.
</p>
<div class="lisp">
<pre class="lisp"> (nth-value <var>n</var> <var>form</var>) ≡ (nth <var>n</var> (multiple-value-list <var>form</var>))
</pre></div>



<hr>
<span id="prog_003b-prog_002a"></span><div class="header">
<p>
Next: <a href="#prog1_003b-prog2" accesskey="n" rel="next">prog1; prog2</a>, Previous: <a href="#nth_002dvalue" accesskey="p" rel="prev">nth-value</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">prog; prog*</h4>
<span id="prog_002c-prog_002a-_0028Macro_0029"></span><h3 class="heading">prog, prog* (Macro)</h3>
<span id="index-prog-2"></span>
<span id="index-prog"></span>
<span id="index-prog_002a-2"></span>
<span id="index-prog_002a"></span>



<span id="Syntax_003a-85"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-prog-1">Macro: <strong>prog</strong> <em><tt>(</tt><tt>{</tt><var>var</var> <span class="roman">|</span>  <tt>(</tt><var>var</var> <tt>[</tt><var>init-form</var><tt>]</tt><tt>)</tt><tt>}</tt>*<tt>)</tt> <tt>{</tt>declaration<tt>}</tt>* <tt>{</tt><var>tag</var> <span class="roman">|</span> <var>statement</var><tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<dl>
<dt id="index-prog_002a-1">Macro: <strong>prog*</strong> <em><tt>(</tt><tt>{</tt><var>var</var> <span class="roman">|</span>  <tt>(</tt><var>var</var> <tt>[</tt><var>init-form</var><tt>]</tt><tt>)</tt><tt>}</tt>*<tt>)</tt> <tt>{</tt>declaration<tt>}</tt>*  <tt>{</tt><var>tag</var> <span class="roman">|</span> <var>statement</var><tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-75"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>var</var>&mdash;variable name.
</p>
<p><var>init-form</var>&mdash;a <i>form</i>.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>tag</var>&mdash;a <i>go tag</i>; not evaluated.
</p>
<p><var>statement</var>&mdash;a <i>compound form</i>; evaluated as described below.
</p>
<p><var>results</var>&mdash;<code>nil</code>&nbsp;<!-- /@w -->if a <i>normal return</i> occurs,
or else, if an <i>explicit return</i> occurs, the <i>values</i> that were transferred.
</p>
<span id="Description_003a-110"></span><h4 class="subsubheading">Description:</h4>

<p>Three distinct operations are performed by <code>prog</code> and 
<code>prog*</code>:  
they bind local variables,
they permit use of the <code>return</code> 
statement, and they permit use of the <code>go</code>
statement.
A typical <code>prog</code> looks like this:
</p>
<div class="lisp">
<pre class="lisp"> (prog (var1 var2 (var3 init-form-3) var4 (var5 init-form-5))
       <tt>{</tt>declaration<tt>}</tt>*
       statement1
  tag1
       statement2
       statement3
       statement4
  tag2
       statement5
       ...
       )
</pre></div>


<p>For <code>prog</code>,
<var>init-forms</var> are evaluated first, in the order in which they are
supplied. The <var>vars</var> are then bound to the corresponding values in
parallel.  If no <var>init-form</var> 
is supplied for a given <var>var</var>, 
that <var>var</var> is  bound to <code>nil</code>.
</p>
<p>The body of <code>prog</code> is executed as if it were a <code>tagbody</code> <i>form</i>;
the <code>go</code> statement can be used to transfer control
to a <var>tag</var>.
<var>Tags</var> label <var>statements</var>.
</p>
<p><code>prog</code> implicitly establishes a <code>block</code> named <code>nil</code>&nbsp;<!-- /@w -->around
the entire <code>prog</code> <i>form</i>, so that <code>return</code> can be used
at any time to exit from the <code>prog</code> <i>form</i>.
</p>
<p>The difference between <code>prog*</code> and <code>prog</code> is that
in <code>prog*</code> the <i>binding</i> and initialization of the <var>vars</var> 
is done <i>sequentially</i>, so that the <var>init-form</var> for each
one can use the values of previous ones.
</p>
<span id="Examples_003a-83"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp">(prog* ((y z) (x (car y)))
       (return x))
</pre></div>

<p>returns the <i>car</i> of the value of <code>z</code>.
</p>
<div class="lisp">
<pre class="lisp"> (setq a 1) <span class="roman">→</span> 1
 (prog ((a 2) (b a)) (return (if (= a b) '= '/=))) <span class="roman">→</span> /=
 (prog* ((a 2) (b a)) (return (if (= a b) '= '/=))) <span class="roman">→</span> =
 (prog () 'no-return-value) <span class="roman">→</span> NIL
</pre></div>

<div class="lisp">
<pre class="lisp"> (defun king-of-confusion (w)
   &quot;Take a cons of two lists and make a list of conses.
    Think of this function as being like a zipper.&quot;
   (prog (x y z)          ;Initialize x, y, z to NIL
        (setq y (car w) z (cdr w))
    loop
        (cond ((null y) (return x))
              ((null z) (go err)))
    rejoin
        (setq x (cons (cons (car y) (car z)) x))
        (setq y (cdr y) z (cdr z))
        (go loop)
    err
        (cerror &quot;Will self-pair extraneous items&quot;
                &quot;Mismatch - gleep!  ~S&quot; y)
        (setq z y)
        (go rejoin))) <span class="roman">→</span> KING-OF-CONFUSION 
</pre></div>

<p>This can be accomplished more perspicuously as follows:
</p>
<div class="lisp">
<pre class="lisp"> (defun prince-of-clarity (w)
   &quot;Take a cons of two lists and make a list of conses.
    Think of this function as being like a zipper.&quot;
   (do ((y (car w) (cdr y))
        (z (cdr w) (cdr z))
        (x '() (cons (cons (car y) (car z)) x)))
       ((null y) x)
     (when (null z)
       (cerror &quot;Will self-pair extraneous items&quot;
              &quot;Mismatch - gleep!  ~S&quot; y)
       (setq z y)))) <span class="roman">→</span> PRINCE-OF-CLARITY 
</pre></div>


<span id="See-Also_003a-94"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#block">block</a>, <a href="#let">let</a>, <a href="#tagbody">tagbody</a>, <a href="#go">go</a>, 
<a href="#return">return</a>, <a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-61"></span><h4 class="subsubheading">Notes:</h4>
<p><code>prog</code> can be explained in terms of 
<code>block</code>, <code>let</code>, and <code>tagbody</code> as
follows:
</p>
<div class="lisp">
<pre class="lisp"> (prog <var>variable-list</var> <var>declaration</var> . <var>body</var>)
    ≡ (block nil (let <var>variable-list</var> <var>declaration</var> (tagbody . <var>body</var>)))
</pre></div>




<hr>
<span id="prog1_003b-prog2"></span><div class="header">
<p>
Next: <a href="#progn" accesskey="n" rel="next">progn</a>, Previous: <a href="#prog_003b-prog_002a" accesskey="p" rel="prev">prog; prog*</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">prog1; prog2</h4>
<span id="prog1_002c-prog2-_0028Macro_0029"></span><h3 class="heading">prog1, prog2 (Macro)</h3>
<span id="index-prog1-2"></span>
<span id="index-prog1"></span>
<span id="index-prog2-2"></span>
<span id="index-prog2"></span>
<span id="prog1"></span><span id="prog2"></span>

<span id="Syntax_003a-86"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-prog1-1">Macro: <strong>prog1</strong> <em>first-form             <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> result-1</em></dt>
</dl>
<dl>
<dt id="index-prog2-1">Macro: <strong>prog2</strong> <em>first-form second-form <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> result-2</em></dt>
</dl>

<span id="Arguments-and-Values_003a-76"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>first-form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<p><var>second-form</var>&mdash;a <i>form</i>; evaluated as described below.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>; evaluated as described below.
</p>
<p><var>result-1</var>&mdash;the <i>primary value</i> resulting from 
the <i>evaluation</i> of <var>first-form</var>.
</p>
<p><var>result-2</var>&mdash;the <i>primary value</i> resulting from 
the <i>evaluation</i> of <var>second-form</var>.
</p>
<span id="Description_003a-111"></span><h4 class="subsubheading">Description:</h4>

<p><code>prog1</code> <i>evaluates</i> <var>first-form</var> 
and then <var>forms</var>,
<i>yielding</i> as its only <i>value</i>
the <i>primary value</i> <i>yielded</i> by <var>first-form</var>.
</p>
<p><code>prog2</code> <i>evaluates</i> <var>first-form</var>,
then <var>second-form</var>,
and then <var>forms</var>,
<i>yielding</i> as its only <i>value</i>
the <i>primary value</i> <i>yielded</i> by <var>first-form</var>.
</p>
<span id="Examples_003a-84"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (setq temp 1) <span class="roman">→</span> 1
 (prog1 temp (print temp) (incf temp) (print temp))
▷ 1
▷ 2
<span class="roman">→</span> 1
 (prog1 temp (setq temp nil)) <span class="roman">→</span> 2
 temp <span class="roman">→</span> NIL
 (prog1 (values 1 2 3) 4) <span class="roman">→</span> 1 
 (setq temp (list 'a 'b 'c))
 (prog1 (car temp) (setf (car temp) 'alpha)) <span class="roman">→</span> A
 temp <span class="roman">→</span> (ALPHA B C)
 (flet ((swap-symbol-values (x y)
          (setf (symbol-value x) 
                (prog1 (symbol-value y)
                       (setf (symbol-value y) (symbol-value x))))))
   (let ((*foo* 1) (*bar* 2))
     (declare (special *foo* *bar*))
     (swap-symbol-values '*foo* '*bar*)
     (values *foo* *bar*)))
<span class="roman">→</span> 2, 1
 (setq temp 1) <span class="roman">→</span> 1
 (prog2 (incf temp) (incf temp) (incf temp)) <span class="roman">→</span> 3
 temp <span class="roman">→</span> 4
 (prog2 1 (values 2 3 4) 5) <span class="roman">→</span> 2
</pre></div>


<span id="See-Also_003a-95"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#multiple_002dvalue_002dprog1">multiple-value-prog1</a>,
<a href="#progn">progn</a>
</p>
<span id="Notes_003a-62"></span><h4 class="subsubheading">Notes:</h4>

<p><code>prog1</code> and <code>prog2</code> are typically used to <i>evaluate</i> 
one or more <i>forms</i> with side effects and return a <i>value</i> that
must be computed before some or all of the side effects happen.
</p>
<div class="lisp">
<pre class="lisp"> (prog1 <tt>{</tt>form<tt>}</tt>*) ≡ (values (multiple-value-prog1 <tt>{</tt>form<tt>}</tt>*))
 (prog2 <var>form1</var> <tt>{</tt>form<tt>}</tt>*) ≡ (let () <var>form1</var> (prog1 <tt>{</tt>form<tt>}</tt>*))
</pre></div>



<hr>
<span id="progn"></span><div class="header">
<p>
Next: <a href="#define_002dmodify_002dmacro" accesskey="n" rel="next">define-modify-macro</a>, Previous: <a href="#prog1_003b-prog2" accesskey="p" rel="prev">prog1; prog2</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">progn</h4>
<span id="progn-_0028Special-Operator_0029"></span><h3 class="heading">progn (Special Operator)</h3>
<span id="index-progn-3"></span>
<span id="index-progn"></span>


<span id="Syntax_003a-87"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-progn-2">Special Form: <strong>progn</strong> <em><tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>

<span id="Arguments-and-Values_003a-77"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<p><var>results</var>&mdash;the <i>values</i> of the <i>forms</i>.
</p>
<span id="Description_003a-112"></span><h4 class="subsubheading">Description:</h4>

<p><code>progn</code> evaluates <var>forms</var>,
in the order in which they are given.
</p>
<p>The values of each <var>form</var> but the last are discarded.
</p>
<p>If <code>progn</code> appears as a <i>top level form</i>, then all <i>forms</i>
within that <code>progn</code> are considered by the compiler to be 
<i>top level forms</i>.
</p>
<span id="Examples_003a-85"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (progn) <span class="roman">→</span> NIL
 (progn 1 2 3) <span class="roman">→</span> 3
 (progn (values 1 2 3)) <span class="roman">→</span> 1, 2, 3
 (setq a 1) <span class="roman">→</span> 1
 (if a
      (progn (setq a nil) 'here)
      (progn (setq a t) 'there)) <span class="roman">→</span> HERE
 a <span class="roman">→</span> NIL
</pre></div>


<span id="See-Also_003a-96"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#prog1">prog1</a>, <a href="#prog2">prog2</a>, <a href="Evaluation-and-Compilation.html#Evaluation">Section 3.1 (Evaluation)</a>
</p>
<span id="Notes_003a-63"></span><h4 class="subsubheading">Notes:</h4>

<p>Many places in <span class="roman">Common Lisp</span>&nbsp;<!-- /@w -->involve syntax that uses <i>implicit progns</i>.
That is, part of their syntax allows many <i>forms</i> to be written
that are to be evaluated sequentially, discarding the results
of all <i>forms</i> but the last and returning the results of the last <i>form</i>.
Such places include, but are not limited to, the following:
the body of a <i>lambda expression</i>;
the bodies of various control and conditional <i>forms</i>
(<i>e.g.</i>, <code>case</code>, <code>catch</code>, <code>progn</code>, and <code>when</code>).
</p>

<hr>
<span id="define_002dmodify_002dmacro"></span><div class="header">
<p>
Next: <a href="#defsetf" accesskey="n" rel="next">defsetf</a>, Previous: <a href="#progn" accesskey="p" rel="prev">progn</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">define-modify-macro</h4>
<span id="define_002dmodify_002dmacro-_0028Macro_0029"></span><h3 class="heading">define-modify-macro (Macro)</h3>
<span id="index-define_002dmodify_002dmacro-2"></span>
<span id="index-define_002dmodify_002dmacro"></span>


<span id="Syntax_003a-88"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-define_002dmodify_002dmacro-1">Macro: <strong>define-modify-macro</strong> <em>name lambda-list function <tt>[</tt>documentation<tt>]</tt> <span class="roman">→</span> name</em></dt>
</dl>

<span id="Arguments-and-Values_003a-78"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>name</var>&mdash;a <i>symbol</i>.
</p>
<p><var>lambda-list</var>&mdash;a <i>define-modify-macro lambda list</i> 
</p>
<p><var>function</var>&mdash;a <i>symbol</i>.
</p>
<p><var>documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<span id="Description_003a-113"></span><h4 class="subsubheading">Description:</h4>

<p><code>define-modify-macro</code> defines a <i>macro</i> named
<var>name</var> to <i>read</i> and <i>write</i> a <i>place</i>.
</p>
<p>The arguments to the new <i>macro</i> are a <i>place</i>,
followed
by the arguments that are supplied in <var>lambda-list</var>.
<i>Macros</i> defined with <code>define-modify-macro</code> 
correctly pass the <i>environment parameter</i> to 
<code>get-setf-expansion</code>.
</p>
<p>When the <i>macro</i> is invoked, <var>function</var> 
is applied to the old contents of the <i>place</i>
and the <var>lambda-list</var> arguments to obtain the new value,
and the <i>place</i> is updated to contain the result.
</p>
<p>Except for the issue of avoiding multiple evaluation (see below), the expansion
of a <code>define-modify-macro</code> is equivalent to the following:
</p>
<div class="lisp">
<pre class="lisp"> (defmacro <var>name</var> (reference . <var>lambda-list</var>)
   <var>documentation</var>
   `(setf ,reference
          (<var>function</var> ,reference ,<i>arg1</i> ,<i>arg2</i> ...)))
</pre></div>


<p>where <i>arg1</i>, <i>arg2</i>, ..., 
are the parameters appearing in <var>lambda-list</var>;
appropriate provision is made for a <i>rest parameter</i>.
</p>
<p>The <i>subforms</i> of the macro calls defined by <code>define-modify-macro</code>
are evaluated as specified in <a href="#GenRefSubFormEval">Section 5.1.1.1 (Evaluation of Subforms to Places)</a>.
</p>
<p><var>Documentation</var> is attached as a <i>documentation string</i> 
to <var>name</var> (as kind <code>function</code>)
and to the <i>macro function</i>.
</p>
<p>If a <code>define-modify-macro</code> <i>form</i> appears as a <i>top level form</i>,
the <i>compiler</i> must store the <i>macro</i> definition at compile time,
so that occurrences of the macro later on in the file can be expanded correctly.
</p>
<span id="Examples_003a-86"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (define-modify-macro appendf (&amp;rest args) 
    append &quot;Append onto list&quot;) <span class="roman">→</span> APPENDF
 (setq x '(a b c) y x) <span class="roman">→</span> (A B C)
 (appendf x '(d e f) '(1 2 3)) <span class="roman">→</span> (A B C D E F 1 2 3)
 x <span class="roman">→</span> (A B C D E F 1 2 3)
 y <span class="roman">→</span> (A B C)
 (define-modify-macro new-incf (&amp;optional (delta 1)) +)
 (define-modify-macro unionf (other-set &amp;rest keywords) union)
</pre></div>


<span id="Side-Effects_003a-4"></span><h4 class="subsubheading">Side Effects:</h4>

<p>A macro definition is assigned to <var>name</var>.
</p>
<span id="See-Also_003a-97"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#defsetf">defsetf</a>,
<a href="#define_002dsetf_002dexpander">define-setf-expander</a>,
<a href="Environment.html#documentation">documentation</a>,
<a href="Evaluation-and-Compilation.html#Syntactic-Interaction-of-Documentation-Strings-and-Declarations">Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)</a>
</p>

<hr>
<span id="defsetf"></span><div class="header">
<p>
Next: <a href="#define_002dsetf_002dexpander" accesskey="n" rel="next">define-setf-expander</a>, Previous: <a href="#define_002dmodify_002dmacro" accesskey="p" rel="prev">define-modify-macro</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">defsetf</h4>
<span id="defsetf-_0028Macro_0029"></span><h3 class="heading">defsetf (Macro)</h3>
<span id="index-defsetf-3"></span>
<span id="index-defsetf"></span>



<span id="Syntax_003a-89"></span><h4 class="subsubheading">Syntax:</h4>

<p>The &ldquo;short form&rdquo;:
</p>
<dl>
<dt id="index-defsetf-1">Macro: <strong>defsetf</strong> <em>access-fn update-fn <tt>[</tt>documentation<tt>]</tt> <span class="roman">→</span> access-fn</em></dt>
</dl>

<p>The &ldquo;long form&rdquo;:
</p>
<dl>
<dt id="index-defsetf-2">Macro: <strong>defsetf</strong> <em>access-fn lambda-list <tt>(</tt><tt>{</tt>store-variable<tt>}</tt>*<tt>)</tt> 〚<tt>{</tt>declaration<tt>}</tt>* <span class="roman">|</span> documentation〛 <tt>{</tt>form<tt>}</tt>* <span class="roman">→</span> access-fn</em></dt>
</dl>

<span id="Arguments-and-Values_003a-79"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>access-fn</var>&mdash;a <i>symbol</i> which names a <i>function</i> or a <i>macro</i>.
</p>
<p><var>update-fn</var>&mdash;a <i>symbol</i> naming a <i>function</i> or <i>macro</i>.
</p>
<p><var>lambda-list</var>&mdash;a <i>defsetf lambda list</i>.
</p>
<p><var>store-variable</var>&mdash;a <i>symbol</i> (a <i>variable</i> <i>name</i>).
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<p><var>form</var>&mdash;a <i>form</i>.
</p>
<span id="Description_003a-114"></span><h4 class="subsubheading">Description:</h4>

<p><code>defsetf</code> defines how to 
<code>setf</code> a <i>place</i>
of the form <code>(<i>access-fn</i> ...)</code> for relatively simple cases.
(See <code>define-setf-expander</code> for more general access to this facility.)
It must be the case that the <i>function</i> or <i>macro</i> named by <var>access-fn</var> 
evaluates all of its arguments.
</p>
<p><code>defsetf</code> may take one of two forms, called the &ldquo;short form&rdquo; and the &ldquo;long form,&rdquo;
which are distinguished by the <i>type</i> of the second <i>argument</i>.
</p>
<p>When the short form is used, 
<var>update-fn</var> must name 
a <i>function</i> (or <i>macro</i>) that takes one more argument
than <var>access-fn</var> takes.  When <code>setf</code> is given a <i>place</i>
that is a call on <var>access-fn</var>, it expands into
a call on <var>update-fn</var> that is given all the arguments to
<var>access-fn</var> and also, as its last argument, the new value
(which must be returned by <var>update-fn</var> as its value).
</p>
<p>The long form <code>defsetf</code> 
resembles <code>defmacro</code>.
The <var>lambda-list</var> describes the arguments of <var>access-fn</var>. 
The <var>store-variables</var> describe the
value 
or values 
to be stored into the <i>place</i>.
The <var>body</var> must
compute the expansion of a <code>setf</code> of a call on <var>access-fn</var>.
The expansion function is defined in the same <i>lexical environment</i>
in which the <code>defsetf</code> <i>form</i> appears.
</p>
<p>During the evaluation of the
<var>forms</var>, the variables in the <var>lambda-list</var> and the
<var>store-variables</var>
are bound to names of temporary variables,
generated as if by <code>gensym</code>
or <code>gentemp</code>,
that will be bound by the
expansion of <code>setf</code> 
to the values of those <i>subforms</i>.  This binding
permits the
<var>forms</var> to be written without regard for order-of-evaluation
issues.  <code>defsetf</code> arranges for the temporary variables to be
optimized out of the final result in cases where that is possible.  
</p>
<p>The body code in <code>defsetf</code> is implicitly enclosed in a 
<i>block</i> whose name is 
<var>access-fn</var>
</p>
<p><code>defsetf</code> 
ensures that <i>subforms</i> 
of the <i>place</i> are evaluated exactly once.
</p>
<p><var>Documentation</var> is attached to <var>access-fn</var> as a <i>documentation string</i>
of kind <tt>setf</tt>.
</p>
<p>If a <code>defsetf</code> <i>form</i> appears as a <i>top level form</i>,
the <i>compiler</i> must make the <i>setf expander</i> available so that
it may be used to expand calls to <code>setf</code> later on in the <i>file</i>.
Users must ensure that the <var>forms</var>, if any, can be evaluated
at compile time if the <var>access-fn</var> is used in a <i>place</i>
later in the same <i>file</i>.
The <i>compiler</i> must make these <i>setf expanders</i> available to 
compile-time calls to <code>get-setf-expansion</code> when its <var>environment</var> 
argument is a value received as the <i>environment parameter</i> of a <i>macro</i>.
</p>
<span id="Examples_003a-87"></span><h4 class="subsubheading">Examples:</h4>
<p>The effect of
</p>
<div class="lisp">
<pre class="lisp"> (defsetf symbol-value set)
</pre></div>

<p>is built into the <span class="roman">Common Lisp</span>&nbsp;<!-- /@w -->system.
This causes the form <code>(setf (symbol-value foo) fu)</code>
to expand into <code>(set foo fu)</code>.
</p>
<p>Note that
</p>
<div class="lisp">
<pre class="lisp"> (defsetf car rplaca)
</pre></div>

<p>would be incorrect because <code>rplaca</code> does not return its last argument.
</p>
<div class="lisp">
<pre class="lisp"> (defun middleguy (x) (nth (truncate (1- (list-length x)) 2) x)) <span class="roman">→</span> MIDDLEGUY
 (defun set-middleguy (x v)
    (unless (null x)
      (rplaca (nthcdr (truncate (1- (list-length x)) 2) x) v))
    v) <span class="roman">→</span> SET-MIDDLEGUY
 (defsetf middleguy set-middleguy) <span class="roman">→</span> MIDDLEGUY
 (setq a (list 'a 'b 'c 'd)
       b (list 'x)
       c (list 1 2 3 (list 4 5 6) 7 8 9)) <span class="roman">→</span> (1 2 3 (4 5 6) 7 8 9)
 (setf (middleguy a) 3) <span class="roman">→</span> 3
 (setf (middleguy b) 7) <span class="roman">→</span> 7
 (setf (middleguy (middleguy c)) 'middleguy-symbol) <span class="roman">→</span> MIDDLEGUY-SYMBOL
 a <span class="roman">→</span> (A 3 C D)
 b <span class="roman">→</span> (7)
 c <span class="roman">→</span> (1 2 3 (4 MIDDLEGUY-SYMBOL 6) 7 8 9)
</pre></div>


<p>An example of the use of the long form of <code>defsetf</code>:
</p>
<div class="lisp">
<pre class="lisp"> (defsetf subseq (sequence start &amp;optional end) (new-sequence)
   `(progn (replace ,sequence ,new-sequence
                    :start1 ,start :end1 ,end)
           ,new-sequence)) <span class="roman">→</span> SUBSEQ
</pre></div>


<div class="lisp">
<pre class="lisp"> (defvar *xy* (make-array '(10 10)))
 (defun xy (&amp;key ((x x) 0) ((y y) 0)) (aref *xy* x y)) <span class="roman">→</span> XY
 (defun set-xy (new-value &amp;key ((x x) 0) ((y y) 0))
   (setf (aref *xy* x y) new-value)) <span class="roman">→</span> SET-XY
 (defsetf xy (&amp;key ((x x) 0) ((y y) 0)) (store)
   `(set-xy ,store 'x ,x 'y ,y)) <span class="roman">→</span> XY
 (get-setf-expansion '(xy a b))
<span class="roman">→</span> (#:t0 #:t1),
   (a b),
   (#:store),
   ((lambda (&amp;key ((x #:x)) ((y #:y))) 
      (set-xy #:store 'x #:x 'y #:y))
    #:t0 #:t1),
   (xy #:t0 #:t1)
 (xy 'x 1) <span class="roman">→</span> NIL
 (setf (xy 'x 1) 1) <span class="roman">→</span> 1
 (xy 'x 1) <span class="roman">→</span> 1
 (let ((a 'x) (b 'y))
   (setf (xy a 1 b 2) 3)
   (setf (xy b 5 a 9) 14))
<span class="roman">→</span> 14
 (xy 'y 0 'x 1) <span class="roman">→</span> 1
 (xy 'x 1 'y 2) <span class="roman">→</span> 3
</pre></div>


<span id="See-Also_003a-98"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Environment.html#documentation">documentation</a>,
<a href="#setf">setf</a>,
<a href="#define_002dsetf_002dexpander">define-setf-expander</a>,
<a href="#get_002dsetf_002dexpansion">get-setf-expansion</a>,
<a href="#Generalized-Reference">Section 5.1 (Generalized Reference)</a>,
<a href="Evaluation-and-Compilation.html#Syntactic-Interaction-of-Documentation-Strings-and-Declarations">Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)</a>
</p>
<span id="Notes_003a-64"></span><h4 class="subsubheading">Notes:</h4>

<p><var>forms</var> must include provision
for returning the correct value (the value 
or values 
of <var>store-variable</var>).  
This is
handled by <var>forms</var> rather than by <code>defsetf</code> because
in many cases this value can be returned at no extra cost, by calling a
function that simultaneously stores into the <i>place</i> and 
returns the correct value.
</p>
<p>A <code>setf</code> of a call on <var>access-fn</var> also evaluates
all of <var>access-fn</var>&rsquo;s arguments; it cannot treat any of them specially.
This means that <code>defsetf</code> 
cannot be used to describe how to store into
a <i>generalized reference</i> to a byte, such as <code>(ldb field reference)</code>.
<code>define-setf-expander</code>
is used to handle situations that 
do not fit the restrictions imposed by <code>defsetf</code>
and gives the user additional control.
</p>


<hr>
<span id="define_002dsetf_002dexpander"></span><div class="header">
<p>
Next: <a href="#get_002dsetf_002dexpansion" accesskey="n" rel="next">get-setf-expansion</a>, Previous: <a href="#defsetf" accesskey="p" rel="prev">defsetf</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">define-setf-expander</h4>
<span id="define_002dsetf_002dexpander-_0028Macro_0029"></span><h3 class="heading">define-setf-expander (Macro)</h3>
<span id="index-define_002dsetf_002dexpander-2"></span>
<span id="index-define_002dsetf_002dexpander"></span>



<span id="Syntax_003a-90"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-define_002dsetf_002dexpander-1">Macro: <strong>define-setf-expander</strong> <em><span class="nolinebreak">access-fn</span>&nbsp;<span class="nolinebreak">lambda-list</span><!-- /@w --> 〚<tt>{</tt>declaration<tt>}</tt>*&nbsp;<span class="roman">|</span>&nbsp;documentation〛&nbsp;<tt>{</tt>form<tt>}</tt>*<!-- /@w --> <span class="roman">→</span> access-fn</em></dt>
</dl>

<span id="Arguments-and-Values_003a-80"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>access-fn</var>&mdash;a <i>symbol</i> that <i>names</i> a <i>function</i> or <i>macro</i>.
</p>
<p><var>lambda-list</var>&mdash;<i>macro lambda list</i>.
</p>
<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<p><var>forms</var>&mdash;an <i>implicit progn</i>.
</p>
<span id="Description_003a-115"></span><h4 class="subsubheading">Description:</h4>

<p><code>define-setf-expander</code> specifies the means by which <code>setf</code> 
updates a <i>place</i> that is referenced by <var>access-fn</var>.
</p>
<p>When <code>setf</code> is given a <i>place</i> that is
specified in terms of <var>access-fn</var> and a new value for the 
<i>place</i>, it is expanded into a form that performs
the appropriate update. 
</p>
<p>The <var>lambda-list</var> supports destructuring.
See <a href="Evaluation-and-Compilation.html#Macro-Lambda-Lists">Section 3.4.4 (Macro Lambda Lists)</a>.
</p>
<p><var>Documentation</var> is attached to <var>access-fn</var> as a <i>documentation string</i>
of kind <tt>setf</tt>.
</p>
<p><var>Forms</var> constitute the body of the 
<i>setf expander</i> 
definition and must compute the <i>setf expansion</i> for a call on <code>setf</code> 
that references the <i>place</i> by means of the given
<var>access-fn</var>.
The <i>setf expander</i> function is defined in the same <i>lexical environment</i>
in which the <code>define-setf-expander</code> <i>form</i> appears.
While <var>forms</var> are being executed,
the variables in <var>lambda-list</var> are bound to parts of the <i>place</i> <i>form</i>.
The body <var>forms</var> (but not the <var>lambda-list</var>)
in a <code>define-setf-expander</code> <i>form</i> are implicitly enclosed in a 
<i>block</i> whose name is 
<var>access-fn</var>.
</p>
<p>The evaluation of <var>forms</var> must result in the five values
described in <a href="#SetfExpansions">Section 5.1.1.2 (Setf Expansions)</a>.
</p>
<p>If a <code>define-setf-expander</code> <i>form</i> appears as a <i>top level form</i>,
the <i>compiler</i> must make the <i>setf expander</i> available so that
it may be used to expand calls to <code>setf</code> later on in the <i>file</i>.
<i>Programmers</i> must ensure that the <var>forms</var> can be evaluated
at compile time if the <var>access-fn</var> is used in a <i>place</i>
later in the same <i>file</i>.
The <i>compiler</i> must make these <i>setf expanders</i> available to 
compile-time calls to <code>get-setf-expansion</code> when its <var>environment</var> 
argument is a value received as the <i>environment parameter</i> of a <i>macro</i>.
</p>
<span id="Examples_003a-88"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (defun lastguy (x) (car (last x))) <span class="roman">→</span> LASTGUY
 (define-setf-expander lastguy (x &amp;environment env)
   &quot;Set the last element in a list to the given value.&quot;
   (multiple-value-bind (dummies vals newval setter getter)
       (get-setf-expansion x env)
     (let ((store (gensym)))
       (values dummies
               vals
               `(,store)
               `(progn (rplaca (last ,getter) ,store) ,store)
               `(lastguy ,getter))))) <span class="roman">→</span> LASTGUY
 (setq a (list 'a 'b 'c 'd)
       b (list 'x)
       c (list 1 2 3 (list 4 5 6))) <span class="roman">→</span> (1 2 3 (4 5 6))
 (setf (lastguy a) 3) <span class="roman">→</span> 3
 (setf (lastguy b) 7) <span class="roman">→</span> 7
 (setf (lastguy (lastguy c)) 'lastguy-symbol) <span class="roman">→</span> LASTGUY-SYMBOL
 a <span class="roman">→</span> (A B C 3)
 b <span class="roman">→</span> (7)
 c <span class="roman">→</span> (1 2 3 (4 5 LASTGUY-SYMBOL))
</pre></div>


<div class="lisp">
<pre class="lisp">;;; Setf expander for the form (LDB bytespec int).
;;; Recall that the int form must itself be suitable for SETF.
 (define-setf-expander ldb (bytespec int &amp;environment env)
   (multiple-value-bind (temps vals stores
                          store-form access-form)
       (get-setf-expansion int env);Get setf expansion for int.
     (let ((btemp (gensym))     ;Temp var for byte specifier.
           (store (gensym))     ;Temp var for byte to store.
           (stemp (first stores))) ;Temp var for int to store.
       (if (cdr stores) (error &quot;Can't expand this.&quot;))
;;; Return the setf expansion for LDB as five values.
       (values (cons btemp temps)       ;Temporary variables.
               (cons bytespec vals)     ;Value forms.
               (list store)             ;Store variables.
               `(let ((,stemp (dpb ,store ,btemp ,access-form)))
                  ,store-form
                  ,store)               ;Storing form.
               `(ldb ,btemp ,access-form) ;Accessing form.
              ))))
</pre></div>


<span id="See-Also_003a-99"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#setf">setf</a>,
<a href="#defsetf">defsetf</a>,
<a href="Environment.html#documentation">documentation</a>,
<a href="#get_002dsetf_002dexpansion">get-setf-expansion</a>,
<a href="Evaluation-and-Compilation.html#Syntactic-Interaction-of-Documentation-Strings-and-Declarations">Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)</a>
</p>
<span id="Notes_003a-65"></span><h4 class="subsubheading">Notes:</h4>

<p><code>define-setf-expander</code> differs from the long form of <code>defsetf</code>
in that while the body is being executed the <i>variables</i>
in <var>lambda-list</var> are bound to parts of the <i>place</i> <i>form</i>,
not to temporary variables that will be bound to the values of such parts.
In addition, <code>define-setf-expander</code> does not have <code>defsetf</code>&rsquo;s
restriction that <var>access-fn</var> must be a <i>function</i> 
or a function-like <i>macro</i>; an arbitrary <code>defmacro</code> destructuring
pattern is permitted in <var>lambda-list</var>.
</p>


<hr>
<span id="get_002dsetf_002dexpansion"></span><div class="header">
<p>
Next: <a href="#setf_003b-psetf" accesskey="n" rel="next">setf; psetf</a>, Previous: <a href="#define_002dsetf_002dexpander" accesskey="p" rel="prev">define-setf-expander</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">get-setf-expansion</h4>
<span id="get_002dsetf_002dexpansion-_0028Function_0029"></span><h3 class="heading">get-setf-expansion (Function)</h3>
<span id="index-get_002dsetf_002dexpansion-2"></span>
<span id="index-get_002dsetf_002dexpansion"></span>



<span id="Syntax_003a-91"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-get_002dsetf_002dexpansion-1">Function: <strong>get-setf-expansion</strong> <em>place <tt>&amp;optional</tt> environment <span class="roman">→</span> vars, vals, store-vars, writer-form, reader-form</em></dt>
</dl>

<span id="Arguments-and-Values_003a-81"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>place</var>&mdash;a <i>place</i>.
</p>
<p><var>environment</var>&mdash;an <i>environment</i> <i>object</i>.
</p>
<p><var>vars, vals, store-vars, writer-form, reader-form</var>&mdash;a <i>setf expansion</i>.
</p>
<span id="Description_003a-116"></span><h4 class="subsubheading">Description:</h4>

<p>Determines
five values constituting the <i>setf expansion</i> for <var>place</var>
in <var>environment</var>; see <a href="#SetfExpansions">Section 5.1.1.2 (Setf Expansions)</a>.
</p>


<p>If <var>environment</var> is not supplied or <code>nil</code>,
the environment is the <i>null lexical environment</i>. 
</p>
<span id="Examples_003a-89"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (get-setf-expansion 'x)
<span class="roman">→</span> NIL, NIL, (#:G0001), (SETQ X #:G0001), X 
</pre></div>


<div class="lisp">
<pre class="lisp">;;; This macro is like POP 

 (defmacro xpop (place &amp;environment env)
   (multiple-value-bind (dummies vals new setter getter)
                        (get-setf-expansion place env)
      `(let* (,@(mapcar #'list dummies vals) (,(car new) ,getter))
         (if (cdr new) (error &quot;Can't expand this.&quot;))
         (prog1 (car ,(car new))
                (setq ,(car new) (cdr ,(car new)))
                ,setter))))
 
 (defsetf frob (x) (value) 
     `(setf (car ,x) ,value)) <span class="roman">→</span> FROB
;;; The following is an error; an error might be signaled at macro expansion time
 (flet ((frob (x) (cdr x)))  ;Invalid
   (xpop (frob z)))
 
</pre></div>




<span id="See-Also_003a-100"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#defsetf">defsetf</a>,
<a href="#define_002dsetf_002dexpander">define-setf-expander</a>,
<a href="#setf">setf</a>
</p>
<span id="Notes_003a-66"></span><h4 class="subsubheading">Notes:</h4>

<p>Any <i>compound form</i> is a valid <i>place</i>,
since any <i>compound form</i> whose <i>operator</i> <var>f</var> has no <i>setf expander</i>
are expanded into a call to <code>(setf <var>f</var>)</code>.
</p>


<hr>
<span id="setf_003b-psetf"></span><div class="header">
<p>
Next: <a href="#shiftf" accesskey="n" rel="next">shiftf</a>, Previous: <a href="#get_002dsetf_002dexpansion" accesskey="p" rel="prev">get-setf-expansion</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">setf; psetf</h4>
<span id="setf_002c-psetf-_0028Macro_0029"></span><h3 class="heading">setf, psetf (Macro)</h3>
<span id="index-setf-2"></span>
<span id="index-setf"></span>
<span id="index-psetf-2"></span>
<span id="index-psetf"></span>
<span id="setf"></span><span id="psetf"></span>

<span id="Syntax_003a-92"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-setf-1">Macro: <strong>setf</strong> <em><tt>{</tt><tt>↓</tt>pair<tt>}</tt>* <span class="roman">→</span> <tt>{</tt>result<tt>}</tt>*</em></dt>
</dl>
<dl>
<dt id="index-psetf-1">Macro: <strong>psetf</strong> <em><tt>{</tt><tt>↓</tt>pair<tt>}</tt>* <span class="roman">→</span> <code>nil</code></em></dt>
</dl>

<dl compact="compact">
<dt><var>pair</var>::=</dt>
<dd><p>place newvalue
</p></dd>
</dl>

<span id="Arguments-and-Values_003a-82"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>place</var>&mdash;a <i>place</i>.
</p>
<p><var>newvalue</var>&mdash;a <i>form</i>.
</p>
<p><var>results</var>&mdash;the <i>multiple values</i><sub>2</sub>
returned by the storing form for the last <var>place</var>,
or <code>nil</code>&nbsp;<!-- /@w -->if there are no <var>pairs</var>.
</p>
<span id="Description_003a-117"></span><h4 class="subsubheading">Description:</h4>

<p><code>setf</code> changes the <i>value</i> of <var>place</var> to be <var>newvalue</var>.
</p>
<p><code>(setf place newvalue)</code> 
expands into an update form that stores the 
result 
of evaluating
<var>newvalue</var> into the location referred to by <var>place</var>.
Some <var>place</var> forms 
involve uses of accessors that take optional arguments. 
Whether those optional arguments are permitted by 
<code>setf</code>, or what their use
is, is up to the 
<code>setf</code> expander function and is not under the control
of <code>setf</code>. 
The documentation for any <i>function</i> 
that accepts <code>&amp;optional</code>, <code>&amp;rest</code>,
or <code>&amp;key</code> arguments and that 
claims to be usable with <code>setf</code> must specify
how those arguments are treated.
</p>

<p>If more than one <var>pair</var> is supplied,
the <var>pairs</var> are processed sequentially; that is,
</p>
<div class="lisp">
<pre class="lisp"> (setf place-1 newvalue-1
       place-2 newvalue-2
       ...
       place-N newvalue-N)
</pre></div>

<p>is precisely equivalent to
</p>
<div class="lisp">
<pre class="lisp"> (progn (setf place-1 newvalue-1)
        (setf place-2 newvalue-2)
        ...
        (setf place-N newvalue-N))
</pre></div>

<p>For <code>psetf</code>, 
if more than one <var>pair</var> is supplied then the assignments of new values to places are
done in parallel.  More precisely, all <i>subforms</i> (in both the <var>place</var>
and <var>newvalue</var> <i>forms</i>) that are to be evaluated
are evaluated from left to right; after all evaluations have been performed,
all of the assignments are performed in an unpredictable order.
</p>
<p>For detailed treatment of the expansion of <code>setf</code> and <code>psetf</code>,
see <a href="#Kinds-of-Places">Section 5.1.2 (Kinds of Places)</a>.
</p>
<span id="Examples_003a-90"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (setq x (cons 'a 'b) y (list 1 2 3)) <span class="roman">→</span> (1 2 3) 
 (setf (car x) 'x (cadr y) (car x) (cdr x) y) <span class="roman">→</span> (1 X 3) 
 x <span class="roman">→</span> (X 1 X 3) 
 y <span class="roman">→</span> (1 X 3) 
 (setq x (cons 'a 'b) y (list 1 2 3)) <span class="roman">→</span> (1 2 3) 
 (psetf (car x) 'x (cadr y) (car x) (cdr x) y) <span class="roman">→</span> NIL 
 x <span class="roman">→</span> (X 1 A 3) 
 y <span class="roman">→</span> (1 A 3) 
</pre></div>


<span id="Affected-By_003a-7"></span><h4 class="subsubheading">Affected By:</h4>

<p><code>define-setf-expander</code>,
<code>defsetf</code>,
<code>*macroexpand-hook*</code>
</p>
<span id="See-Also_003a-101"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#define_002dsetf_002dexpander">define-setf-expander</a>,
<a href="#defsetf">defsetf</a>,
<a href="Evaluation-and-Compilation.html#macroexpand_002d1">macroexpand-1</a>,
<a href="#rotatef">rotatef</a>,
<a href="#shiftf">shiftf</a>,
<a href="#Generalized-Reference">Section 5.1 (Generalized Reference)</a>
</p>

<hr>
<span id="shiftf"></span><div class="header">
<p>
Next: <a href="#rotatef" accesskey="n" rel="next">rotatef</a>, Previous: <a href="#setf_003b-psetf" accesskey="p" rel="prev">setf; psetf</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">shiftf</h4>
<span id="shiftf-_0028Macro_0029"></span><h3 class="heading">shiftf (Macro)</h3>
<span id="index-shiftf-2"></span>
<span id="index-shiftf"></span>


<span id="Syntax_003a-93"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-shiftf-1">Macro: <strong>shiftf</strong> <em><tt>{</tt><var>place</var><tt>}</tt>+ newvalue <span class="roman">→</span> old-value-1</em></dt>
</dl>

<span id="Arguments-and-Values_003a-83"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>place</var>&mdash;a <i>place</i>.
</p>
<p><var>newvalue</var>&mdash;a <i>form</i>; evaluated.
</p>
<p><var>old-value-1</var>&mdash;an <i>object</i> (the old <i>value</i> of the first <var>place</var>).
</p>
<span id="Description_003a-118"></span><h4 class="subsubheading">Description:</h4>

<p><code>shiftf</code> modifies the values of each
<var>place</var> by storing <var>newvalue</var>
into the last <var>place</var>, and shifting the 
values of the second through the last <var>place</var>
into the remaining <var>places</var>.
</p>
<p>If <var>newvalue</var> produces more values than there
are store variables, the extra values are ignored. If <var>newvalue</var>
produces fewer values than there are store variables, the missing values
are set to <code>nil</code>.
</p>
<p>In the form <code>(shiftf <i>place1</i> <i>place2</i> ... <i>placen</i> <i>newvalue</i>)</code>, 
the values in <i>place1</i> through <i>placen</i> are <i>read</i> and saved,
and <i>newvalue</i> is evaluated, for a total of <code>n</code>+1 values in all.
Values 2 through <code>n</code>+1 are then stored into <i>place1</i> through <i>placen</i>, respectively.
It is as if all the <var>places</var> form a shift register; the <var>newvalue</var>
is shifted in from the right, all values shift over to the left one place,
and the value shifted out of <i>place1</i> is returned. 
</p>
<p>For information about the <i>evaluation</i> of <i>subforms</i> of <var>places</var>,
see <a href="#GenRefSubFormEval">Section 5.1.1.1 (Evaluation of Subforms to Places)</a>.  
</p>
<span id="Examples_003a-91"></span><h4 class="subsubheading">Examples:</h4>

<div class="lisp">
<pre class="lisp"> (setq x (list 1 2 3) y 'trash) <span class="roman">→</span> TRASH
 (shiftf y x (cdr x) '(hi there)) <span class="roman">→</span> TRASH
 x <span class="roman">→</span> (2 3)
 y <span class="roman">→</span> (1 HI THERE)

 (setq x (list 'a 'b 'c)) <span class="roman">→</span> (A B C)
 (shiftf (cadr x) 'z) <span class="roman">→</span> B
 x <span class="roman">→</span> (A Z C)
 (shiftf (cadr x) (cddr x) 'q) <span class="roman">→</span> Z
 x <span class="roman">→</span> (A (C) . Q)
 (setq n 0) <span class="roman">→</span> 0
 (setq x (list 'a 'b 'c 'd)) <span class="roman">→</span> (A B C D)
 (shiftf (nth (setq n (+ n 1)) x) 'z) <span class="roman">→</span> B
 x <span class="roman">→</span> (A Z C D)
</pre></div>


<span id="Affected-By_003a-8"></span><h4 class="subsubheading">Affected By:</h4>

<p><code>define-setf-expander</code>,
<code>defsetf</code>,
<code>*macroexpand-hook*</code>
</p>
<span id="See-Also_003a-102"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#setf">setf</a>, <a href="#rotatef">rotatef</a>, <a href="#Generalized-Reference">Section 5.1 (Generalized Reference)</a>
</p>
<span id="Notes_003a-67"></span><h4 class="subsubheading">Notes:</h4>

<p>The effect of
<code>(shiftf <var>place1</var> <var>place2</var> ... <var>placen</var> <var>newvalue</var>)</code>
is roughly equivalent to
</p>
<div class="lisp">
<pre class="lisp"> (let ((var1 <var>place1</var>)
       (var2 <var>place2</var>)
       ...
       (varn <var>placen</var>)
       (var0 <var>newvalue</var>))
   (setf <var>place1</var> var2)
   (setf <var>place2</var> var3)
   ...
   (setf <var>placen</var> var0)
   var1)
</pre></div>

<p>except that the latter would evaluate any <i>subforms</i> 
of each <code>place</code> twice, whereas <code>shiftf</code> evaluates them once.
For example, 
</p>
<div class="lisp">
<pre class="lisp"> (setq n 0) <span class="roman">→</span> 0
 (setq x (list 'a 'b 'c 'd)) <span class="roman">→</span> (A B C D)
 (prog1 (nth (setq n (+ n 1)) x)
        (setf (nth (setq n (+ n 1)) x) 'z)) <span class="roman">→</span> B
 x <span class="roman">→</span> (A B Z D)
</pre></div>



<hr>
<span id="rotatef"></span><div class="header">
<p>
Next: <a href="#control_002derror" accesskey="n" rel="next">control-error</a>, Previous: <a href="#shiftf" accesskey="p" rel="prev">shiftf</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">rotatef</h4>
<span id="rotatef-_0028Macro_0029"></span><h3 class="heading">rotatef (Macro)</h3>
<span id="index-rotatef-2"></span>
<span id="index-rotatef"></span>


<span id="Syntax_003a-94"></span><h4 class="subsubheading">Syntax:</h4>

<dl>
<dt id="index-rotatef-1">Macro: <strong>rotatef</strong> <em><tt>{</tt>place<tt>}</tt>* <span class="roman">→</span> <code>nil</code></em></dt>
</dl>

<span id="Arguments-and-Values_003a-84"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>place</var>&mdash;a <i>place</i>.
</p>
<span id="Description_003a-119"></span><h4 class="subsubheading">Description:</h4>

<p><code>rotatef</code> modifies the values of each <var>place</var> by
rotating values from one <var>place</var> into another.
</p>
<p>If a <var>place</var> produces more values than there
are store variables, the extra values are ignored. If a <var>place</var>
produces fewer values than there are store variables, the missing values
are set to <code>nil</code>.
</p>
<p>In the form <code>(rotatef <i>place1</i> <i>place2</i> ... <i>placen</i>)</code>, 
the values in <i>place1</i> through <i>placen</i> are <i>read</i> and <i>written</i>.
Values 2 through <i>n</i> 
and value 1 are then stored into <i>place1</i> through <i>placen</i>.
It is as if all the places form an end-around shift register
that is rotated one place to the left, with the value of <i>place1</i>
being shifted around the end to <i>placen</i>.
</p>
<p>For information about the <i>evaluation</i> of <i>subforms</i> of <var>places</var>,
see <a href="#GenRefSubFormEval">Section 5.1.1.1 (Evaluation of Subforms to Places)</a>.  
</p>
<span id="Examples_003a-92"></span><h4 class="subsubheading">Examples:</h4>
<div class="lisp">
<pre class="lisp"> (let ((n 0)
        (x (list 'a 'b 'c 'd 'e 'f 'g)))
    (rotatef (nth (incf n) x)
             (nth (incf n) x)
             (nth (incf n) x))
    x) <span class="roman">→</span> (A C D B E F G)
</pre></div>


<span id="See-Also_003a-103"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="#define_002dsetf_002dexpander">define-setf-expander</a>,
<a href="#defsetf">defsetf</a>,
<a href="#setf">setf</a>,
<a href="#shiftf">shiftf</a>,
<a href="Evaluation-and-Compilation.html#g_t_002amacroexpand_002dhook_002a">*macroexpand-hook*</a>,
<a href="#Generalized-Reference">Section 5.1 (Generalized Reference)</a>
</p>
<span id="Notes_003a-68"></span><h4 class="subsubheading">Notes:</h4>

<p>The effect of
<code>(rotatef <var>place1</var> <var>place2</var> ... <var>placen</var>)</code>
is roughly equivalent to
</p>
<div class="lisp">
<pre class="lisp"> (psetf <var>place1</var> <var>place2</var>
        <var>place2</var> <var>place3</var>
        ...
        <var>placen</var> <var>place1</var>)
</pre></div>

<p>except that the latter would evaluate any <i>subforms</i>
of each <code>place</code> twice, whereas <code>rotatef</code> evaluates them once.
</p>

<hr>
<span id="control_002derror"></span><div class="header">
<p>
Next: <a href="#program_002derror" accesskey="n" rel="next">program-error</a>, Previous: <a href="#rotatef" accesskey="p" rel="prev">rotatef</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">control-error</h4>
<span id="control_002derror-_0028Condition-Type_0029"></span><h3 class="heading">control-error (Condition Type)</h3>
<span id="index-control_002derror-1"></span>
<span id="index-control_002derror"></span>


<span id="Class-Precedence-List_003a-15"></span><h4 class="subsubheading">Class Precedence List:</h4>
<p><code>control-error</code>,
<code>error</code>,
<code>serious-condition</code>,
<code>condition</code>,
<code>t</code>
</p>
<span id="Description_003a-120"></span><h4 class="subsubheading">Description:</h4>

<p>The <i>type</i> <code>control-error</code> consists of error conditions that result from
invalid dynamic transfers of control in a program.  The errors that
result from giving <code>throw</code> a tag that is not active or from
giving <code>go</code> or <code>return-from</code> a tag that is no longer
dynamically available are of <i>type</i> <code>control-error</code>.
</p>

<hr>
<span id="program_002derror"></span><div class="header">
<p>
Next: <a href="#undefined_002dfunction" accesskey="n" rel="next">undefined-function</a>, Previous: <a href="#control_002derror" accesskey="p" rel="prev">control-error</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">program-error</h4>
<span id="program_002derror-_0028Condition-Type_0029"></span><h3 class="heading">program-error (Condition Type)</h3>
<span id="index-program_002derror-1"></span>
<span id="index-program_002derror"></span>


<span id="Class-Precedence-List_003a-16"></span><h4 class="subsubheading">Class Precedence List:</h4>
<p><code>program-error</code>,
<code>error</code>,
<code>serious-condition</code>,
<code>condition</code>,
<code>t</code>
</p>
<span id="Description_003a-121"></span><h4 class="subsubheading">Description:</h4>

<p>The <i>type</i> <code>program-error</code>
consists of error conditions related to incorrect program syntax.  The
errors that result from naming a <i>go tag</i> or a <i>block tag</i>
that is not lexically apparent are of <i>type</i> <code>program-error</code>.
</p>

<hr>
<span id="undefined_002dfunction"></span><div class="header">
<p>
Previous: <a href="#program_002derror" accesskey="p" rel="prev">program-error</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">undefined-function</h4>
<span id="undefined_002dfunction-_0028Condition-Type_0029"></span><h3 class="heading">undefined-function (Condition Type)</h3>
<span id="index-undefined_002dfunction-1"></span>
<span id="index-undefined_002dfunction"></span>


<span id="Class-Precedence-List_003a-17"></span><h4 class="subsubheading">Class Precedence List:</h4>
<p><code>undefined-function</code>,
<code>cell-error</code>,
<code>error</code>,
<code>serious-condition</code>,
<code>condition</code>,
<code>t</code>
</p>
<span id="Description_003a-122"></span><h4 class="subsubheading">Description:</h4>

<p>The <i>type</i> <code>undefined-function</code> consists of <i>error</i> <i>conditions</i>
that represent attempts to <i>read</i> the definition of an <i>undefined function</i>.
</p>
<p>The name of the cell (see <code>cell-error</code>) is the <i>function name</i>
which was <i>funbound</i>.
</p>
<span id="See-Also_003a-104"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="Conditions.html#cell_002derror_002dname">cell-error-name</a>
</p>



<hr>
<div class="header">
<p>
Previous: <a href="#program_002derror" accesskey="p" rel="prev">program-error</a>, Up: <a href="#Data-and-Control-Flow" accesskey="u" rel="up">Data and Control Flow</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
