<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>defmethod (ANSI Common Lisp)</title>

<meta name="description" content="defmethod (ANSI Common Lisp)">
<meta name="keywords" content="defmethod (ANSI Common Lisp)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="Table-of-Contents.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Objects.html" rel="up" title="Objects">
<link href="find_002dclass.html" rel="next" title="find-class">
<link href="defgeneric.html" rel="prev" title="defgeneric">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
body {font-family: century schoolbook, serif;
      line-height: 1.3;
      padding-left: 5em; padding-right: 1em;
      padding-bottom: 1em; max-width: 60em;}
table {border-collapse: collapse}
span.roman { font-family: century schoolbook, serif; font-weight: normal; }
h1, h2, h3, h4, h5, h6 {font-family:  Helvetica, sans-serif}
dfn {font-family: inherit; font-variant: italic; font-weight: bolder }
kbd {font-family: monospace; text-decoration: underline}
var {font-family: Helvetica, sans-serif; font-variant: slanted}
td  {padding-right: 1em; padding-left: 1em}
sub {font-size: smaller}
.node {padding: 0; margin: 0}

-->
</style>


</head>

<body lang="en">
<span id="defmethod"></span><div class="header">
<p>
Next: <a href="find_002dclass.html" accesskey="n" rel="next">find-class</a>, Previous: <a href="defgeneric.html" accesskey="p" rel="prev">defgeneric</a>, Up: <a href="Objects.html" accesskey="u" rel="up">Objects</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="node-heading">defmethod</h4>
<span id="defmethod-_0028Macro_0029"></span><h3 class="heading">defmethod (Macro)</h3>
<span id="index-defmethod-2"></span>
<span id="index-defmethod"></span>



<span id="Syntax_003a-126"></span><h4 class="subsubheading">Syntax:</h4>


<dl>
<dt id="index-defmethod-1">Macro: <strong>defmethod</strong> <em><i><span class="nolinebreak">function-name</span></i>&nbsp;<tt>{</tt><i><span class="nolinebreak">method-qualifier</span></i><tt>}</tt>*&nbsp;<i><span class="nolinebreak">specialized-lambda-list</span></i><!-- /@w --> 〚<tt>{</tt>declaration<tt>}</tt>*&nbsp;<span class="roman">|</span>&nbsp;documentation〛&nbsp;<tt>{</tt>form<tt>}</tt>*<!-- /@w --> <span class="roman">→</span> new-method</em></dt>
</dl>

<dl compact="compact">
<dt><i>function-name::= <tt>{</tt><i>symbol</i> | <tt>(setf <i>symbol</i>)</tt><tt>}</tt></i></dt>
<dt><i>method-qualifier::= <tt><i>non-list</i></tt></i></dt>
<dt><i>specialized-lambda-list::=</i></dt>
<dd><p>(<tt>{</tt>var | (var <i>parameter-specializer-name</i>)<tt>}</tt>*<br>
                               [<tt>&amp;optional</tt> {var | (var [initform [supplied-p-parameter]])}*]
                               <tt>[</tt><tt>&amp;rest</tt> var<tt>]</tt><br>
                               [<tt>&amp;key</tt> { var | (var [initfom [supplied-p-parameter]])}*<br>
                                      [<code>&amp;allow-other-keys</code>]]<br>
                               [<tt>&amp;aux</tt> {var |<br>
                               (var [initform])}*])
</p>
</dd>
<dt><i>parameter-specializer-name::=</i></dt>
<dd><p><i>symbol</i> | (<tt>eql</tt> eql-specializer-form)
</p></dd>
</dl>
<span id="Arguments-and-Values_003a-115"></span><h4 class="subsubheading">Arguments and Values:</h4>

<p><var>declaration</var>&mdash;a <tt>declare</tt> <i>expression</i>; not evaluated.
</p>
<p><var>documentation</var>&mdash;a <i>string</i>; not evaluated.
</p>
<p><var>var</var>&mdash;a <i>variable</i> <i>name</i>.
</p>
<p><var>eql-specializer-form</var>&mdash;a <i>form</i>.
</p>
<p><var>Form</var>&mdash;a <i>form</i>.
</p>
<p><var>Initform</var>&mdash;a <i>form</i>.
</p>
<p><var>Supplied-p-parameter</var>&mdash;variable name. 
</p>
<p><var>new-method</var>&mdash;the new <i>method</i> <i>object</i>.
</p>
<span id="Description_003a-154"></span><h4 class="subsubheading">Description:</h4>

<p>The macro <code>defmethod</code> defines a <i>method</i> on a 
<i>generic function</i>.  
</p>
<p>If <code>(fboundp <i>function-name</i>)</code> is <code>nil</code>, a 
<i>generic function</i> is created with default values for 
the argument precedence order
(each argument is more specific than the arguments to its right
in the argument list),
for the generic function class (the <i>class</i> <code>standard-generic-function</code>),
for the method class (the <i>class</i> <code>standard-method</code>),
and for the method combination type (the standard method combination type).
The <i>lambda list</i> of the <i>generic function</i> is
congruent with the <i>lambda list</i> of the 
<i>method</i> being defined; if the
<code>defmethod</code> form mentions keyword arguments, the <i>lambda list</i> of
the <i>generic function</i> 
will mention <code>&amp;key</code> (but no keyword
arguments).  If <i>function-name</i> names 
an <i>ordinary function</i>,
a <i>macro</i>, or a <i>special operator</i>, 
an error is signaled.
</p>
<p>If a <i>generic function</i> is currently named by <i>function-name,</i>
the <i>lambda list</i> of the
<i>method</i> must be congruent with the <i>lambda list</i> of the 
<i>generic function</i>.
If this condition does not hold, an error is signaled.  
For a definition of congruence in this context, see <a href="Congruent-Lambda_002dlists-for-all-Methods-of-a-Generic-Function.html">Section 7.6.4 (Congruent Lambda-lists for all Methods of a Generic Function)</a>.
</p>

<p>Each <i>method-qualifier</i> argument is an <i>object</i> that is used by
method combination to identify the given <i>method</i>.  
The method combination type might further
restrict what a method <i>qualifier</i> can be.
The standard method combination type allows for <i>unqualified methods</i> and
<i>methods</i> whose sole
<i>qualifier</i> is one of the keywords <tt>:before</tt>, <tt>:after</tt>, or <tt>:around</tt>.
</p>
<p>The <i>specialized-lambda-list</i> argument is like an ordinary
<i>lambda list</i> except that the <i>names</i> of required parameters can
be replaced by specialized parameters.  A specialized parameter is a
list of the form 
<code>(<var>var</var> <i>parameter-specializer-name</i>)</code>.
Only required parameters can be
specialized.  If <i>parameter-specializer-name</i> is a <i>symbol</i> it names a
<i>class</i>; if it is a <i>list</i>,
it is of the form <code>(eql <var>eql-specializer-form</var>)</code>.  The parameter
specializer name <code>(eql <var>eql-specializer-form</var>)</code> indicates
that the corresponding argument must be <code>eql</code> to the <i>object</i> that
is the value of <var>eql-specializer-form</var> for the <i>method</i> to be applicable.  
The <var>eql-specializer-form</var> is evaluated at the time
that the expansion of the <code>defmethod</code> macro is evaluated.  
If no <i>parameter specializer name</i> is specified for a given
required parameter, the <i>parameter specializer</i> defaults to 
the <i>class</i> <code>t</code>.
For further discussion, see <a href="Introduction-to-Methods.html">Section 7.6.2 (Introduction to Methods)</a>.
</p>
<p>The <var>form</var> arguments specify the method body.
The body of the <i>method</i> is enclosed in an <i>implicit block</i>.  If
<i>function-name</i> is a <i>symbol</i>, 
this block bears the same <i>name</i> as the <i>generic function</i>.  
If <i>function-name</i> is a <i>list</i> of the form 
<code>(setf <i>symbol</i>)</code>, the <i>name</i> of the block is <i>symbol</i>.  
</p>
<p>The <i>class</i> of the <i>method</i> <i>object</i> that is created is that given by the 
method class option of the <i>generic function</i> 
on which the <i>method</i> is defined.
</p>
<p>If the <i>generic function</i> already has a <i>method</i> that agrees with the
<i>method</i> being defined on <i>parameter specializers</i> and <i>qualifiers</i>,
<code>defmethod</code> replaces the existing <i>method</i> with the one now being
defined.
For a definition of agreement in this context.
see <a href="Agreement-on-Parameter-Specializers-and-Qualifiers.html">Section 7.6.3 (Agreement on Parameter Specializers and Qualifiers)</a>.
</p>
<p>The <i>parameter specializers</i> are derived from 
the <i>parameter specializer names</i> as described in
<a href="Introduction-to-Methods.html">Section 7.6.2 (Introduction to Methods)</a>.
</p>
<p>The expansion of the <code>defmethod</code> macro &ldquo;refers to&rdquo; each
specialized parameter (see the description of <code>ignore</code> 
within the description of <tt>declare</tt>).
This includes parameters that
have an explicit <i>parameter specializer name</i> of <code>t</code>.  This means
that a compiler warning does not occur if the body of the <i>method</i> does
not refer to a specialized parameter, while a warning might occur
if the body of the <i>method</i> does not refer to an unspecialized parameter.
For this reason, a parameter that specializes on <code>t</code>&nbsp;<!-- /@w -->is not quite synonymous
with an unspecialized parameter in this context.
</p>
<p>Declarations at the head of the method body that apply to the 
method&rsquo;s <i>lambda variables</i> are treated as <i>bound declarations</i>
whose <i>scope</i> is the same as the corresponding <i>bindings</i>.
</p>
<p>Declarations at the head of the method body that apply to the 
functional bindings of <code>call-next-method</code> or <code>next-method-p</code>
apply to references to those functions within the method body <var>forms</var>.
Any outer <i>bindings</i> of the <i>function names</i> <code>call-next-method</code> and
<code>next-method-p</code>, and declarations associated with such <i>bindings</i>
are <i>shadowed</i><sub>2</sub>
</p>
<p>The <i>scope</i> of <i>free declarations</i> at the head of the method body 
is the entire method body, 
which includes any implicit local function definitions
but excludes <i>initialization forms</i> for the <i>lambda variables</i>.
</p>
<p><code>defmethod</code> is not required to perform any compile-time side effects.
In particular, the <i>methods</i> are not installed for invocation during 
compilation.  An <i>implementation</i> may choose to store information about
the <i>generic function</i> for the purposes of compile-time error-checking
(such as checking the number of arguments on calls, or noting that a definition
for the function name has been seen).
</p>
<p><var>Documentation</var> is attached as a <i>documentation string</i>
to the <i>method</i> <i>object</i>.
</p>
<span id="Affected-By_003a-14"></span><h4 class="subsubheading">Affected By:</h4>

<p>The definition of the referenced <i>generic function</i>.
</p>
<span id="Exceptional-Situations_003a-39"></span><h4 class="subsubheading">Exceptional Situations:</h4>

<p>If <i>function-name</i> names an <i>ordinary function</i>,
a <i>macro</i>, or a <i>special operator</i>, 
an error of <i>type</i> <code>error</code> is signaled.
</p>
<p>If a <i>generic function</i> is currently named by <i>function-name,</i>
the <i>lambda list</i> of the
<i>method</i> must be congruent with the <i>lambda list</i> of the 
<i>generic function</i>, or
an error of <i>type</i> <code>error</code> is signaled.
</p>

<span id="See-Also_003a-136"></span><h4 class="subsubheading">See Also:</h4>

<p><a href="defgeneric.html">defgeneric</a>, 
<a href="documentation_003b-setf-documentation.html#documentation">documentation</a>,
<a href="Introduction-to-Methods.html">Section 7.6.2 (Introduction to Methods)</a>,
<a href="Congruent-Lambda_002dlists-for-all-Methods-of-a-Generic-Function.html">Section 7.6.4 (Congruent Lambda-lists for all Methods of a Generic Function)</a>,
<a href="Agreement-on-Parameter-Specializers-and-Qualifiers.html">Section 7.6.3 (Agreement on Parameter Specializers and Qualifiers)</a>,
<a href="Syntactic-Interaction-of-Documentation-Strings-and-Declarations.html">Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)</a>
</p>


<hr>
<div class="header">
<p>
Next: <a href="find_002dclass.html" accesskey="n" rel="next">find-class</a>, Previous: <a href="defgeneric.html" accesskey="p" rel="prev">defgeneric</a>, Up: <a href="Objects.html" accesskey="u" rel="up">Objects</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
