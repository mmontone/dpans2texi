<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Introduction to Streams (ANSI Common Lisp)</title>

<meta name="description" content="Introduction to Streams (ANSI Common Lisp)">
<meta name="keywords" content="Introduction to Streams (ANSI Common Lisp)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="Table-of-Contents.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Stream-Concepts.html" rel="up" title="Stream Concepts">
<link href="Stream-Variables.html" rel="next" title="Stream Variables">
<link href="Stream-Concepts.html" rel="prev" title="Stream Concepts">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
body {font-family: century schoolbook, serif;
      line-height: 1.3;
      padding-left: 5em; padding-right: 1em;
      padding-bottom: 1em; max-width: 60em;}
table {border-collapse: collapse}
span.roman { font-family: century schoolbook, serif; font-weight: normal; }
h1, h2, h3, h4, h5, h6 {font-family:  Helvetica, sans-serif}
dfn {font-family: inherit; font-variant: italic; font-weight: bolder }
kbd {font-family: monospace; text-decoration: underline}
var {font-family: Helvetica, sans-serif; font-variant: slanted}
td  {padding-right: 1em; padding-left: 1em}
sub {font-size: smaller}
.node {padding: 0; margin: 0}

-->
</style>


</head>

<body lang="en">
<span id="Introduction-to-Streams"></span><div class="header">
<p>
Next: <a href="Stream-Variables.html" accesskey="n" rel="next">Stream Variables</a>, Up: <a href="Stream-Concepts.html" accesskey="u" rel="up">Stream Concepts</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Introduction-to-Streams-1"></span><h4 class="subsection">21.1.1 Introduction to Streams</h4>

<p>A <span id="index-stream-1"></span>
<em>stream</em> is an <i>object</i> that can be used with an input or output
function to identify an appropriate source or sink of <i>characters</i> or 
<i>bytes</i> for that operation.
A <span id="index-character-4"></span>
<em>character</em> <span id="index-stream-2"></span>
<em>stream</em> is a source or sink of <i>characters</i>.
A <span id="index-binary"></span>
<em>binary</em> <span id="index-stream-3"></span>
<em>stream</em> is a source or sink of <i>bytes</i>.
</p>
<p>Some operations may be performed on any kind of <i>stream</i>;
the next figure&nbsp;<!-- /@w -->provides a list of <i>standardized</i> operations
that are potentially useful with any kind of <i>stream</i>.
</p>

<div class="float"><span id="fig21_002e1"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>close</td><td>stream-element-type</td></tr>
<tr><td>input-stream-p</td><td>streamp</td></tr>
<tr><td>interactive-stream-p</td><td>with-open-stream</td></tr>
<tr><td>output-stream-p</td><td></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 21.1: </strong>Some General-Purpose Stream Operations</p></div></div>

<p>Other operations are only meaningful on certain <i>stream</i> <i>types</i>.
For example, <code>read-char</code> is only defined for <i>character</i> <i>streams</i>
and <code>read-byte</code> is only defined for <i>binary</i> <i>streams</i>.
</p>
<span id="Abstract-Classifications-of-Streams"></span><h4 class="subsubsection">21.1.1.1 Abstract Classifications of Streams</h4>

<span id="g_t21_002e1_002e1_002e1_002e1-Input_002c-Output_002c-and-Bidirectional-Streams"></span><h4 class="unnumberedsubsubsec">21.1.1.1.1 Input, Output, and Bidirectional Streams</h4>


<p>A <i>stream</i>, whether a <i>character</i> <i>stream</i> or a <i>binary</i> <i>stream</i>,
can be an <span id="index-input"></span>
<em>input</em> <span id="index-stream-4"></span>
<em>stream</em> (source of data),
an <span id="index-output"></span>
<em>output</em> <span id="index-stream-5"></span>
<em>stream</em> (sink for data),
both, 
or (<i>e.g.</i>, when &ldquo;<code>:direction :probe</code>&rdquo; is given to <code>open</code>) neither.
</p>
<p>The next figure&nbsp;<!-- /@w -->shows <i>operators</i> relating to
<i>input</i> <i>streams</i>.
</p>


<div class="float"><span id="InputStreamOps"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>clear-input</td><td>read-byte</td><td>read-from-string</td></tr>
<tr><td>listen</td><td>read-char</td><td>read-line</td></tr>
<tr><td>peek-char</td><td>read-char-no-hang</td><td>read-preserving-whitespace</td></tr>
<tr><td>read</td><td>read-delimited-list</td><td>unread-char</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 21.2: </strong>Operators relating to Input Streams.</p></div></div>

<p>The next figure&nbsp;<!-- /@w -->shows <i>operators</i> relating to
<i>output</i> <i>streams</i>.
</p>


<div class="float"><span id="OutputStreamOps"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>clear-output</td><td>prin1</td><td>write</td></tr>
<tr><td>finish-output</td><td>prin1-to-string</td><td>write-byte</td></tr>
<tr><td>force-output</td><td>princ</td><td>write-char</td></tr>
<tr><td>format</td><td>princ-to-string</td><td>write-line</td></tr>
<tr><td>fresh-line</td><td>print</td><td>write-string</td></tr>
<tr><td>pprint</td><td>terpri</td><td>write-to-string</td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 21.3: </strong>Operators relating to Output Streams.</p></div></div>

<p>A <i>stream</i> that is both an <i>input</i> <i>stream</i> and an <i>output</i> <i>stream</i>
is called a <span id="index-bidirectional"></span>
<em>bidirectional</em> <span id="index-stream-6"></span>
<em>stream</em>.
See the <i>functions</i> <a href="input_002dstream_002dp_003b-output_002dstream_002dp.html#input_002dstream_002dp">input-stream-p</a> and <code>output-stream-p</code>.
</p>
<p>Any of the <i>operators</i> listed in <a href="#InputStreamOps">Figure 21.2</a>&nbsp;<!-- /@w -->or <a href="#OutputStreamOps">Figure 21.3</a>
can be used with <i>bidirectional</i> <i>streams</i>.  In addition, the next figure
shows a list of <i>operators</i> that relate specificaly to 
<i>bidirectional</i> <i>streams</i>.
</p>

<div class="float"><span id="fig21_002e4"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<tr><td>y-or-n-p</td><td>yes-or-no-p</td><td></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 21.4: </strong>Operators relating to Bidirectional Streams.</p></div></div>


<span id="g_t21_002e1_002e1_002e1_002e2-Open-and-Closed-Streams"></span><h4 class="unnumberedsubsubsec">21.1.1.1.2 Open and Closed Streams</h4>


<p><i>Streams</i> are either <span id="index-open"></span>
<em>open</em> or <span id="index-closed"></span>
<em>closed</em>.  
</p>
<p>Except as explicitly specified otherwise,
operations that create and return <i>streams</i> return <i>open</i> <i>streams</i>.
</p>
<p>The action of <i>closing</i> a <i>stream</i> marks the end of its use as a source
or sink of data, permitting the <i>implementation</i> to reclaim its internal data
structures, and to free any external resources which might have been locked by the
<i>stream</i> when it was opened.
</p>
<p>Except as explicitly specified otherwise,
the consequences are undefined when a <i>closed</i> <i>stream</i> 
is used where a <i>stream</i> is called for.
</p>
<p>Coercion of <i>streams</i> to <i>pathnames</i> 
is permissible for <i>closed</i> <i>streams</i>;
in some situations, such as for a <i>truename</i> computation, 
the result might be different for an <i>open</i> <i>stream</i>
and for that same <i>stream</i> once it has been <i>closed</i>.
</p>

<span id="g_t21_002e1_002e1_002e1_002e3-Interactive-Streams"></span><h4 class="unnumberedsubsubsec">21.1.1.1.3 Interactive Streams</h4>

<span id="InteractiveStreams"></span>
<p>An <span id="index-interactive-stream"></span>
<em>interactive stream</em> is one on which it makes sense to perform
interactive querying.
</p>
<p>The precise meaning of an <i>interactive stream</i> is
<i>implementation-defined</i>, and may depend on the underlying
operating system.  Some examples of the things that an
<i>implementation</i> might choose to use as identifying characteristics
of an <i>interactive stream</i> include:
</p>

<ul>
<li> The <i>stream</i> is connected to a person (or equivalent) in such a way
that the program can prompt for information and expect to receive different
input depending on the prompt.

</li><li> The program is expected to prompt for input and support &ldquo;normal input editing&rdquo;.

</li><li> <code>read-char</code> might wait for the user to type something before returning
instead of immediately returning a character or end-of-file. 
</li></ul>


<p>The general intent of having some <i>streams</i> be classified as
<i>interactive streams</i> is to allow them to be distinguished from
streams containing batch (or background or command-file) input.
Output to batch streams is typically discarded or saved for later viewing, 
so interactive queries to such streams might not have the expected effect.
</p>
<p><i>Terminal I/O</i> might or might not be an <i>interactive stream</i>.
</p>

<span id="Abstract-Classifications-of-Streams-1"></span><h4 class="subsubsection">21.1.1.2 Abstract Classifications of Streams</h4>

<span id="g_t21_002e1_002e1_002e2_002e4-File-Streams"></span><h4 class="unnumberedsubsubsec">21.1.1.2.4 File Streams</h4>


<p>Some <i>streams</i>, called 
<span id="index-file-stream"></span>
<em>file streams</em>, provide access to <i>files</i>.
An <i>object</i> of <i>class</i> <code>file-stream</code> is used to represent a <i>file stream</i>.
</p>
<p>The basic operation for opening a <i>file</i> is <code>open</code>,
which typically returns a <i>file stream</i> 
(see its dictionary entry for details).
The basic operation for closing a <i>stream</i> is <code>close</code>.
The macro <code>with-open-file</code> is useful 
to express the common idiom of opening a <i>file</i> 
for the duration of a given body of <i>code</i>, 
and assuring that the resulting <i>stream</i> is closed upon exit from that body.
</p>

<span id="Other-Subclasses-of-Stream"></span><h4 class="subsubsection">21.1.1.3 Other Subclasses of Stream</h4>

<p>The <i>class</i> <code>stream</code> has a number of <i>subclasses</i> defined 
by this specification.  The next figure&nbsp;<!-- /@w -->shows some information 
about these subclasses.
</p>

<div class="float"><span id="fig21_002e5"></span>
<table class="cartouche" border="1"><tr><td>
<table>
<thead><tr><th>Class</th><th>Related Operators</th></tr></thead>
<tr><td><code>broadcast-stream</code></td><td><code>make-broadcast-stream</code></td></tr>
<tr><td></td><td><code>broadcast-stream-streams</code></td></tr>
<tr><td><code>concatenated-stream</code></td><td><code>make-concatenated-stream</code></td></tr>
<tr><td></td><td><code>concatenated-stream-streams</code></td></tr>
<tr><td><code>echo-stream</code></td><td><code>make-echo-stream</code></td></tr>
<tr><td></td><td><code>echo-stream-input-stream</code></td></tr>
<tr><td></td><td><code>echo-stream-output-stream</code></td></tr>
<tr><td><code>string-stream</code></td><td><code>make-string-input-stream</code></td></tr>
<tr><td></td><td><code>with-input-from-string</code></td></tr>
<tr><td></td><td><code>make-string-output-stream</code></td></tr>
<tr><td></td><td><code>with-output-to-string</code></td></tr>
<tr><td></td><td><code>get-output-stream-string</code></td></tr>
<tr><td><code>synonym-stream</code></td><td><code>make-synonym-stream</code></td></tr>
<tr><td></td><td><code>synonym-stream-symbol</code></td></tr>
<tr><td><code>two-way-stream</code></td><td><code>make-two-way-stream</code></td></tr>
<tr><td></td><td><code>two-way-stream-input-stream</code></td></tr>
<tr><td></td><td><code>two-way-stream-output-stream</code></td></tr>
</table>
</td></tr></table>

<div class="float-caption"><p><strong>Figure 21.5: </strong>Defined Names related to Specialized Streams</p></div></div>



<hr>
<div class="header">
<p>
Next: <a href="Stream-Variables.html" accesskey="n" rel="next">Stream Variables</a>, Up: <a href="Stream-Concepts.html" accesskey="u" rel="up">Stream Concepts</a> &nbsp; [<a href="Table-of-Contents.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
